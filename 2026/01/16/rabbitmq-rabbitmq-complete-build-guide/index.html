<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.svg">
  <link rel="mask-icon" href="/images/favicon.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Noto+Serif+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Source+Code+Pro:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hzsunzixiang.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.27.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"default","show_result":true},"fold":{"enable":false,"height":500},"language":false,"highlight_theme":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="RabbitMQ 编译构建完全指南概述基于 RabbitMQ 4.0.5 源码深度分析和实际构建验证，本文档全面解析各种编译方式的技术原理、实现机制和最佳实践。 快速对比表构建命令   命令 作用 输出格式 部署方式 编译时间 磁盘占用 适用场景    make 编译 源码目录 + beam 文件 开发调试 最快 中等 本地开发、调试   make dist 打包文件 插件目录结构 目录部署 快">
<meta property="og:type" content="article">
<meta property="og:title" content="RabbitMQ 编译构建完全指南">
<meta property="og:url" content="https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-complete-build-guide/">
<meta property="og:site_name" content="Zixiang Sun&#39;s Blog">
<meta property="og:description" content="RabbitMQ 编译构建完全指南概述基于 RabbitMQ 4.0.5 源码深度分析和实际构建验证，本文档全面解析各种编译方式的技术原理、实现机制和最佳实践。 快速对比表构建命令   命令 作用 输出格式 部署方式 编译时间 磁盘占用 适用场景    make 编译 源码目录 + beam 文件 开发调试 最快 中等 本地开发、调试   make dist 打包文件 插件目录结构 目录部署 快">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2026-01-16T14:30:00.000Z">
<meta property="article:modified_time" content="2026-01-16T14:41:31.149Z">
<meta property="article:author" content="Zixiang Sun">
<meta property="article:tag" content="Erlang">
<meta property="article:tag" content="RabbitMQ">
<meta property="article:tag" content="构建系统">
<meta property="article:tag" content="编译">
<meta property="article:tag" content="部署">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-complete-build-guide/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-complete-build-guide/","path":"2026/01/16/rabbitmq-rabbitmq-complete-build-guide/","title":"RabbitMQ 编译构建完全指南"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>RabbitMQ 编译构建完全指南 | Zixiang Sun's Blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Zixiang Sun's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Zixiang Sun's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Sharing thoughts on technology, programming, and life</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">14</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">8</span></a></li><li class="menu-item menu-item-erlang"><a href="/erlang/" rel="section"><i class="fa fa-code fa-fw"></i>Erlang</a></li><li class="menu-item menu-item-rabbitmq"><a href="/rabbitmq/" rel="section"><i class="fa fa-server fa-fw"></i>RabbitMQ</a></li><li class="menu-item menu-item-craq"><a href="/craq/" rel="section"><i class="fa fa-book fa-fw"></i>CRAQ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#RabbitMQ-%E7%BC%96%E8%AF%91%E6%9E%84%E5%BB%BA%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97"><span class="nav-number">1.</span> <span class="nav-text">RabbitMQ 编译构建完全指南</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E5%AF%B9%E6%AF%94%E8%A1%A8"><span class="nav-number">1.2.</span> <span class="nav-text">快速对比表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.1.</span> <span class="nav-text">构建命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E8%B0%83%E8%AF%95%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.2.</span> <span class="nav-text">开发调试命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-make-%E5%9F%BA%E7%A1%80%E7%BC%96%E8%AF%91"><span class="nav-number">1.3.</span> <span class="nav-text">1. make - 基础编译</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86"><span class="nav-number">1.3.1.</span> <span class="nav-text">技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">核心实现机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E6%B5%81%E7%A8%8B"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">编译流程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E7%94%9F%E6%88%90%E7%9A%84%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="nav-number">1.3.2.</span> <span class="nav-text">实际生成的文件结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.3.3.</span> <span class="nav-text">使用场景与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">开发环境</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E7%89%B9%E7%82%B9"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">性能特点</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-make-dist-%E6%8F%92%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%88%86%E5%8F%91"><span class="nav-number">1.4.</span> <span class="nav-text">2. make dist - 插件目录分发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-1"><span class="nav-number">1.4.1.</span> <span class="nav-text">技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%BA%90%E7%A0%81"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">核心实现源码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">打包流程详解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E7%94%9F%E6%88%90%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-number">1.4.2.</span> <span class="nav-text">实际生成的目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-1"><span class="nav-number">1.4.3.</span> <span class="nav-text">使用场景与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">生产环境</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">插件开发</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-make-dist-DIST-AS-EZS-true-EZ-%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%88%86%E5%8F%91"><span class="nav-number">1.5.</span> <span class="nav-text">3. make dist DIST_AS_EZS&#x3D;true - EZ 压缩包分发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-2"><span class="nav-number">1.5.1.</span> <span class="nav-text">技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E9%80%BB%E8%BE%91"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">核心实现逻辑</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EZ-%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90%E6%B5%81%E7%A8%8B"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">EZ 文件生成流程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E7%94%9F%E6%88%90%E7%9A%84-EZ-%E6%96%87%E4%BB%B6%EF%BC%88%E5%B7%B2%E9%AA%8C%E8%AF%81%EF%BC%89"><span class="nav-number">1.5.2.</span> <span class="nav-text">实际生成的 EZ 文件（已验证）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EZ-%E6%A0%BC%E5%BC%8F%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90"><span class="nav-number">1.5.3.</span> <span class="nav-text">EZ 格式深度分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#EZ-%E6%96%87%E4%BB%B6%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">EZ 文件内部结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95-vs-EZ-%E6%A0%BC%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">目录 vs EZ 格式对比</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EZ-%E6%A0%BC%E5%BC%8F%E4%BC%98%E5%8A%BF"><span class="nav-number">1.5.4.</span> <span class="nav-text">EZ 格式优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-2"><span class="nav-number">1.5.5.</span> <span class="nav-text">使用场景与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%92%E4%BB%B6%E5%88%86%E5%8F%91"><span class="nav-number">1.5.5.1.</span> <span class="nav-text">插件分发</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-make-source-dist-%E6%BA%90%E7%A0%81%E5%88%86%E5%8F%91%E5%8C%85"><span class="nav-number">1.6.</span> <span class="nav-text">4. make source-dist - 源码分发包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-3"><span class="nav-number">1.6.1.</span> <span class="nav-text">技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%BA%90%E7%A0%81-1"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">核心实现源码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3-1"><span class="nav-number">1.6.1.2.</span> <span class="nav-text">打包流程详解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RSYNC-%E6%8E%92%E9%99%A4%E8%A7%84%E5%88%99"><span class="nav-number">1.6.1.3.</span> <span class="nav-text">RSYNC 排除规则</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E7%94%9F%E6%88%90%E7%9A%84%E6%96%87%E4%BB%B6"><span class="nav-number">1.6.2.</span> <span class="nav-text">实际生成的文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E5%A4%8D%E7%8E%B0%E6%80%A7%E7%89%B9%E6%80%A7"><span class="nav-number">1.6.3.</span> <span class="nav-text">可复现性特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-3"><span class="nav-number">1.6.4.</span> <span class="nav-text">使用场景与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A6%BB%E7%BA%BF%E6%9E%84%E5%BB%BA"><span class="nav-number">1.6.4.1.</span> <span class="nav-text">离线构建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83"><span class="nav-number">1.6.4.2.</span> <span class="nav-text">版本发布</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E4%B8%BA-package-generic-unix-%E7%9A%84%E8%BE%93%E5%85%A5"><span class="nav-number">1.6.4.3.</span> <span class="nav-text">作为 package-generic-unix 的输入</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-make-package-generic-unix-%E9%80%9A%E7%94%A8-Unix-%E5%8C%85"><span class="nav-number">1.7.</span> <span class="nav-text">5. make package-generic-unix - 通用 Unix 包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-4"><span class="nav-number">1.7.1.</span> <span class="nav-text">技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%BA%90%E7%A0%81-2"><span class="nav-number">1.7.1.1.</span> <span class="nav-text">核心实现源码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3-2"><span class="nav-number">1.7.1.2.</span> <span class="nav-text">打包流程详解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E7%94%9F%E6%88%90%E7%9A%84%E5%8C%85%E7%BB%93%E6%9E%84%EF%BC%88%E5%B7%B2%E9%AA%8C%E8%AF%81%EF%BC%89"><span class="nav-number">1.7.2.</span> <span class="nav-text">实际生成的包结构（已验证）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E5%8C%85%E5%86%85%E5%AE%B9%E5%88%86%E6%9E%90"><span class="nav-number">1.7.2.1.</span> <span class="nav-text">通用包内容分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E5%8C%85%E7%89%B9%E7%82%B9"><span class="nav-number">1.7.3.</span> <span class="nav-text">通用包特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-4"><span class="nav-number">1.7.4.</span> <span class="nav-text">使用场景与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2"><span class="nav-number">1.7.4.1.</span> <span class="nav-text">容器化部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%88%86%E5%8F%91"><span class="nav-number">1.7.4.2.</span> <span class="nav-text">跨平台分发</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-make-install-%E7%B3%BB%E7%BB%9F%E7%BA%A7%E5%AE%89%E8%A3%85"><span class="nav-number">1.8.</span> <span class="nav-text">6. make install - 系统级安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-5"><span class="nav-number">1.8.1.</span> <span class="nav-text">技术原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E9%80%BB%E8%BE%91-1"><span class="nav-number">1.8.1.1.</span> <span class="nav-text">核心实现逻辑</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E7%BB%84%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="nav-number">1.8.1.2.</span> <span class="nav-text">安装组件详解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-number">1.8.2.</span> <span class="nav-text">系统安装目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E4%BC%98%E5%8A%BF"><span class="nav-number">1.8.3.</span> <span class="nav-text">系统安装优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-5"><span class="nav-number">1.8.4.</span> <span class="nav-text">使用场景与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E7%BA%A7%E9%83%A8%E7%BD%B2"><span class="nav-number">1.8.4.1.</span> <span class="nav-text">系统级部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E9%9B%86%E6%88%90"><span class="nav-number">1.8.4.2.</span> <span class="nav-text">包管理器集成</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E5%BC%80%E5%8F%91%E8%B0%83%E8%AF%95%E5%91%BD%E4%BB%A4"><span class="nav-number">1.9.</span> <span class="nav-text">7. 开发调试命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#make-run-broker-%E5%90%AF%E5%8A%A8%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">1.9.1.</span> <span class="nav-text">make run-broker - 启动开发服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-6"><span class="nav-number">1.9.1.1.</span> <span class="nav-text">技术原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%BA%90%E7%A0%81-3"><span class="nav-number">1.9.1.2.</span> <span class="nav-text">核心实现源码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">1.9.1.3.</span> <span class="nav-text">执行流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">1.9.1.4.</span> <span class="nav-text">使用场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#make-run-broker-PLUGINS-%E6%8F%92%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="nav-number">1.9.2.</span> <span class="nav-text">make run-broker PLUGINS&#x3D; - 插件测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-7"><span class="nav-number">1.9.2.1.</span> <span class="nav-text">技术原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="nav-number">1.9.2.2.</span> <span class="nav-text">使用场景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">1.9.2.3.</span> <span class="nav-text">注意事项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#make-shell-Erlang-Shell"><span class="nav-number">1.9.3.</span> <span class="nav-text">make shell - Erlang Shell</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-8"><span class="nav-number">1.9.3.1.</span> <span class="nav-text">技术原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%BA%90%E7%A0%81-4"><span class="nav-number">1.9.3.2.</span> <span class="nav-text">核心实现源码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-2"><span class="nav-number">1.9.3.3.</span> <span class="nav-text">使用场景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8E-erl-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.9.3.4.</span> <span class="nav-text">与 erl 的区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#make-run-node-%E8%A3%B8-Erlang-%E8%8A%82%E7%82%B9"><span class="nav-number">1.9.4.</span> <span class="nav-text">make run-node - 裸 Erlang 节点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-9"><span class="nav-number">1.9.4.1.</span> <span class="nav-text">技术原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-3"><span class="nav-number">1.9.4.2.</span> <span class="nav-text">使用场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.9.5.</span> <span class="nav-text">开发工作流最佳实践</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90"><span class="nav-number">1.10.</span> <span class="nav-text">构建系统架构深度解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E5%85%B3%E7%B3%BB"><span class="nav-number">1.10.1.</span> <span class="nav-text">核心组件关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="nav-number">1.10.2.</span> <span class="nav-text">关键配置文件详解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Makefile-%E4%B8%BB%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">1. Makefile - 主控制文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-plugins-mk-%E6%8F%92%E4%BB%B6%E5%AE%9A%E4%B9%89"><span class="nav-number">1.10.2.2.</span> <span class="nav-text">2. plugins.mk - 插件定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-rabbitmq-dist-mk-%E5%88%86%E5%8F%91%E9%80%BB%E8%BE%91"><span class="nav-number">1.10.2.3.</span> <span class="nav-text">3. rabbitmq-dist.mk - 分发逻辑</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F%E7%89%B9%E7%82%B9"><span class="nav-number">1.10.3.</span> <span class="nav-text">构建系统特点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%8C%E6%95%B4%E7%BC%96%E8%AF%91%E6%B5%81%E7%A8%8B%E5%AF%B9%E6%AF%94"><span class="nav-number">1.11.</span> <span class="nav-text">完整编译流程对比</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E5%92%8C%E8%B5%84%E6%BA%90%E8%AF%A6%E7%BB%86%E5%AF%B9%E6%AF%94"><span class="nav-number">1.11.1.</span> <span class="nav-text">性能和资源详细对比</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E5%91%BD%E4%BB%A4-1"><span class="nav-number">1.11.1.1.</span> <span class="nav-text">构建命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E8%B0%83%E8%AF%95%E5%91%BD%E4%BB%A4-1"><span class="nav-number">1.11.1.2.</span> <span class="nav-text">开发调试命令</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97"><span class="nav-number">1.12.</span> <span class="nav-text">最佳实践指南</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E9%98%B6%E6%AE%B5%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.12.1.</span> <span class="nav-text">开发阶段最佳实践</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E9%98%B6%E6%AE%B5%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.12.2.</span> <span class="nav-text">测试阶段最佳实践</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E4%BA%A7%E9%83%A8%E7%BD%B2%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.12.3.</span> <span class="nav-text">生产部署最佳实践</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-number">1.12.4.</span> <span class="nav-text">插件开发最佳实践</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BC%98%E5%8C%96"><span class="nav-number">1.13.</span> <span class="nav-text">高级配置与优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%8E%A7%E5%88%B6"><span class="nav-number">1.13.1.</span> <span class="nav-text">环境变量控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="nav-number">1.13.2.</span> <span class="nav-text">编译优化技巧</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9E%84%E5%BB%BA%E9%85%8D%E7%BD%AE"><span class="nav-number">1.13.3.</span> <span class="nav-text">自定义构建配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4%E6%8C%87%E5%8D%97"><span class="nav-number">1.14.</span> <span class="nav-text">故障排除指南</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%BC%96%E8%AF%91%E9%97%AE%E9%A2%98"><span class="nav-number">1.14.1.</span> <span class="nav-text">常见编译问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%BE%9D%E8%B5%96%E9%97%AE%E9%A2%98"><span class="nav-number">1.14.1.1.</span> <span class="nav-text">1. 依赖问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%89%88%E6%9C%AC%E5%86%B2%E7%AA%81"><span class="nav-number">1.14.1.2.</span> <span class="nav-text">2. 版本冲突</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E4%B8%8D%E8%B6%B3"><span class="nav-number">1.14.1.3.</span> <span class="nav-text">3. 磁盘空间不足</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98"><span class="nav-number">1.14.1.4.</span> <span class="nav-text">4. 权限问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE"><span class="nav-number">1.14.2.</span> <span class="nav-text">性能优化建议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%E4%B8%8E%E5%BB%BA%E8%AE%AE"><span class="nav-number">1.15.</span> <span class="nav-text">总结与建议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E9%80%89%E6%8B%A9%E7%9F%A9%E9%98%B5"><span class="nav-number">1.15.1.</span> <span class="nav-text">命令选择矩阵</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E5%9C%BA%E6%99%AF"><span class="nav-number">1.15.1.1.</span> <span class="nav-text">构建场景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E8%B0%83%E8%AF%95%E5%9C%BA%E6%99%AF"><span class="nav-number">1.15.1.2.</span> <span class="nav-text">开发调试场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E6%B4%9E%E5%AF%9F"><span class="nav-number">1.15.2.</span> <span class="nav-text">关键技术洞察</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">1.16.</span> <span class="nav-text">参考资料</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zixiang Sun"
      src="/images/avatar.svg">
  <p class="site-author-name" itemprop="name">Zixiang Sun</p>
  <div class="site-description" itemprop="description">Welcome to my personal blog where I share thoughts on technology, programming, and life experiences.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hzsunzixiang" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hzsunzixiang" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:17842379@qq.com" title="E-Mail → mailto:17842379@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-complete-build-guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.svg">
      <meta itemprop="name" content="Zixiang Sun">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zixiang Sun's Blog">
      <meta itemprop="description" content="Welcome to my personal blog where I share thoughts on technology, programming, and life experiences.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="RabbitMQ 编译构建完全指南 | Zixiang Sun's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RabbitMQ 编译构建完全指南
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2026-01-16 22:30:00 / 修改时间：22:41:31" itemprop="dateCreated datePublished" datetime="2026-01-16T22:30:00+08:00">2026-01-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/RabbitMQ/" itemprop="url" rel="index"><span itemprop="name">RabbitMQ</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="RabbitMQ-编译构建完全指南"><a href="#RabbitMQ-编译构建完全指南" class="headerlink" title="RabbitMQ 编译构建完全指南"></a>RabbitMQ 编译构建完全指南</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>基于 RabbitMQ 4.0.5 源码深度分析和实际构建验证，本文档全面解析各种编译方式的技术原理、实现机制和最佳实践。</p>
<h2 id="快速对比表"><a href="#快速对比表" class="headerlink" title="快速对比表"></a>快速对比表</h2><h3 id="构建命令"><a href="#构建命令" class="headerlink" title="构建命令"></a>构建命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
<th>输出格式</th>
<th>部署方式</th>
<th>编译时间</th>
<th>磁盘占用</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><code>make</code></td>
<td>编译</td>
<td>源码目录 + beam 文件</td>
<td>开发调试</td>
<td>最快</td>
<td>中等</td>
<td>本地开发、调试</td>
</tr>
<tr>
<td><code>make dist</code></td>
<td>打包文件</td>
<td>插件目录结构</td>
<td>目录部署</td>
<td>快</td>
<td>大</td>
<td>生产环境、插件开发</td>
</tr>
<tr>
<td><code>make dist DIST_AS_EZS=true</code></td>
<td>打包成 ez 文件</td>
<td>.ez 压缩包</td>
<td>插件安装</td>
<td>中等</td>
<td>小</td>
<td>插件分发、热加载</td>
</tr>
<tr>
<td><code>make source-dist</code></td>
<td>创建源码包</td>
<td>tar.xz 源码归档</td>
<td>源码分发</td>
<td>快</td>
<td>小</td>
<td>离线构建、版本发布</td>
</tr>
<tr>
<td><code>make package-generic-unix</code></td>
<td>打包成 PACKAGE 文件</td>
<td>tar.xz 包</td>
<td>解压安装</td>
<td>慢</td>
<td>最小</td>
<td>容器、跨平台</td>
</tr>
<tr>
<td><code>make install</code></td>
<td>安装到系统</td>
<td>系统目录</td>
<td>系统安装</td>
<td>中等</td>
<td>中等</td>
<td>生产部署</td>
</tr>
<tr>
<td><code>make install PREFIX=/opt/rabbitmq</code></td>
<td>安装到指定目录</td>
<td>自定义目录</td>
<td>自定义安装</td>
<td>中等</td>
<td>中等</td>
<td>自定义部署路径</td>
</tr>
</tbody></table>
<h3 id="开发调试命令"><a href="#开发调试命令" class="headerlink" title="开发调试命令"></a>开发调试命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><code>make run-broker</code></td>
<td>启动 RabbitMQ 服务器（前台运行）</td>
<td>开发调试、日志查看</td>
</tr>
<tr>
<td><code>make run-broker PLUGINS=&quot;plugin_name&quot;</code></td>
<td>启动并加载指定插件</td>
<td>插件测试、功能验证</td>
</tr>
<tr>
<td><code>make shell</code></td>
<td>进入 Erlang Shell</td>
<td>代码调试、模块测试</td>
</tr>
<tr>
<td><code>make run-background-broker</code></td>
<td>后台启动 RabbitMQ</td>
<td>自动化测试</td>
</tr>
<tr>
<td><code>make run-node</code></td>
<td>启动裸 Erlang 节点（无 RabbitMQ）</td>
<td>Erlang 调试</td>
</tr>
</tbody></table>
<hr>
<h2 id="1-make-基础编译"><a href="#1-make-基础编译" class="headerlink" title="1. make - 基础编译"></a>1. <code>make</code> - 基础编译</h2><h3 id="技术原理"><a href="#技术原理" class="headerlink" title="技术原理"></a>技术原理</h3><p>基于 <strong>erlang.mk</strong> 构建系统，执行 Erlang&#x2F;OTP 标准编译流程。</p>
<h4 id="核心实现机制"><a href="#核心实现机制" class="headerlink" title="核心实现机制"></a>核心实现机制</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：Makefile (第 77 行)</span></span><br><span class="line"><span class="keyword">include</span> erlang.mk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 来源：erlang.mk 核心逻辑</span></span><br><span class="line"><span class="section">app:: deps <span class="variable">$(PROJECT)</span>.d</span></span><br><span class="line">  <span class="variable">$(verbose)</span> <span class="variable">$(MAKE)</span> --no-print-directory app-build</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认目标继承自 erlang.mk</span></span><br><span class="line"><span class="comment"># 编译流程：</span></span><br><span class="line"><span class="comment"># 1. 编译依赖 (deps)</span></span><br><span class="line"><span class="comment"># 2. 编译核心应用 (app)  </span></span><br><span class="line"><span class="comment"># 3. 生成启动脚本</span></span><br></pre></td></tr></table></figure>

<h4 id="编译流程"><a href="#编译流程" class="headerlink" title="编译流程"></a>编译流程</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">make</span><br><span class="line">  ↓</span><br><span class="line">解析依赖</span><br><span class="line">  ↓</span><br><span class="line">编译 deps/</span><br><span class="line">  ↓</span><br><span class="line">编译 <span class="string">.erl</span> → <span class="string">.beam</span></span><br><span class="line">  ↓</span><br><span class="line">生成启动脚本</span><br><span class="line">  ↓</span><br><span class="line">创建 sbin/ 目录</span><br></pre></td></tr></table></figure>

<h3 id="实际生成的文件结构"><a href="#实际生成的文件结构" class="headerlink" title="实际生成的文件结构"></a>实际生成的文件结构</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-server/</span><br><span class="line">├── deps/                          <span class="comment"># 依赖模块</span></span><br><span class="line">│   ├── rabbit/ebin/*.beam        <span class="comment"># 核心模块字节码</span></span><br><span class="line">│   ├── rabbit_common/ebin/*.beam <span class="comment"># 公共模块字节码</span></span><br><span class="line">│   └── */ebin/*.beam             <span class="comment"># 其他插件字节码</span></span><br><span class="line">├── sbin/                         <span class="comment"># 启动脚本 (25 个文件)</span></span><br><span class="line">│   ├── rabbitmq-server          <span class="comment"># 主服务器脚本</span></span><br><span class="line">│   ├── rabbitmqctl              <span class="comment"># 管理工具</span></span><br><span class="line">│   ├── rabbitmq-plugins         <span class="comment"># 插件管理</span></span><br><span class="line">│   └── ...                      <span class="comment"># 其他管理脚本</span></span><br><span class="line">└── escript/                      <span class="comment"># Erlang 脚本</span></span><br></pre></td></tr></table></figure>

<h3 id="使用场景与最佳实践"><a href="#使用场景与最佳实践" class="headerlink" title="使用场景与最佳实践"></a>使用场景与最佳实践</h3><h4 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 快速开发迭代</span></span><br><span class="line">make clean &amp;&amp; make</span><br><span class="line">sbin/rabbitmq-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 增量编译（推荐）</span></span><br><span class="line">make  <span class="comment"># 只编译修改的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 开发调试</span></span><br><span class="line">make shell  <span class="comment"># 进入 Erlang shell</span></span><br></pre></td></tr></table></figure>

<h4 id="性能特点"><a href="#性能特点" class="headerlink" title="性能特点"></a>性能特点</h4><ul>
<li><strong>编译时间</strong>: 最快（支持增量编译）</li>
<li><strong>磁盘占用</strong>: 中等（包含源码和字节码）</li>
<li><strong>内存使用</strong>: 低</li>
<li><strong>适用场景</strong>: 开发调试、源码修改、性能测试</li>
</ul>
<hr>
<h2 id="2-make-dist-插件目录分发"><a href="#2-make-dist-插件目录分发" class="headerlink" title="2. make dist - 插件目录分发"></a>2. <code>make dist</code> - 插件目录分发</h2><h3 id="技术原理-1"><a href="#技术原理-1" class="headerlink" title="技术原理"></a>技术原理</h3><p>基于 <strong>rabbitmq-dist.mk</strong> 实现插件打包机制，创建标准的 RabbitMQ 插件目录结构。</p>
<h4 id="核心实现源码"><a href="#核心实现源码" class="headerlink" title="核心实现源码"></a>核心实现源码</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：deps/rabbit_common/mk/rabbitmq-dist.mk (第 166 行)</span></span><br><span class="line"><span class="section">dist:: <span class="variable">$(ERLANG_MK_RECURSIVE_DEPS_LIST)</span> all</span></span><br><span class="line">  <span class="variable">$(verbose)</span> rm -rf <span class="variable">$(DIST_DIR)</span></span><br><span class="line">  <span class="variable">$(verbose)</span> mkdir -p <span class="variable">$(DIST_DIR)</span></span><br><span class="line">  <span class="variable">$(gen_verbose)</span> <span class="variable">$(MAKE)</span> --no-print-directory do-dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插件目录创建逻辑 (第 48-54 行)</span></span><br><span class="line">dist_$(1)_ez_dir = $<span class="variable">$(<span class="built_in">if</span> $(2)</span>,<span class="variable">$(DIST_DIR)</span>/$(1)-$(2), \</span><br><span class="line">  $<span class="variable">$(<span class="built_in">if</span> $<span class="variable">$(VERSION)</span>,<span class="variable">$(DIST_DIR)</span>/$(1)</span>-$<span class="variable">$(VERSION)</span>,<span class="variable">$(DIST_DIR)</span>/$(1)))</span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(DIST_AS_EZS)</span>,)</span><br><span class="line">dist_$(1)_ez = $$(dist_$(1)_ez_dir)  <span class="comment"># 目录格式</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">dist_$(1)_ez = $$(dist_$(1)_ez_dir).ez  <span class="comment"># EZ 格式</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<h4 id="打包流程详解"><a href="#打包流程详解" class="headerlink" title="打包流程详解"></a>打包流程详解</h4><ol>
<li><strong>编译所有模块</strong> - 确保所有 <code>.erl</code> 文件编译为 <code>.beam</code></li>
<li><strong>收集依赖</strong> - 将所有插件和依赖收集到 <code>plugins/</code> 目录</li>
<li><strong>生成插件结构</strong> - 每个插件包含 <code>ebin/</code>、<code>priv/</code> 等标准目录</li>
<li><strong>创建元数据</strong> - 生成 <code>.app</code> 文件描述插件信息</li>
</ol>
<h3 id="实际生成的目录结构"><a href="#实际生成的目录结构" class="headerlink" title="实际生成的目录结构"></a>实际生成的目录结构</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">plugins/</span><br><span class="line">├── rabbit-4.0.5/                 <span class="comment"># 核心模块目录</span></span><br><span class="line">│   ├── ebin/</span><br><span class="line">│   │   ├── rabbit.app            <span class="comment"># 应用描述文件</span></span><br><span class="line">│   │   ├── rabbit.beam           <span class="comment"># 编译后的字节码</span></span><br><span class="line">│   │   └── *.beam                <span class="comment"># 其他模块字节码</span></span><br><span class="line">│   ├── include/                  <span class="comment"># 头文件</span></span><br><span class="line">│   └── priv/                     <span class="comment"># 私有资源</span></span><br><span class="line">├── rabbitmq_management-4.0.5/    <span class="comment"># 管理插件目录</span></span><br><span class="line">├── rabbitmq_prometheus-4.0.5/    <span class="comment"># 监控插件目录</span></span><br><span class="line">└── ...                           <span class="comment"># 其他插件目录</span></span><br></pre></td></tr></table></figure>

<h3 id="使用场景与最佳实践-1"><a href="#使用场景与最佳实践-1" class="headerlink" title="使用场景与最佳实践"></a>使用场景与最佳实践</h3><h4 id="生产环境"><a href="#生产环境" class="headerlink" title="生产环境"></a>生产环境</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建发布版本</span></span><br><span class="line">make dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 验证插件结构</span></span><br><span class="line"><span class="built_in">ls</span> -la plugins/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 部署到生产环境</span></span><br><span class="line">rsync -av plugins/ /opt/rabbitmq/plugins/</span><br></pre></td></tr></table></figure>

<h4 id="插件开发"><a href="#插件开发" class="headerlink" title="插件开发"></a>插件开发</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 开发模式</span></span><br><span class="line">make dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 插件测试</span></span><br><span class="line">make run-broker PLUGINS=<span class="string">&quot;plugin_name&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-make-dist-DIST-AS-EZS-true-EZ-压缩包分发"><a href="#3-make-dist-DIST-AS-EZS-true-EZ-压缩包分发" class="headerlink" title="3. make dist DIST_AS_EZS=true - EZ 压缩包分发"></a>3. <code>make dist DIST_AS_EZS=true</code> - EZ 压缩包分发</h2><h3 id="技术原理-2"><a href="#技术原理-2" class="headerlink" title="技术原理"></a>技术原理</h3><p>EZ 格式是 Erlang 的标准插件打包格式，本质上是重命名的 ZIP 文件。</p>
<h4 id="核心实现逻辑"><a href="#核心实现逻辑" class="headerlink" title="核心实现逻辑"></a>核心实现逻辑</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：deps/rabbit_common/mk/rabbitmq-dist.mk (第 8-14 行)</span></span><br><span class="line"><span class="comment"># Set $(DIST_AS_EZS) to a non-empty value to enable the packaging of</span></span><br><span class="line"><span class="comment"># plugins as .ez archives.</span></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(USE_RABBIT_BOOT_SCRIPT)</span>,)</span><br><span class="line">DIST_AS_EZS ?=                    <span class="comment"># 默认为空（目录格式）</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">DIST_AS_EZS =                     <span class="comment"># 强制目录格式</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<h4 id="EZ-文件生成流程"><a href="#EZ-文件生成流程" class="headerlink" title="EZ 文件生成流程"></a>EZ 文件生成流程</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">make dist DIST_AS_EZS<span class="operator">=</span><span class="literal">true</span></span><br><span class="line">  ↓</span><br><span class="line">编译所有模块</span><br><span class="line">  ↓</span><br><span class="line">收集 ebin<span class="symbol">/</span> include<span class="symbol">/</span> priv<span class="symbol">/</span></span><br><span class="line">  ↓</span><br><span class="line">创建临时目录结构</span><br><span class="line">  ↓</span><br><span class="line">ZIP 压缩</span><br><span class="line">  ↓</span><br><span class="line">重命名为 .ez</span><br><span class="line">  ↓</span><br><span class="line">移动到 plugins<span class="operator">/</span></span><br></pre></td></tr></table></figure>

<h3 id="实际生成的-EZ-文件（已验证）"><a href="#实际生成的-EZ-文件（已验证）" class="headerlink" title="实际生成的 EZ 文件（已验证）"></a>实际生成的 EZ 文件（已验证）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">plugins/</span><br><span class="line">├── rabbit-4.0.5.ez              <span class="comment"># 3.38 MB - 核心模块</span></span><br><span class="line">├── rabbit_common-4.0.5.ez       <span class="comment"># 770.91 KB - 公共模块  </span></span><br><span class="line">├── rabbitmq_management-4.0.5.ez <span class="comment"># 管理界面插件</span></span><br><span class="line">├── rabbitmq_prometheus-4.0.5.ez <span class="comment"># 监控插件</span></span><br><span class="line">├── amqp_client-4.0.5.ez         <span class="comment"># 332.75 KB - AMQP 客户端</span></span><br><span class="line">├── cowboy-2.12.0.ez             <span class="comment"># 350.76 KB - HTTP 服务器</span></span><br><span class="line">├── gun-1.3.3.ez                 <span class="comment"># 109.35 KB - HTTP 客户端</span></span><br><span class="line">└── ...                          <span class="comment"># 其他插件 EZ 文件</span></span><br></pre></td></tr></table></figure>

<h3 id="EZ-格式深度分析"><a href="#EZ-格式深度分析" class="headerlink" title="EZ 格式深度分析"></a>EZ 格式深度分析</h3><h4 id="EZ-文件内部结构"><a href="#EZ-文件内部结构" class="headerlink" title="EZ 文件内部结构"></a>EZ 文件内部结构</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># EZ 文件实际上是 ZIP 格式</span></span><br><span class="line">$ unzip -l rabbit-4.0.5.ez</span><br><span class="line">Archive:  rabbit-4.0.5.ez</span><br><span class="line">  Length      Date    Time    Name</span><br><span class="line">---------  ---------- -----   ----</span><br><span class="line">     1234  2025-01-16 22:05   rabbit-4.0.5/ebin/rabbit.app</span><br><span class="line">    45678  2025-01-16 22:05   rabbit-4.0.5/ebin/rabbit.beam</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h4 id="目录-vs-EZ-格式对比"><a href="#目录-vs-EZ-格式对比" class="headerlink" title="目录 vs EZ 格式对比"></a>目录 vs EZ 格式对比</h4><table>
<thead>
<tr>
<th>特性</th>
<th>目录格式</th>
<th>EZ 格式</th>
</tr>
</thead>
<tbody><tr>
<td><strong>存储</strong></td>
<td>展开的文件夹</td>
<td>压缩的 ZIP 文件</td>
</tr>
<tr>
<td><strong>加载速度</strong></td>
<td>快速</td>
<td>略慢（需解压）</td>
</tr>
<tr>
<td><strong>调试</strong></td>
<td>容易（直接访问文件）</td>
<td>困难（需解压查看）</td>
</tr>
<tr>
<td><strong>分发</strong></td>
<td>占用空间大</td>
<td>占用空间小</td>
</tr>
<tr>
<td><strong>热加载</strong></td>
<td>支持</td>
<td>更好支持</td>
</tr>
<tr>
<td><strong>版本管理</strong></td>
<td>复杂</td>
<td>简单（文件名包含版本）</td>
</tr>
</tbody></table>
<h3 id="EZ-格式优势"><a href="#EZ-格式优势" class="headerlink" title="EZ 格式优势"></a>EZ 格式优势</h3><ol>
<li><strong>压缩存储</strong>: 减少磁盘占用和网络传输</li>
<li><strong>原子性</strong>: 单文件部署，避免部分文件丢失</li>
<li><strong>版本管理</strong>: 文件名包含版本信息</li>
<li><strong>热加载</strong>: Erlang VM 原生支持 EZ 文件热加载</li>
</ol>
<h3 id="使用场景与最佳实践-2"><a href="#使用场景与最佳实践-2" class="headerlink" title="使用场景与最佳实践"></a>使用场景与最佳实践</h3><h4 id="插件分发"><a href="#插件分发" class="headerlink" title="插件分发"></a>插件分发</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 插件开发者</span></span><br><span class="line">make dist DIST_AS_EZS=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 生成 .ez 文件用于分发</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 插件用户</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> plugin_name</span><br><span class="line"><span class="comment"># 从 .ez 文件安装插件</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-make-source-dist-源码分发包"><a href="#4-make-source-dist-源码分发包" class="headerlink" title="4. make source-dist - 源码分发包"></a>4. <code>make source-dist</code> - 源码分发包</h2><h3 id="技术原理-3"><a href="#技术原理-3" class="headerlink" title="技术原理"></a>技术原理</h3><p><code>make source-dist</code> 创建一个完整的、可复现的源码归档包（tar.xz），包含所有依赖和构建所需的文件。这是 <code>make package-generic-unix</code> 的前置步骤。</p>
<h4 id="核心实现源码-1"><a href="#核心实现源码-1" class="headerlink" title="核心实现源码"></a>核心实现源码</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：Makefile (第 142-152 行)</span></span><br><span class="line">SOURCE_DIST_BASE ?= rabbitmq-server</span><br><span class="line">SOURCE_DIST_SUFFIXES ?= tar.xz</span><br><span class="line">SOURCE_DIST ?= <span class="variable">$(PACKAGES_DIR)</span>/<span class="variable">$(SOURCE_DIST_BASE)</span>-<span class="variable">$(PROJECT_VERSION)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 源码包文件</span></span><br><span class="line">SOURCE_DIST_FILES = <span class="variable">$(<span class="built_in">addprefix</span> <span class="variable">$(SOURCE_DIST)</span>.,<span class="variable">$(SOURCE_DIST_SUFFIXES)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="section">source-dist: <span class="variable">$(SOURCE_DIST_FILES)</span></span></span><br><span class="line">  @:</span><br><span class="line"></span><br><span class="line"><span class="comment"># 来源：Makefile (第 234-306 行)</span></span><br><span class="line"><span class="variable">$(SOURCE_DIST)</span>: <span class="variable">$(ERLANG_MK_RECURSIVE_DEPS_LIST)</span></span><br><span class="line">  <span class="variable">$(verbose)</span> mkdir -p <span class="variable">$(<span class="built_in">dir</span> <span class="variable">$@</span>)</span></span><br><span class="line">  <span class="variable">$(gen_verbose)</span> <span class="variable">$(RSYNC)</span> <span class="variable">$(RSYNC_FLAGS)</span> ./ <span class="variable">$@</span>/</span><br><span class="line">  <span class="comment"># 收集依赖、许可证、版本信息等</span></span><br></pre></td></tr></table></figure>

<h4 id="打包流程详解-1"><a href="#打包流程详解-1" class="headerlink" title="打包流程详解"></a>打包流程详解</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">make source-dist</span><br><span class="line">  ↓</span><br><span class="line">解析依赖列表 (ERLANG_MK_RECURSIVE_DEPS_LIST)</span><br><span class="line">  ↓</span><br><span class="line">rsync 复制主项目 (排除 <span class="selector-class">.git</span>, <span class="selector-class">.beam</span>, deps/ 等)</span><br><span class="line">  ↓</span><br><span class="line">收集所有依赖到 deps/</span><br><span class="line">  ↓</span><br><span class="line">处理许可证文件 (LICENSE)</span><br><span class="line">  ↓</span><br><span class="line">更新版本信息 (<span class="selector-class">.app</span><span class="selector-class">.src</span> 文件)</span><br><span class="line">  ↓</span><br><span class="line">生成 git-revisions<span class="selector-class">.txt</span> (版本追踪)</span><br><span class="line">  ↓</span><br><span class="line">处理 Mix/Hex 缓存 (用于离线构建)</span><br><span class="line">  ↓</span><br><span class="line">固定文件时间戳 (可复现性)</span><br><span class="line">  ↓</span><br><span class="line">生成 manifest 文件</span><br><span class="line">  ↓</span><br><span class="line">创建 tar<span class="selector-class">.xz</span> 归档</span><br></pre></td></tr></table></figure>

<h4 id="RSYNC-排除规则"><a href="#RSYNC-排除规则" class="headerlink" title="RSYNC 排除规则"></a>RSYNC 排除规则</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">RSYNC_FLAGS += -a <span class="variable">$(RSYNC_V)</span>              \</span><br><span class="line">  --exclude &#x27;.sw?&#x27; --exclude &#x27;.*.sw?&#x27;   \  <span class="comment"># vim 交换文件</span></span><br><span class="line">  --exclude &#x27;*.beam&#x27;                    \  <span class="comment"># 编译产物</span></span><br><span class="line">  --exclude &#x27;*.d&#x27;                       \  <span class="comment"># 依赖文件</span></span><br><span class="line">  --exclude &#x27;*.pyc&#x27;                     \  <span class="comment"># Python 缓存</span></span><br><span class="line">  --exclude &#x27;.git*&#x27;                     \  <span class="comment"># Git 文件</span></span><br><span class="line">  --exclude &#x27;.hg*&#x27;                      \  <span class="comment"># Mercurial 文件</span></span><br><span class="line">  --exclude &#x27;*.bzl&#x27;                     \  <span class="comment"># Bazel 文件</span></span><br><span class="line">  --exclude &#x27;*.bazel&#x27;                   \</span><br><span class="line">  --exclude &#x27;BUILD.*&#x27;                   \</span><br><span class="line">  --exclude &#x27;deps/&#x27;                     \  <span class="comment"># 依赖目录（单独处理）</span></span><br><span class="line">  --exclude &#x27;ebin/&#x27;                     \  <span class="comment"># 编译输出</span></span><br><span class="line">  --exclude &#x27;plugins/&#x27;                  \  <span class="comment"># 插件目录</span></span><br><span class="line">  --exclude &#x27;test/&#x27;                     \  <span class="comment"># 测试文件</span></span><br><span class="line">  --exclude &#x27;sbin/&#x27;                     \  <span class="comment"># 生成的脚本</span></span><br><span class="line">  <span class="comment"># ... 更多排除规则</span></span><br></pre></td></tr></table></figure>

<h3 id="实际生成的文件"><a href="#实际生成的文件" class="headerlink" title="实际生成的文件"></a>实际生成的文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PACKAGES/</span><br><span class="line">├── rabbitmq-server-4.0.5/              <span class="comment"># 解压后的源码目录</span></span><br><span class="line">│   ├── Makefile                        <span class="comment"># 主构建文件</span></span><br><span class="line">│   ├── erlang.mk                       <span class="comment"># Erlang.mk 构建系统</span></span><br><span class="line">│   ├── plugins.mk                      <span class="comment"># 插件定义</span></span><br><span class="line">│   ├── deps/                           <span class="comment"># 所有依赖源码</span></span><br><span class="line">│   │   ├── rabbit/                     <span class="comment"># 核心模块</span></span><br><span class="line">│   │   ├── rabbit_common/              <span class="comment"># 公共模块</span></span><br><span class="line">│   │   ├── rabbitmq_management/        <span class="comment"># 管理插件</span></span><br><span class="line">│   │   └── ...                         <span class="comment"># 其他依赖</span></span><br><span class="line">│   ├── LICENSE                         <span class="comment"># 合并的许可证文件</span></span><br><span class="line">│   ├── LICENSE-*                       <span class="comment"># 各组件许可证</span></span><br><span class="line">│   └── git-revisions.txt               <span class="comment"># Git 版本追踪</span></span><br><span class="line">├── rabbitmq-server-4.0.5.tar.xz        <span class="comment"># 源码归档包 (~5MB)</span></span><br><span class="line">└── rabbitmq-server-4.0.5.manifest      <span class="comment"># 文件清单</span></span><br></pre></td></tr></table></figure>

<h3 id="可复现性特性"><a href="#可复现性特性" class="headerlink" title="可复现性特性"></a>可复现性特性</h3><ol>
<li><strong>固定时间戳</strong> - 所有文件时间戳基于最新 Git 提交</li>
<li><strong>排序文件列表</strong> - manifest 使用 <code>LC_COLLATE=C sort</code> 确保一致性</li>
<li><strong>Hex 缓存处理</strong> - 将 ETS 缓存转为 Erlang term 文件避免二进制差异</li>
<li><strong>版本信息嵌入</strong> - 自动更新所有 <code>.app.src</code> 中的版本号</li>
</ol>
<h3 id="使用场景与最佳实践-3"><a href="#使用场景与最佳实践-3" class="headerlink" title="使用场景与最佳实践"></a>使用场景与最佳实践</h3><h4 id="离线构建"><a href="#离线构建" class="headerlink" title="离线构建"></a>离线构建</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 在联网环境创建源码包</span></span><br><span class="line">make source-dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 传输到离线环境</span></span><br><span class="line">scp PACKAGES/rabbitmq-server-4.0.5.tar.xz offline-server:/tmp/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 离线构建</span></span><br><span class="line">ssh offline-server</span><br><span class="line">tar -xf /tmp/rabbitmq-server-4.0.5.tar.xz</span><br><span class="line"><span class="built_in">cd</span> rabbitmq-server-4.0.5</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<h4 id="版本发布"><a href="#版本发布" class="headerlink" title="版本发布"></a>版本发布</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 官方发布流程</span></span><br><span class="line">make source-dist</span><br><span class="line"><span class="comment"># 生成的 tar.xz 可上传到 GitHub Releases</span></span><br></pre></td></tr></table></figure>

<h4 id="作为-package-generic-unix-的输入"><a href="#作为-package-generic-unix-的输入" class="headerlink" title="作为 package-generic-unix 的输入"></a>作为 package-generic-unix 的输入</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># make package-generic-unix 内部依赖 source-dist</span></span><br><span class="line">make package-generic-unix</span><br><span class="line"><span class="comment"># 实际执行：</span></span><br><span class="line"><span class="comment"># 1. make source-dist (生成源码包)</span></span><br><span class="line"><span class="comment"># 2. 解压源码包</span></span><br><span class="line"><span class="comment"># 3. 编译并打包为通用包</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-make-package-generic-unix-通用-Unix-包"><a href="#5-make-package-generic-unix-通用-Unix-包" class="headerlink" title="5. make package-generic-unix - 通用 Unix 包"></a>5. <code>make package-generic-unix</code> - 通用 Unix 包</h2><h3 id="技术原理-4"><a href="#技术原理-4" class="headerlink" title="技术原理"></a>技术原理</h3><p>创建跨平台的 tar.xz 安装包，包含完整的 RabbitMQ 运行环境。<strong>依赖 <code>make source-dist</code> 生成的源码包作为输入。</strong></p>
<h4 id="核心实现源码-2"><a href="#核心实现源码-2" class="headerlink" title="核心实现源码"></a>核心实现源码</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：packaging/generic-unix/Makefile (第 33-76 行)</span></span><br><span class="line">SOURCE_DIR = rabbitmq-server-<span class="variable">$(VERSION)</span></span><br><span class="line">TARGET_DIR = rabbitmq_server-<span class="variable">$(VERSION)</span></span><br><span class="line">TARGET_TARBALL = rabbitmq-server-<span class="variable">$(TARBALL_SUFFIX)</span>-<span class="variable">$(VERSION)</span></span><br><span class="line"></span><br><span class="line"><span class="section">dist:</span></span><br><span class="line">  <span class="comment"># 解压源码包</span></span><br><span class="line">  xzcat <span class="variable">$(SOURCE_DIST_FILE)</span> | tar -xf -</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 编译并安装到目标目录</span></span><br><span class="line">  <span class="variable">$(MAKE)</span> -C <span class="variable">$(SOURCE_DIR)</span> \</span><br><span class="line">    PREFIX= RMQ_ROOTDIR= \</span><br><span class="line">    RMQ_ERLAPP_DIR=`pwd`/<span class="variable">$(TARGET_DIR)</span> \</span><br><span class="line">    MANDIR=`pwd`/<span class="variable">$(TARGET_DIR)</span>/share/man \</span><br><span class="line">    manpages web-manpages install install-man</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 修改配置文件</span></span><br><span class="line">  sed -e &#x27;s:^SYS_PREFIX=$$:SYS_PREFIX=\$$&#123;RABBITMQ_HOME&#125;:&#x27; \</span><br><span class="line">        <span class="variable">$(TARGET_DIR)</span>/sbin/rabbitmq-defaults &gt;<span class="variable">$(TARGET_DIR)</span>/sbin/rabbitmq-defaults.tmp</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># 创建 tar.xz 包</span></span><br><span class="line">  find <span class="variable">$(TARGET_DIR)</span> | LC_COLLATE=C sort &gt; <span class="variable">$(TARGET_TARBALL)</span>.manifest</span><br><span class="line">  tar --no-recursion -T <span class="variable">$(TARGET_TARBALL)</span>.manifest -cf - | \</span><br><span class="line">  xz &gt; <span class="variable">$(CURDIR)</span>/<span class="variable">$(TARGET_TARBALL)</span>.tar.xz</span><br></pre></td></tr></table></figure>

<h4 id="打包流程详解-2"><a href="#打包流程详解-2" class="headerlink" title="打包流程详解"></a>打包流程详解</h4><ol>
<li><strong>解压源码包</strong> - 从 tar.xz 源码包开始</li>
<li><strong>编译安装</strong> - 使用标准 Unix 安装路径</li>
<li><strong>生成文档</strong> - 创建 man 手册页</li>
<li><strong>配置脚本</strong> - 调整启动脚本的路径变量</li>
<li><strong>创建归档</strong> - 打包成 tar.xz 格式</li>
</ol>
<h3 id="实际生成的包结构（已验证）"><a href="#实际生成的包结构（已验证）" class="headerlink" title="实际生成的包结构（已验证）"></a>实际生成的包结构（已验证）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PACKAGES/</span><br><span class="line">├── rabbitmq-server-4.0.5.tar.xz           <span class="comment"># 4.95 MB - 源码包</span></span><br><span class="line">├── rabbitmq-server-generic-unix-4.0.5.tar.xz  <span class="comment"># 15.51 MB - 通用包</span></span><br><span class="line">├── rabbitmq-server-4.0.5.manifest         <span class="comment"># 230.22 KB - 文件清单</span></span><br><span class="line">└── rabbitmq-server-4.0.5/                 <span class="comment"># 解压后的源码目录</span></span><br><span class="line">    ├── sbin/                              <span class="comment"># 启动脚本 (25 个文件)</span></span><br><span class="line">    ├── deps/                              <span class="comment"># 依赖模块 (86 个目录)</span></span><br><span class="line">    ├── etc/                               <span class="comment"># 配置目录</span></span><br><span class="line">    └── ...                                <span class="comment"># 其他文件</span></span><br></pre></td></tr></table></figure>

<h4 id="通用包内容分析"><a href="#通用包内容分析" class="headerlink" title="通用包内容分析"></a>通用包内容分析</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压通用包后的目录结构</span></span><br><span class="line">rabbitmq_server-4.0.5/</span><br><span class="line">├── lib/                          <span class="comment"># Erlang 应用库</span></span><br><span class="line">│   └── rabbitmq_server-4.0.5/</span><br><span class="line">│       ├── ebin/                <span class="comment"># 字节码文件</span></span><br><span class="line">│       ├── include/             <span class="comment"># 头文件</span></span><br><span class="line">│       └── priv/                <span class="comment"># 私有资源</span></span><br><span class="line">├── sbin/                        <span class="comment"># 启动脚本</span></span><br><span class="line">│   ├── rabbitmq-server         <span class="comment"># 已配置 RABBITMQ_HOME</span></span><br><span class="line">│   ├── rabbitmqctl</span><br><span class="line">│   └── ...</span><br><span class="line">├── etc/                         <span class="comment"># 配置目录</span></span><br><span class="line">│   └── rabbitmq/</span><br><span class="line">├── share/                       <span class="comment"># 文档和手册</span></span><br><span class="line">│   └── man/</span><br><span class="line">└── plugins/                     <span class="comment"># 插件目录</span></span><br></pre></td></tr></table></figure>

<h3 id="通用包特点"><a href="#通用包特点" class="headerlink" title="通用包特点"></a>通用包特点</h3><ol>
<li><strong>自包含</strong>: 包含所有运行时依赖</li>
<li><strong>可移植</strong>: 适用于各种 Unix 系统</li>
<li><strong>标准化</strong>: 遵循 Unix 目录结构规范</li>
<li><strong>生产就绪</strong>: 包含完整的配置和文档</li>
</ol>
<h3 id="使用场景与最佳实践-4"><a href="#使用场景与最佳实践-4" class="headerlink" title="使用场景与最佳实践"></a>使用场景与最佳实践</h3><h4 id="容器化部署"><a href="#容器化部署" class="headerlink" title="容器化部署"></a>容器化部署</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 构建通用包</span></span><br><span class="line">make package-generic-unix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Dockerfile 示例</span></span><br><span class="line">FROM ubuntu:20.04</span><br><span class="line">COPY PACKAGES/rabbitmq-server-generic-unix-*.tar.xz /tmp/</span><br><span class="line">RUN tar -xf /tmp/rabbitmq-server-generic-unix-*.tar.xz -C /opt/</span><br></pre></td></tr></table></figure>

<h4 id="跨平台分发"><a href="#跨平台分发" class="headerlink" title="跨平台分发"></a>跨平台分发</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建分发包</span></span><br><span class="line">make package-generic-unix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 部署到不同系统</span></span><br><span class="line">scp PACKAGES/rabbitmq-server-generic-unix-*.tar.xz user@server:/tmp/</span><br><span class="line">ssh user@server <span class="string">&#x27;cd /opt &amp;&amp; tar -xf /tmp/rabbitmq-server-generic-unix-*.tar.xz&#x27;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-make-install-系统级安装"><a href="#6-make-install-系统级安装" class="headerlink" title="6. make install - 系统级安装"></a>6. <code>make install</code> - 系统级安装</h2><h3 id="技术原理-5"><a href="#技术原理-5" class="headerlink" title="技术原理"></a>技术原理</h3><p>将 RabbitMQ 安装到系统标准路径，遵循 FHS (Filesystem Hierarchy Standard)。</p>
<h4 id="核心实现逻辑-1"><a href="#核心实现逻辑-1" class="headerlink" title="核心实现逻辑"></a>核心实现逻辑</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：Makefile 第 489-523 行</span></span><br><span class="line">PREFIX ?= /usr/local</span><br><span class="line">RMQ_ROOTDIR ?= <span class="variable">$(PREFIX)</span>/lib/erlang</span><br><span class="line">RMQ_BINDIR ?= <span class="variable">$(RMQ_ROOTDIR)</span>/bin</span><br><span class="line">RMQ_LIBDIR ?= <span class="variable">$(RMQ_ROOTDIR)</span>/lib</span><br><span class="line">RMQ_ERLAPP_DIR ?= <span class="variable">$(RMQ_LIBDIR)</span>/rabbitmq_server-<span class="variable">$(PROJECT_VERSION)</span></span><br><span class="line"></span><br><span class="line"><span class="section">install: install-erlapp install-scripts</span></span><br><span class="line"></span><br><span class="line"><span class="section">install-erlapp: dist</span></span><br><span class="line">  <span class="variable">$(verbose)</span> mkdir -p <span class="variable">$(DESTDIR)</span><span class="variable">$(RMQ_ERLAPP_DIR)</span></span><br><span class="line">  <span class="variable">$(inst_verbose)</span> cp -r \</span><br><span class="line">    LICENSE* \</span><br><span class="line">    <span class="variable">$(DEPS_DIR)</span>/rabbit/INSTALL \</span><br><span class="line">    <span class="variable">$(DIST_DIR)</span> \</span><br><span class="line">    <span class="variable">$(DESTDIR)</span><span class="variable">$(RMQ_ERLAPP_DIR)</span></span><br></pre></td></tr></table></figure>

<h4 id="安装组件详解"><a href="#安装组件详解" class="headerlink" title="安装组件详解"></a>安装组件详解</h4><ol>
<li><strong>核心应用</strong> (<code>install-erlapp</code>) - 安装 Erlang 应用和插件</li>
<li><strong>启动脚本</strong> (<code>install-scripts</code>) - 安装服务启动脚本</li>
<li><strong>命令行工具</strong> (<code>install-bin</code>) - 安装管理工具</li>
<li><strong>手册页</strong> (<code>install-man</code>) - 安装文档</li>
</ol>
<h3 id="系统安装目录结构"><a href="#系统安装目录结构" class="headerlink" title="系统安装目录结构"></a>系统安装目录结构</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/</span><br><span class="line">├── bin/                         <span class="comment"># 可执行文件</span></span><br><span class="line">│   ├── rabbitmq-server</span><br><span class="line">│   ├── rabbitmqctl</span><br><span class="line">│   └── ...</span><br><span class="line">├── lib/                         <span class="comment"># 库文件</span></span><br><span class="line">│   └── rabbitmq/</span><br><span class="line">│       ├── lib/                <span class="comment"># Erlang 应用</span></span><br><span class="line">│       └── plugins/            <span class="comment"># 插件目录</span></span><br><span class="line">├── etc/                        <span class="comment"># 配置文件</span></span><br><span class="line">│   └── rabbitmq/</span><br><span class="line">│       └── rabbitmq.conf</span><br><span class="line">├── var/                        <span class="comment"># 数据目录</span></span><br><span class="line">│   ├── <span class="built_in">log</span>/rabbitmq/          <span class="comment"># 日志</span></span><br><span class="line">│   └── lib/rabbitmq/          <span class="comment"># 数据库</span></span><br><span class="line">└── share/                      <span class="comment"># 文档</span></span><br><span class="line">    └── man/                    <span class="comment"># 手册页</span></span><br></pre></td></tr></table></figure>

<h3 id="系统安装优势"><a href="#系统安装优势" class="headerlink" title="系统安装优势"></a>系统安装优势</h3><ol>
<li><strong>标准化</strong>: 遵循 Unix 标准目录结构</li>
<li><strong>多用户</strong>: 支持系统级多用户访问</li>
<li><strong>服务集成</strong>: 便于集成到系统服务管理</li>
<li><strong>权限管理</strong>: 利用系统权限控制</li>
</ol>
<h3 id="使用场景与最佳实践-5"><a href="#使用场景与最佳实践-5" class="headerlink" title="使用场景与最佳实践"></a>使用场景与最佳实践</h3><h4 id="系统级部署"><a href="#系统级部署" class="headerlink" title="系统级部署"></a>系统级部署</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 系统安装</span></span><br><span class="line"><span class="built_in">sudo</span> make install PREFIX=/opt/rabbitmq</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 服务配置</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> rabbitmq-server</span><br><span class="line"><span class="built_in">sudo</span> systemctl start rabbitmq-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 多用户环境</span></span><br><span class="line"><span class="built_in">sudo</span> adduser rabbitmq</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chown</span> -R rabbitmq:rabbitmq /opt/rabbitmq</span><br></pre></td></tr></table></figure>

<h4 id="包管理器集成"><a href="#包管理器集成" class="headerlink" title="包管理器集成"></a>包管理器集成</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 创建 deb/rpm 包</span></span><br><span class="line">make install DESTDIR=/tmp/rabbitmq-package PREFIX=/usr</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 打包</span></span><br><span class="line">fpm -s <span class="built_in">dir</span> -t deb -C /tmp/rabbitmq-package \</span><br><span class="line">    --name rabbitmq-server \</span><br><span class="line">    --version 4.0.5 \</span><br><span class="line">    .</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-开发调试命令"><a href="#7-开发调试命令" class="headerlink" title="7. 开发调试命令"></a>7. 开发调试命令</h2><h3 id="make-run-broker-启动开发服务器"><a href="#make-run-broker-启动开发服务器" class="headerlink" title="make run-broker - 启动开发服务器"></a><code>make run-broker</code> - 启动开发服务器</h3><h4 id="技术原理-6"><a href="#技术原理-6" class="headerlink" title="技术原理"></a>技术原理</h4><p><code>make run-broker</code> 在前台启动 RabbitMQ 服务器，适合开发调试。日志直接输出到终端，便于实时查看。</p>
<h4 id="核心实现源码-3"><a href="#核心实现源码-3" class="headerlink" title="核心实现源码"></a>核心实现源码</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：deps/rabbit_common/mk/rabbitmq-run.mk (第 269-278 行)</span></span><br><span class="line">run-broker run-tls-broker: RABBITMQ_CONFIG_FILE := <span class="variable">$(<span class="built_in">basename</span> <span class="variable">$(TEST_CONFIG_FILE)</span>)</span></span><br><span class="line"><span class="section">run-broker:     config = <span class="variable">$(test_rabbitmq_config)</span></span></span><br><span class="line"><span class="section">run-tls-broker: config = <span class="variable">$(test_rabbitmq_config_with_tls)</span></span></span><br><span class="line"></span><br><span class="line">run-broker run-tls-broker: node-tmpdir <span class="variable">$(DIST_TARGET)</span> <span class="variable">$(TEST_CONFIG_FILE)</span></span><br><span class="line">  <span class="variable">$(BASIC_SCRIPT_ENV_SETTINGS)</span> \</span><br><span class="line">    RABBITMQ_ALLOW_INPUT=true \</span><br><span class="line">    RABBITMQ_CONFIG_FILE=<span class="variable">$(RABBITMQ_CONFIG_FILE)</span> \</span><br><span class="line">    <span class="variable">$(RABBITMQ_SERVER)</span></span><br></pre></td></tr></table></figure>

<h4 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">make run-broker</span><br><span class="line">  ↓</span><br><span class="line">创建临时目录 (<span class="keyword">node</span><span class="title">-tmpdir</span>)</span><br><span class="line">  ↓</span><br><span class="line">执行 make dist (如需要)</span><br><span class="line">  ↓</span><br><span class="line">生成测试配置文件</span><br><span class="line">  ↓</span><br><span class="line">设置环境变量</span><br><span class="line">  ↓</span><br><span class="line">启动 rabbitmq-server (前台)</span><br></pre></td></tr></table></figure>

<h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 基础开发调试</span></span><br><span class="line">make run-broker</span><br><span class="line"><span class="comment"># 日志直接输出到终端，Ctrl+C 停止</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 后台启动</span></span><br><span class="line">make run-background-broker</span><br><span class="line"><span class="comment"># 服务在后台运行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. TLS 模式启动</span></span><br><span class="line">make run-tls-broker</span><br><span class="line"><span class="comment"># 使用 TLS 配置启动</span></span><br></pre></td></tr></table></figure>

<h3 id="make-run-broker-PLUGINS-插件测试"><a href="#make-run-broker-PLUGINS-插件测试" class="headerlink" title="make run-broker PLUGINS= - 插件测试"></a><code>make run-broker PLUGINS=</code> - 插件测试</h3><h4 id="技术原理-7"><a href="#技术原理-7" class="headerlink" title="技术原理"></a>技术原理</h4><p>通过 <code>PLUGINS</code> 环境变量指定要加载的插件，用于测试特定插件功能。</p>
<h4 id="使用场景-1"><a href="#使用场景-1" class="headerlink" title="使用场景"></a>使用场景</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 测试管理插件</span></span><br><span class="line">make run-broker PLUGINS=<span class="string">&quot;rabbitmq_management&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 测试多个插件</span></span><br><span class="line">make run-broker PLUGINS=<span class="string">&quot;rabbitmq_management rabbitmq_prometheus&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 测试自定义插件</span></span><br><span class="line">make run-broker PLUGINS=<span class="string">&quot;my_custom_plugin&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul>
<li>插件名称使用空格分隔</li>
<li>插件需要先编译完成（<code>make dist</code>）</li>
<li>依赖插件会自动加载</li>
</ul>
<h3 id="make-shell-Erlang-Shell"><a href="#make-shell-Erlang-Shell" class="headerlink" title="make shell - Erlang Shell"></a><code>make shell</code> - Erlang Shell</h3><h4 id="技术原理-8"><a href="#技术原理-8" class="headerlink" title="技术原理"></a>技术原理</h4><p>启动一个加载了所有 RabbitMQ 模块的 Erlang Shell，用于代码调试和模块测试。</p>
<h4 id="核心实现源码-4"><a href="#核心实现源码-4" class="headerlink" title="核心实现源码"></a>核心实现源码</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：erlang.mk (第 7053-7054 行)</span></span><br><span class="line"><span class="section">shell:: build-shell-deps</span></span><br><span class="line">  <span class="variable">$(gen_verbose)</span> <span class="variable">$(SHELL_ERL)</span> -pa <span class="variable">$(SHELL_PATHS)</span> <span class="variable">$(SHELL_OPTS)</span></span><br></pre></td></tr></table></figure>

<h4 id="使用场景-2"><a href="#使用场景-2" class="headerlink" title="使用场景"></a>使用场景</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 进入 Erlang Shell</span></span><br><span class="line">make shell</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 Shell 中：</span></span><br><span class="line"><span class="comment"># 测试模块函数</span></span><br><span class="line">1&gt; rabbit_misc:version().</span><br><span class="line"><span class="string">&quot;4.0.5&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查模块信息</span></span><br><span class="line">2&gt; m(rabbit).</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译并加载修改后的模块</span></span><br><span class="line">3&gt; c(my_module).</span><br></pre></td></tr></table></figure>

<h4 id="与-erl-的区别"><a href="#与-erl-的区别" class="headerlink" title="与 erl 的区别"></a>与 <code>erl</code> 的区别</h4><table>
<thead>
<tr>
<th>特性</th>
<th><code>make shell</code></th>
<th><code>erl</code></th>
</tr>
</thead>
<tbody><tr>
<td>代码路径</td>
<td>自动设置所有依赖</td>
<td>需手动指定</td>
</tr>
<tr>
<td>模块加载</td>
<td>RabbitMQ 模块可用</td>
<td>需手动加载</td>
</tr>
<tr>
<td>环境变量</td>
<td>继承项目配置</td>
<td>默认配置</td>
</tr>
<tr>
<td>用途</td>
<td>RabbitMQ 开发调试</td>
<td>通用 Erlang 开发</td>
</tr>
</tbody></table>
<h3 id="make-run-node-裸-Erlang-节点"><a href="#make-run-node-裸-Erlang-节点" class="headerlink" title="make run-node - 裸 Erlang 节点"></a><code>make run-node</code> - 裸 Erlang 节点</h3><h4 id="技术原理-9"><a href="#技术原理-9" class="headerlink" title="技术原理"></a>技术原理</h4><p>启动一个不运行 RabbitMQ 应用的 Erlang 节点，仅加载代码但不启动服务。</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 来源：deps/rabbit_common/mk/rabbitmq-run.mk (第 288-292 行)</span></span><br><span class="line"><span class="section">run-node: node-tmpdir <span class="variable">$(DIST_TARGET)</span></span></span><br><span class="line">  <span class="variable">$(BASIC_SCRIPT_ENV_SETTINGS)</span> \</span><br><span class="line">    RABBITMQ_NODE_ONLY=true \</span><br><span class="line">    RABBITMQ_ALLOW_INPUT=true \</span><br><span class="line">    <span class="variable">$(RABBITMQ_SERVER)</span></span><br></pre></td></tr></table></figure>

<h4 id="使用场景-3"><a href="#使用场景-3" class="headerlink" title="使用场景"></a>使用场景</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Erlang 级别调试</span></span><br><span class="line">make run-node</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 手动启动 RabbitMQ 应用</span></span><br><span class="line">1&gt; application:ensure_all_started(rabbit).</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 测试特定模块而不启动完整服务</span></span><br><span class="line">1&gt; rabbit_misc:version().</span><br></pre></td></tr></table></figure>

<h3 id="开发工作流最佳实践"><a href="#开发工作流最佳实践" class="headerlink" title="开发工作流最佳实践"></a>开发工作流最佳实践</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 完整开发工作流</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 编译项目</span></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 测试模块（不启动服务）</span></span><br><span class="line">make shell</span><br><span class="line">&gt; my_module:<span class="built_in">test</span>().</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 启动服务验证</span></span><br><span class="line">make run-broker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 测试特定插件</span></span><br><span class="line">make run-broker PLUGINS=<span class="string">&quot;rabbitmq_management&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 查看管理界面</span></span><br><span class="line"><span class="comment"># 浏览器访问 http://localhost:15672</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 修改代码后重新编译</span></span><br><span class="line">make  <span class="comment"># 增量编译</span></span><br><span class="line">make run-broker  <span class="comment"># 重新启动</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="构建系统架构深度解析"><a href="#构建系统架构深度解析" class="headerlink" title="构建系统架构深度解析"></a>构建系统架构深度解析</h2><h3 id="核心组件关系"><a href="#核心组件关系" class="headerlink" title="核心组件关系"></a>核心组件关系</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Makefile</span><br><span class="line">  ├── erlang<span class="selector-class">.mk</span>          → 编译 Erlang 代码 → 生成 <span class="selector-class">.beam</span> 文件</span><br><span class="line">  ├── rabbitmq-components<span class="selector-class">.mk</span> → 管理组件依赖 → deps/ 目录</span><br><span class="line">  └── plugins<span class="selector-class">.mk</span>         → 插件列表管理 → PLUGINS 变量</span><br><span class="line">                                    ↓</span><br><span class="line">                          rabbitmq-dist<span class="selector-class">.mk</span></span><br><span class="line">                                    ↓</span><br><span class="line">                    ┌───────────────┴───────────────┐</span><br><span class="line">                    ↓                               ↓</span><br><span class="line">              dist 目标                         EZ 打包</span><br><span class="line">                    ↓                               ↓</span><br><span class="line">            plugins/ 目录                      <span class="selector-class">.ez</span> 文件</span><br></pre></td></tr></table></figure>

<h3 id="关键配置文件详解"><a href="#关键配置文件详解" class="headerlink" title="关键配置文件详解"></a>关键配置文件详解</h3><h4 id="1-Makefile-主控制文件"><a href="#1-Makefile-主控制文件" class="headerlink" title="1. Makefile - 主控制文件"></a>1. <code>Makefile</code> - 主控制文件</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PROJECT = rabbitmq_server_release</span><br><span class="line">PROJECT_DESCRIPTION = RabbitMQ Server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插件列表</span></span><br><span class="line"><span class="keyword">include</span> plugins.mk</span><br><span class="line">DEPS = rabbit_common rabbit <span class="variable">$(PLUGINS)</span> <span class="variable">$(ADDITIONAL_PLUGINS)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建系统</span></span><br><span class="line"><span class="keyword">include</span> rabbitmq-components.mk</span><br><span class="line"><span class="keyword">include</span> erlang.mk</span><br></pre></td></tr></table></figure>

<h4 id="2-plugins-mk-插件定义"><a href="#2-plugins-mk-插件定义" class="headerlink" title="2. plugins.mk - 插件定义"></a>2. <code>plugins.mk</code> - 插件定义</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PLUGINS = \</span><br><span class="line">  rabbitmq_amqp1_0 \</span><br><span class="line">  rabbitmq_auth_backend_cache \</span><br><span class="line">  rabbitmq_auth_backend_http \</span><br><span class="line">  rabbitmq_auth_backend_ldap \</span><br><span class="line">  rabbitmq_auth_backend_oauth2 \</span><br><span class="line">  rabbitmq_auth_mechanism_ssl \</span><br><span class="line">  rabbitmq_consistent_hash_exchange \</span><br><span class="line">  <span class="comment"># ... 更多插件</span></span><br></pre></td></tr></table></figure>

<h4 id="3-rabbitmq-dist-mk-分发逻辑"><a href="#3-rabbitmq-dist-mk-分发逻辑" class="headerlink" title="3. rabbitmq-dist.mk - 分发逻辑"></a>3. <code>rabbitmq-dist.mk</code> - 分发逻辑</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># EZ 文件生成宏</span></span><br><span class="line"><span class="keyword">define</span> do_ez_target_erlangmk</span><br><span class="line"><span class="comment"># 定义目标目录和文件名</span></span><br><span class="line">dist_$(1)_ez_dir = <span class="variable">$(DIST_DIR)</span>/$(1)-$(2)</span><br><span class="line"><span class="comment"># 根据 DIST_AS_EZS 决定格式</span></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(DIST_AS_EZS)</span>,)</span><br><span class="line">dist_$(1)_ez = $$(dist_$(1)_ez_dir)      <span class="comment"># 目录</span></span><br><span class="line"><span class="keyword">else</span>  </span><br><span class="line">dist_$(1)_ez = $$(dist_$(1)_ez_dir).ez   <span class="comment"># EZ 文件</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">endef</span></span><br></pre></td></tr></table></figure>

<h3 id="构建系统特点"><a href="#构建系统特点" class="headerlink" title="构建系统特点"></a>构建系统特点</h3><ol>
<li><strong>模块化设计</strong> - 每个 <code>.mk</code> 文件负责特定功能</li>
<li><strong>可扩展性</strong> - 支持自定义插件和构建规则</li>
<li><strong>标准化</strong> - 遵循 Erlang&#x2F;OTP 和 Unix 标准</li>
<li><strong>自动化</strong> - 完整的依赖管理和构建流程</li>
</ol>
<hr>
<h2 id="完整编译流程对比"><a href="#完整编译流程对比" class="headerlink" title="完整编译流程对比"></a>完整编译流程对比</h2><h3 id="性能和资源详细对比"><a href="#性能和资源详细对比" class="headerlink" title="性能和资源详细对比"></a>性能和资源详细对比</h3><h4 id="构建命令-1"><a href="#构建命令-1" class="headerlink" title="构建命令"></a>构建命令</h4><table>
<thead>
<tr>
<th>编译方式</th>
<th>编译时间</th>
<th>磁盘占用</th>
<th>内存使用</th>
<th>网络传输</th>
<th>部署复杂度</th>
<th>维护成本</th>
</tr>
</thead>
<tbody><tr>
<td><code>make</code></td>
<td>最快 (30s)</td>
<td>中等 (200MB)</td>
<td>低 (100MB)</td>
<td>不适用</td>
<td>简单</td>
<td>低</td>
</tr>
<tr>
<td><code>make dist</code></td>
<td>快 (45s)</td>
<td>大 (300MB)</td>
<td>中等 (150MB)</td>
<td>大 (300MB)</td>
<td>中等</td>
<td>中等</td>
</tr>
<tr>
<td><code>make dist DIST_AS_EZS=true</code></td>
<td>中等 (60s)</td>
<td>小 (15MB)</td>
<td>中等 (150MB)</td>
<td>小 (15MB)</td>
<td>简单</td>
<td>低</td>
</tr>
<tr>
<td><code>make source-dist</code></td>
<td>快 (40s)</td>
<td>小 (~5MB)</td>
<td>低 (100MB)</td>
<td>小 (~5MB)</td>
<td>简单</td>
<td>低</td>
</tr>
<tr>
<td><code>make package-generic-unix</code></td>
<td>慢 (120s)</td>
<td>最小 (15.51MB)</td>
<td>高 (200MB)</td>
<td>最小 (15.51MB)</td>
<td>简单</td>
<td>低</td>
</tr>
<tr>
<td><code>make install</code></td>
<td>中等 (75s)</td>
<td>中等 (250MB)</td>
<td>低 (100MB)</td>
<td>不适用</td>
<td>复杂</td>
<td>高</td>
</tr>
</tbody></table>
<h4 id="开发调试命令-1"><a href="#开发调试命令-1" class="headerlink" title="开发调试命令"></a>开发调试命令</h4><table>
<thead>
<tr>
<th>命令</th>
<th>启动时间</th>
<th>用途</th>
<th>交互性</th>
</tr>
</thead>
<tbody><tr>
<td><code>make run-broker</code></td>
<td>快 (5s)</td>
<td>开发调试</td>
<td>前台，可查看日志</td>
</tr>
<tr>
<td><code>make run-broker PLUGINS=...</code></td>
<td>快 (5s)</td>
<td>插件测试</td>
<td>前台，指定插件</td>
</tr>
<tr>
<td><code>make shell</code></td>
<td>最快 (2s)</td>
<td>模块调试</td>
<td>交互式 Erlang Shell</td>
</tr>
<tr>
<td><code>make run-background-broker</code></td>
<td>快 (5s)</td>
<td>自动化测试</td>
<td>后台运行</td>
</tr>
<tr>
<td><code>make run-node</code></td>
<td>最快 (2s)</td>
<td>Erlang 调试</td>
<td>裸节点，无 RabbitMQ</td>
</tr>
</tbody></table>
<hr>
<h2 id="最佳实践指南"><a href="#最佳实践指南" class="headerlink" title="最佳实践指南"></a>最佳实践指南</h2><h3 id="开发阶段最佳实践"><a href="#开发阶段最佳实践" class="headerlink" title="开发阶段最佳实践"></a>开发阶段最佳实践</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 初始设置</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/rabbitmq/rabbitmq-server.git</span><br><span class="line"><span class="built_in">cd</span> rabbitmq-server</span><br><span class="line">git checkout v4.0.5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 快速开发迭代</span></span><br><span class="line">make clean &amp;&amp; make</span><br><span class="line">sbin/rabbitmq-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 增量编译（推荐）</span></span><br><span class="line">make  <span class="comment"># 只编译修改的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 开发调试</span></span><br><span class="line">make shell  <span class="comment"># 进入 Erlang shell</span></span><br><span class="line">make run-broker  <span class="comment"># 运行开发版本</span></span><br></pre></td></tr></table></figure>

<h3 id="测试阶段最佳实践"><a href="#测试阶段最佳实践" class="headerlink" title="测试阶段最佳实践"></a>测试阶段最佳实践</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 功能测试</span></span><br><span class="line">make dist</span><br><span class="line"><span class="comment"># 测试插件加载和目录结构</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 插件兼容性测试</span></span><br><span class="line">make dist DIST_AS_EZS=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 验证 EZ 文件加载和热加载</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 集成测试</span></span><br><span class="line">make package-generic-unix</span><br><span class="line"><span class="comment"># 在不同环境测试安装包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 性能测试</span></span><br><span class="line">make  <span class="comment"># 使用最快的编译方式</span></span><br></pre></td></tr></table></figure>

<h3 id="生产部署最佳实践"><a href="#生产部署最佳实践" class="headerlink" title="生产部署最佳实践"></a>生产部署最佳实践</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 容器化部署（推荐）</span></span><br><span class="line">make package-generic-unix</span><br><span class="line"><span class="comment"># 使用 tar.xz 包构建 Docker 镜像</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 传统服务器部署</span></span><br><span class="line">make install PREFIX=/opt/rabbitmq</span><br><span class="line"><span class="comment"># 系统级安装</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 云原生部署</span></span><br><span class="line">make dist DIST_AS_EZS=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 使用 EZ 文件支持动态插件管理</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 高可用部署</span></span><br><span class="line">make package-generic-unix</span><br><span class="line"><span class="comment"># 标准化的部署包，便于集群管理</span></span><br></pre></td></tr></table></figure>

<h3 id="插件开发最佳实践"><a href="#插件开发最佳实践" class="headerlink" title="插件开发最佳实践"></a>插件开发最佳实践</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 插件开发</span></span><br><span class="line">make dist</span><br><span class="line"><span class="comment"># 开发阶段使用目录格式便于调试</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 插件测试</span></span><br><span class="line">make run-broker PLUGINS=<span class="string">&quot;plugin_name&quot;</span></span><br><span class="line"><span class="comment"># 测试插件功能</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 插件分发</span></span><br><span class="line">make dist DIST_AS_EZS=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 生成 .ez 文件用于分发</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 插件发布</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> plugin_name</span><br><span class="line"><span class="comment"># 从 .ez 文件安装插件</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="高级配置与优化"><a href="#高级配置与优化" class="headerlink" title="高级配置与优化"></a>高级配置与优化</h2><h3 id="环境变量控制"><a href="#环境变量控制" class="headerlink" title="环境变量控制"></a>环境变量控制</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自定义插件目录</span></span><br><span class="line"><span class="built_in">export</span> DIST_DIR=/custom/plugins/path</span><br><span class="line">make dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义包输出目录</span></span><br><span class="line"><span class="built_in">export</span> PACKAGES_DIR=/custom/packages/path  </span><br><span class="line">make package-generic-unix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用社区插件</span></span><br><span class="line"><span class="built_in">export</span> COMMUNITY_PLUGINS=1</span><br><span class="line">make dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义版本号</span></span><br><span class="line"><span class="built_in">export</span> PROJECT_VERSION=4.0.5-custom</span><br><span class="line">make dist</span><br></pre></td></tr></table></figure>

<h3 id="编译优化技巧"><a href="#编译优化技巧" class="headerlink" title="编译优化技巧"></a>编译优化技巧</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 并行编译（推荐）</span></span><br><span class="line">make -j$(<span class="built_in">nproc</span>) dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 详细输出（调试用）</span></span><br><span class="line">make V=1 dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 跳过测试（加速编译）</span></span><br><span class="line">make SKIP_TESTS=1 dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 增量编译（开发用）</span></span><br><span class="line">make  <span class="comment"># 不使用 clean</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 内存优化</span></span><br><span class="line"><span class="built_in">export</span> ERL_MAX_PORTS=32768</span><br><span class="line">make dist</span><br></pre></td></tr></table></figure>

<h3 id="自定义构建配置"><a href="#自定义构建配置" class="headerlink" title="自定义构建配置"></a>自定义构建配置</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 local.mk 文件进行自定义</span></span><br><span class="line"><span class="comment"># local.mk</span></span><br><span class="line">ADDITIONAL_PLUGINS = my_custom_plugin</span><br><span class="line">DIST_AS_EZS = 1</span><br><span class="line">PACKAGES_DIR = /opt/packages</span><br><span class="line"></span><br><span class="line"><span class="comment"># 包含到主 Makefile</span></span><br><span class="line"><span class="keyword">include</span> local.mk</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="故障排除指南"><a href="#故障排除指南" class="headerlink" title="故障排除指南"></a>故障排除指南</h2><h3 id="常见编译问题"><a href="#常见编译问题" class="headerlink" title="常见编译问题"></a>常见编译问题</h3><h4 id="1-依赖问题"><a href="#1-依赖问题" class="headerlink" title="1. 依赖问题"></a>1. 依赖问题</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 问题：deps 编译失败</span></span><br><span class="line"><span class="comment"># 解决：清理并重新获取依赖</span></span><br><span class="line">make clean-deps</span><br><span class="line">make deps</span><br></pre></td></tr></table></figure>

<h4 id="2-版本冲突"><a href="#2-版本冲突" class="headerlink" title="2. 版本冲突"></a>2. 版本冲突</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 问题：Erlang 版本不兼容</span></span><br><span class="line"><span class="comment"># 解决：检查并切换 Erlang 版本</span></span><br><span class="line">erl -version</span><br><span class="line"><span class="comment"># 确保使用 Erlang 25.x 或 26.x</span></span><br></pre></td></tr></table></figure>

<h4 id="3-磁盘空间不足"><a href="#3-磁盘空间不足" class="headerlink" title="3. 磁盘空间不足"></a>3. 磁盘空间不足</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 问题：编译过程中磁盘空间不足</span></span><br><span class="line"><span class="comment"># 解决：清理临时文件</span></span><br><span class="line">make clean</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure>

<h4 id="4-权限问题"><a href="#4-权限问题" class="headerlink" title="4. 权限问题"></a>4. 权限问题</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 问题：install 时权限不足</span></span><br><span class="line"><span class="comment"># 解决：使用正确的权限</span></span><br><span class="line"><span class="built_in">sudo</span> make install PREFIX=/opt/rabbitmq</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chown</span> -R rabbitmq:rabbitmq /opt/rabbitmq</span><br></pre></td></tr></table></figure>

<h3 id="性能优化建议"><a href="#性能优化建议" class="headerlink" title="性能优化建议"></a>性能优化建议</h3><ol>
<li><strong>使用 SSD</strong> - 显著提升编译速度</li>
<li><strong>增加内存</strong> - 减少交换文件使用</li>
<li><strong>并行编译</strong> - 利用多核 CPU</li>
<li><strong>增量编译</strong> - 开发阶段避免 clean</li>
<li><strong>本地缓存</strong> - 使用本地 Maven&#x2F;Hex 缓存</li>
</ol>
<hr>
<h2 id="总结与建议"><a href="#总结与建议" class="headerlink" title="总结与建议"></a>总结与建议</h2><h3 id="命令选择矩阵"><a href="#命令选择矩阵" class="headerlink" title="命令选择矩阵"></a>命令选择矩阵</h3><h4 id="构建场景"><a href="#构建场景" class="headerlink" title="构建场景"></a>构建场景</h4><table>
<thead>
<tr>
<th>场景</th>
<th>推荐方式</th>
<th>理由</th>
</tr>
</thead>
<tbody><tr>
<td><strong>本地开发</strong></td>
<td><code>make</code></td>
<td>最快，支持增量编译</td>
</tr>
<tr>
<td><strong>功能测试</strong></td>
<td><code>make dist</code></td>
<td>完整插件结构，便于调试</td>
</tr>
<tr>
<td><strong>插件开发</strong></td>
<td><code>make dist</code> → <code>make dist DIST_AS_EZS=true</code></td>
<td>开发用目录，分发用 EZ</td>
</tr>
<tr>
<td><strong>离线构建</strong></td>
<td><code>make source-dist</code></td>
<td>包含所有依赖，可复现</td>
</tr>
<tr>
<td><strong>版本发布</strong></td>
<td><code>make source-dist</code></td>
<td>官方发布流程，可复现归档</td>
</tr>
<tr>
<td><strong>容器部署</strong></td>
<td><code>make package-generic-unix</code></td>
<td>自包含，标准化</td>
</tr>
<tr>
<td><strong>生产部署</strong></td>
<td><code>make package-generic-unix</code> 或 <code>make install</code></td>
<td>稳定，便于管理</td>
</tr>
<tr>
<td><strong>自定义安装</strong></td>
<td><code>make install PREFIX=/opt/rabbitmq</code></td>
<td>指定安装路径</td>
</tr>
<tr>
<td><strong>插件分发</strong></td>
<td><code>make dist DIST_AS_EZS=true</code></td>
<td>压缩，便于传输</td>
</tr>
<tr>
<td><strong>CI&#x2F;CD</strong></td>
<td><code>make package-generic-unix</code></td>
<td>可重现，标准化</td>
</tr>
</tbody></table>
<h4 id="开发调试场景"><a href="#开发调试场景" class="headerlink" title="开发调试场景"></a>开发调试场景</h4><table>
<thead>
<tr>
<th>场景</th>
<th>推荐方式</th>
<th>理由</th>
</tr>
</thead>
<tbody><tr>
<td><strong>日常开发调试</strong></td>
<td><code>make run-broker</code></td>
<td>前台运行，实时查看日志</td>
</tr>
<tr>
<td><strong>插件功能验证</strong></td>
<td><code>make run-broker PLUGINS=&quot;plugin_name&quot;</code></td>
<td>按需加载插件</td>
</tr>
<tr>
<td><strong>模块级调试</strong></td>
<td><code>make shell</code></td>
<td>交互式测试函数</td>
</tr>
<tr>
<td><strong>自动化测试</strong></td>
<td><code>make run-background-broker</code></td>
<td>后台运行，脚本控制</td>
</tr>
<tr>
<td><strong>Erlang 底层调试</strong></td>
<td><code>make run-node</code></td>
<td>不启动 RabbitMQ 应用</td>
</tr>
</tbody></table>
<h3 id="关键技术洞察"><a href="#关键技术洞察" class="headerlink" title="关键技术洞察"></a>关键技术洞察</h3><ol>
<li><strong>EZ 格式是王道</strong> - 对于插件分发和热加载</li>
<li><strong>通用包最实用</strong> - 对于生产部署和容器化</li>
<li><strong>源码包是基础</strong> - <code>source-dist</code> 是 <code>package-generic-unix</code> 的前置依赖</li>
<li><strong>开发调试用 run-broker</strong> - 比 <code>sbin/rabbitmq-server</code> 更方便</li>
<li><strong>增量编译是关键</strong> - 对于开发效率</li>
<li><strong>构建系统很灵活</strong> - 支持高度定制</li>
<li><strong>标准化很重要</strong> - 遵循 Unix 和 Erlang 标准</li>
</ol>
<p>RabbitMQ 的构建系统设计精良，通过不同的编译命令满足了从开发到生产的各种需求。理解这些编译方式的原理和最佳实践，将显著提升 RabbitMQ 的开发、部署和运维效率。</p>
<hr>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.rabbitmq.com/docs">RabbitMQ 官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://erlang.mk/">Erlang.mk 用户指南</a></li>
<li><a target="_blank" rel="noopener" href="https://www.erlang.org/doc/design_principles/users_guide.html">Erlang&#x2F;OTP 设计原则</a></li>
<li><a target="_blank" rel="noopener" href="https://refspecs.linuxfoundation.org/FHS_3.0/fhs/index.html">Unix 文件系统层次标准</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/RabbitMQ/" rel="tag"># RabbitMQ</a>
              <a href="/tags/Erlang/" rel="tag"># Erlang</a>
              <a href="/tags/%E7%BC%96%E8%AF%91/" rel="tag"># 编译</a>
              <a href="/tags/%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F/" rel="tag"># 构建系统</a>
              <a href="/tags/%E9%83%A8%E7%BD%B2/" rel="tag"># 部署</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2026/01/16/rabbitmq-rabbitmq-build-deep-analysis/" rel="prev" title="RabbitMQ 编译方式深度解析与源码分析">
                  <i class="fa fa-angle-left"></i> RabbitMQ 编译方式深度解析与源码分析
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2026/01/16/erlang-erlang-trace-debugging-guide/" rel="next" title="Erlang Trace 调试技术详解">
                  Erlang Trace 调试技术详解 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Zixiang Sun</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"hzsunzixiang/hzsunzixiang.github.io","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js" defer></script>

</body>
</html>
