{"meta":{"title":"Zixiang Sun's Blog","subtitle":"Sharing thoughts on technology, programming, and life","description":"Welcome to my personal blog where I share thoughts on technology, programming, and life experiences.","author":"Zixiang Sun","url":"https://hzsunzixiang.github.io","root":"/"},"pages":[{"title":"CRAQ æŠ€æœ¯æ–‡æ¡£","date":"2024-01-14T16:00:00.000Z","updated":"2026-01-16T04:38:09.175Z","comments":true,"path":"craq/index.html","permalink":"https://hzsunzixiang.github.io/craq/","excerpt":"","text":"CRAQ æŠ€æœ¯æ–‡æ¡£Chain Replication with Apportioned Queries (CRAQ) åè®®çš„å®Œæ•´æŠ€æœ¯æ–‡æ¡£å’Œå®ç°åˆ†æã€‚ â† è¿”å›é¦–é¡µ ğŸ“š æ ¸å¿ƒæ¦‚å¿µ åŒ…å«æ€»ä½“æ¶æ„ä»‹ç» æ–‡æ¡£ æè¿° CRAQ æºä»£ç æ–‡ä»¶å®Œæ•´è§£è¯» æ·±å…¥åˆ†æ CRAQ åè®®çš„ Erlang å®ç°æºç ç»“æ„å’Œæ ¸å¿ƒæ¨¡å— Chain Replication æ¶æ„åˆ†æ é“¾å¼å¤åˆ¶åè®®çš„åŸºç¡€æ¦‚å¿µå’Œæ¶æ„è®¾è®¡åŸç† Chain Replication å…¥é—¨ä»‹ç» é“¾å¼å¤åˆ¶åè®®çš„å…¥é—¨çº§ä»‹ç»å’ŒåŸºæœ¬æ¦‚å¿µ å…±è¯†åè®®å¯¹æ¯”åˆ†æ CRAQ ä¸å…¶ä»–åˆ†å¸ƒå¼å…±è¯†åè®®çš„è¯¦ç»†å¯¹æ¯”åˆ†æ CRAQ Erlang å®ç°æ–‡æ¡£ CRAQ åè®® Erlang å®ç°çš„æŠ€æœ¯æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å— â†‘ è¿”å›é¡¶éƒ¨ ğŸ“¦ åè®®æ ¼å¼ äºŒè¿›åˆ¶åè®® æ–‡æ¡£ æè¿° CRAQ äºŒè¿›åˆ¶æ ¼å¼åˆ†æ CRAQ åè®®çš„äºŒè¿›åˆ¶æ•°æ®æ ¼å¼å’Œç¼–ç è§„èŒƒè¯¦è§£ Erlang äºŒè¿›åˆ¶åºåˆ—åŒ–æ˜ å°„ Erlang ç¯å¢ƒä¸‹çš„äºŒè¿›åˆ¶æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœºåˆ¶ è¿½è¸ªæ—¥å¿—äºŒè¿›åˆ¶æ ¼å¼åˆ†æ ç³»ç»Ÿè¿½è¸ªæ—¥å¿—çš„äºŒè¿›åˆ¶æ ¼å¼å’Œè§£ææ–¹æ³• æ–‡ä»¶æè¿°ç¬¦ç»“æ„åˆ†æ CRAQ ç³»ç»Ÿä¸­æ–‡ä»¶æè¿°ç¬¦çš„å†…éƒ¨ç»“æ„å’Œç®¡ç†æœºåˆ¶ Erlang æ–‡ä»¶æè¿°ç¬¦åˆ†æ Erlang æ–‡ä»¶æè¿°ç¬¦çš„å®ç°ç»†èŠ‚ æ–‡ä»¶æ‰“å¼€æµç¨‹åˆ†æ æ–‡ä»¶æ‰“å¼€æ“ä½œçš„å®Œæ•´æµç¨‹åˆ†æ æ–‡ä»¶æ‰“å¼€æ¼”ç¤ºåˆ†æ æ–‡ä»¶æ‰“å¼€æ“ä½œçš„æ¼”ç¤ºå’Œç¤ºä¾‹ â†‘ è¿”å›é¡¶éƒ¨ ğŸ”§ é›†ç¾¤ç®¡ç† é›†ç¾¤çš„å»ºç«‹ç­‰ æ–‡æ¡£ æè¿° CRAQ é›†ç¾¤æ„å»ºè¯¦ç»†åˆ†æ åŸºäºæ—¥å¿—è¿½è¸ªçš„ CRAQ é›†ç¾¤æ„å»ºè¿‡ç¨‹å®Œæ•´åˆ†æ Erlang CRAQ é›†ç¾¤æ„å»ºåˆ†æ Erlang ç¯å¢ƒä¸‹ CRAQ é›†ç¾¤çš„æ„å»ºå’Œé…ç½® æ·»åŠ èŠ‚ç‚¹è°ƒç”¨é“¾åˆ†æ å‘ CRAQ é›†ç¾¤æ·»åŠ æ–°èŠ‚ç‚¹çš„å®Œæ•´è°ƒç”¨é“¾å’Œå¤„ç†æµç¨‹ CRAQ æ•…éšœæ£€æµ‹å™¨åˆ†æ CRAQ é›†ç¾¤ä¸­æ•…éšœæ£€æµ‹æœºåˆ¶çš„å®ç°å’Œä¼˜åŒ–ç­–ç•¥ EH åº”ç”¨é…ç½®æºç åˆ†æ CRAQ é›†ç¾¤é…ç½®ç®¡ç†å’Œåº”ç”¨ç¨‹åºé…ç½®åˆ†æ CRAQ å¯åŠ¨è¿½è¸ªåˆ†æ CRAQ ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹çš„è¿½è¸ªå’Œåˆ†æ â†‘ è¿”å›é¡¶éƒ¨ ğŸ“¸ å¿«ç…§åŠæ•°æ®åŒæ­¥ å¿«ç…§æœºåˆ¶å’Œæ•°æ®åŒæ­¥æµç¨‹ æ–‡æ¡£ æè¿° å¿«ç…§æ¦‚å¿µç»¼åˆæŒ‡å— CRAQ å¿«ç…§æœºåˆ¶çš„å®Œæ•´æ¦‚å¿µä»‹ç»å’Œå®ç°æŒ‡å— å¿«ç…§æ•°æ®åŒæ­¥æµç¨‹åˆ†æ å¿«ç…§æ•°æ®åœ¨é›†ç¾¤èŠ‚ç‚¹é—´çš„åŒæ­¥æµç¨‹å’Œä¼˜åŒ–æ–¹æ³• å¿«ç…§æœºåˆ¶è¯¦ç»†åˆ†æ å¿«ç…§æœºåˆ¶çš„è¯¦ç»†å®ç°å’Œä¼˜åŒ–ç­–ç•¥ CRAQ å¿«ç…§æœºåˆ¶åˆ†æ CRAQ åè®®ä¸­å¿«ç…§æœºåˆ¶çš„æ ¸å¿ƒå®ç° CRAQ å¿«ç…§æ•°æ®åŒæ­¥è¯¦ç»†åˆ†æ CRAQ å¿«ç…§æ•°æ®åŒæ­¥çš„è¯¦ç»†æµç¨‹ åˆå§‹é›†ç¾¤æ•°æ®åŒæ­¥åˆ†æ æ–°å»ºé›†ç¾¤æ—¶çš„åˆå§‹æ•°æ®åŒæ­¥è¿‡ç¨‹å’Œå®ç°ç»†èŠ‚ æ·»åŠ èŠ‚ç‚¹å¿«ç…§åŒæ­¥æµç¨‹ æ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤æ—¶çš„å¿«ç…§åŒæ­¥æµç¨‹ â†‘ è¿”å›é¡¶éƒ¨ âœï¸ æ•°æ®æ›´æ–° æ•°æ®å†™å…¥ã€æ›´æ–°å’Œå†²çªè§£å†³ æ–‡æ¡£ æè¿° CRAQ å®Œæ•´æ›´æ–°æµç¨‹åˆ†æ CRAQ åè®®ä¸­æ•°æ®æ›´æ–°çš„å®Œæ•´æµç¨‹å’Œå®ç°ç»†èŠ‚ CRAQ æ›´æ–°æµç¨‹åˆ†æ æ•°æ®æ›´æ–°æµç¨‹çš„åˆ†æ CRAQ æ›´æ–°è°ƒç”¨é“¾ æ•°æ®æ›´æ–°æ“ä½œçš„è°ƒç”¨é“¾åˆ†æ CRAQ æ›´æ–°è¿½è¸ªåˆ†æ æ•°æ®æ›´æ–°æ“ä½œçš„è¿½è¸ªæ—¥å¿—åˆ†æ å†™å†²çªè§£å†³å™¨åˆ†æ CRAQ ç³»ç»Ÿä¸­å†™å†²çªçš„æ£€æµ‹å’Œè§£å†³æœºåˆ¶ å¢é‡æ›´æ–°ä»£ç åˆ†æ å¢é‡æ•°æ®æ›´æ–°çš„å®ç°æ–¹æ³•å’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥ CRAQ åˆ é™¤å†™å…¥åˆ†æ åˆ é™¤æ“ä½œçš„å†™å…¥æµç¨‹åˆ†æ CRAQ åˆ é™¤è¿½è¸ªåˆ†æ åˆ é™¤æ“ä½œçš„è¿½è¸ªæ—¥å¿—åˆ†æ CRAQ æŸ¥è¯¢è¿½è¸ªåˆ†æ æŸ¥è¯¢æ“ä½œçš„è¿½è¸ªæ—¥å¿—åˆ†æ CRAQ è¯¦ç»†è¿½è¸ªåˆ†æ CRAQ æ“ä½œçš„è¯¦ç»†è¿½è¸ªåˆ†æ â†‘ è¿”å›é¡¶éƒ¨ ğŸ“– æ–‡æ¡£ç¿»è¯‘ æŠ€æœ¯æ–‡æ¡£ç¿»è¯‘ æ–‡æ¡£ æè¿° Erlang CRAQ PDF æ–‡æ¡£ç¿»è¯‘ CRAQ åŸå§‹æŠ€æœ¯è®ºæ–‡çš„å®Œæ•´ä¸­æ–‡ç¿»è¯‘å’Œè§£é‡Š â†‘ è¿”å›é¡¶éƒ¨ ğŸ’» ä»£ç å¤ç° ä½¿ç”¨æŒ‡å—å’Œä»£ç å®è·µ æ–‡æ¡£ æè¿° CRAQ ä½¿ç”¨æŒ‡å— CRAQ ç³»ç»Ÿçš„å®‰è£…ã€é…ç½®å’Œä½¿ç”¨çš„å®Œæ•´æŒ‡å— â†‘ è¿”å›é¡¶éƒ¨ ğŸ”— ç›¸å…³èµ„æº CRAQ è®ºæ–‡åŸæ–‡ Chain Replication è®ºæ–‡ Erlang&#x2F;OTP å®˜æ–¹æ–‡æ¡£ â† è¿”å›é¦–é¡µ | â†‘ è¿”å›é¡¶éƒ¨ æœ¬æ–‡æ¡£é›†åˆæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿æå‡ºå»ºè®®å’Œåé¦ˆã€‚"},{"title":"About Me","date":"2024-01-14T16:00:00.000Z","updated":"2026-01-16T04:38:09.166Z","comments":true,"path":"about/index.html","permalink":"https://hzsunzixiang.github.io/about/","excerpt":"","text":"Hello, Iâ€™m Zixiang Sun! ğŸ‘‹Welcome to my digital space! Iâ€™m a passionate developer who loves exploring new technologies, solving complex problems, and sharing knowledge with the community. ğŸš€ What I DoIâ€™m currently focused on: Full-Stack Development: Building scalable web applications using modern frameworks and technologies Open Source: Contributing to projects that make a difference in the developer community Learning: Continuously expanding my knowledge in emerging technologies and best practices Teaching: Sharing insights through blog posts, tutorials, and mentoring ğŸ’» Technical SkillsLanguages JavaScript&#x2F;TypeScript: Advanced proficiency in modern ES6+ features Python: Data analysis, automation, and backend development Java: Enterprise applications and system design Erlang: Distributed systems and concurrent programming Frameworks &amp; Libraries Frontend: React, Vue.js, Angular, Next.js Backend: Node.js, Express, Django, Spring Boot Mobile: React Native, Flutter Styling: Tailwind CSS, Sass, Material-UI Tools &amp; Technologies Databases: PostgreSQL, MongoDB, Redis Cloud: AWS, Google Cloud, Azure DevOps: Docker, Kubernetes, CI&#x2F;CD pipelines Version Control: Git, GitHub, GitLab ğŸ¯ Current FocusIâ€™m currently diving deep into: Distributed Systems: CRAQ, Chain Replication, and consensus protocols Cloud-Native Development: Leveraging cloud platforms for optimal performance AI&#x2F;ML Integration: Incorporating machine learning into web applications Performance Optimization: Creating lightning-fast user experiences ğŸŒŸ PhilosophyI believe in: Clean Code: Writing code thatâ€™s readable, maintainable, and well-documented User-Centric Design: Building applications that solve real problems Continuous Learning: Staying updated with the latest technologies and best practices Knowledge Sharing: Contributing to the community through open source and content creation Collaboration: Working effectively in teams and mentoring others ğŸ¤ Letâ€™s Connect!Iâ€™m always excited to connect with fellow developers, designers, and technology enthusiasts. Whether you want to: Collaborate on a project Discuss technology trends Share learning resources Ask questions or seek advice Just say hello! Feel free to reach out: Email: 17842379@qq.com GitHub: @hzsunzixiang ğŸ’¡ Fun Facts I wrote my first â€œHello Worldâ€ program in Python Iâ€™m a big fan of clean, minimalist design My favorite programming quote: â€œCode is like humor. When you have to explain it, itâ€™s bad.â€ - Cory House I believe the best code is code that doesnâ€™t need to be written Thank you for taking the time to learn about me! Iâ€™m looking forward to connecting with you and sharing this journey of continuous learning and growth in the amazing world of technology. â€œThe only way to do great work is to love what you do.â€ - Steve Jobs"},{"title":"Erlang æŠ€æœ¯æ–‡æ¡£","date":"2024-01-15T16:00:00.000Z","updated":"2026-01-17T11:00:23.565Z","comments":true,"path":"erlang/index.html","permalink":"https://hzsunzixiang.github.io/erlang/","excerpt":"","text":"Erlang æŠ€æœ¯æ–‡æ¡£Erlang ç¼–ç¨‹è¯­è¨€ç›¸å…³çš„æŠ€æœ¯æ–‡æ¡£å’ŒçŸ¥è¯†æ€»ç»“ã€‚ â† è¿”å›é¦–é¡µ ğŸ“š æ–‡æ¡£åˆ—è¡¨ æ–‡æ¡£ æè¿° Erlang çŸ¥è¯†ç‚¹æ±‡æ€» Erlang å¼€å‘å¸¸ç”¨çŸ¥è¯†ç‚¹ï¼ŒåŒ…æ‹¬åŸºç¡€è¯­æ³•ã€åˆ†å¸ƒå¼èŠ‚ç‚¹é€šä¿¡ã€è°ƒè¯•æŠ€å·§ç­‰ ç¬¬å››ç« ï¼šé€šç”¨å‹æœåŠ¡å™¨ gen_server OTP ä¸­æœ€å¸¸ç”¨çš„ behaviorï¼ŒåŒ…æ‹¬åŒæ­¥&#x2F;å¼‚æ­¥æ¶ˆæ¯ã€è¶…æ—¶å¤„ç†ç­‰ Erlang è¿›ç¨‹é“¾æ¥ä¸ç›‘è§†å™¨ ç”¨äºç›‘ç£çš„ Links å’Œ Monitors æœºåˆ¶ï¼ˆè‹±æ–‡åŸç‰ˆï¼‰ Erlang è¿›ç¨‹é“¾æ¥ä¸ç›‘è§†å™¨ï¼ˆä¸­æ–‡ç‰ˆï¼‰ ç”¨äºç›‘ç£çš„ Links å’Œ Monitors æœºåˆ¶ï¼ˆå®Œæ•´ä¸­æ–‡ç¿»è¯‘ï¼‰ Erlang Trace è°ƒè¯•æŠ€æœ¯è¯¦è§£ trace&#x2F;dbg&#x2F;recon_trace è°ƒè¯•å·¥å…·ä½¿ç”¨æŒ‡å— â†‘ è¿”å›é¡¶éƒ¨ ğŸ”— ç›¸å…³èµ„æº Erlang å®˜æ–¹æ–‡æ¡£ Learn You Some Erlang Erlang&#x2F;OTP GitHub â† è¿”å›é¦–é¡µ | â†‘ è¿”å›é¡¶éƒ¨ æœ¬æ–‡æ¡£é›†åˆæŒç»­æ›´æ–°ä¸­ã€‚"},{"title":"RabbitMQ æŠ€æœ¯æ–‡æ¡£","date":"2024-01-14T16:00:00.000Z","updated":"2026-01-17T11:32:42.121Z","comments":true,"path":"rabbitmq/index.html","permalink":"https://hzsunzixiang.github.io/rabbitmq/","excerpt":"","text":"â† è¿”å›é¦–é¡µ RabbitMQ æŠ€æœ¯æ–‡æ¡£ ğŸ“š æ–‡æ¡£åˆ—è¡¨ æ–‡æ¡£ æè¿° RabbitMQ æœåŠ¡å™¨ç¼–è¯‘æŒ‡å— macOS ç¯å¢ƒä¸‹ç¼–è¯‘ RabbitMQ æœåŠ¡å™¨çš„å®Œæ•´æŒ‡å—ï¼ŒåŒ…æ‹¬é—®é¢˜æ’æŸ¥ RabbitMQ æ„å»ºé—®é¢˜åˆ†æä¸ç¤¾åŒºè¡¥ä¸ææ¡ˆ Generic Unix åŒ…æ„å»ºé”™è¯¯åˆ†æåŠä¿®å¤æ–¹æ¡ˆ RabbitMQ é—®é¢˜æœ€ç»ˆè§£å†³æ–¹æ¡ˆæ€»ç»“ EPMD é”™è¯¯çš„æ ¹å› åˆ†æï¼šhosts æ–‡ä»¶é…ç½®é—®é¢˜ RabbitMQ æ’ä»¶å¯ç”¨é—®é¢˜æ’æŸ¥æŒ‡å— æºç ç¼–è¯‘ç¯å¢ƒä¸‹æ’ä»¶å¯ç”¨æŠ¥é”™çš„è§£å†³æ–¹æ¡ˆ RabbitMQ ç¼–è¯‘æ–¹å¼æ·±åº¦è§£æä¸æºç åˆ†æ äº”ç§ç¼–è¯‘æ–¹å¼çš„åŸç†ã€å®ç°æœºåˆ¶å’Œé€‚ç”¨åœºæ™¯ RabbitMQ ç¼–è¯‘æ„å»ºå®Œå…¨æŒ‡å— å®Œæ•´çš„ç¼–è¯‘æ„å»ºæŒ‡å—ï¼ŒåŒ…å«æœ€ä½³å®è·µå’Œæ•…éšœæ’é™¤ RabbitMQ ä¾èµ–æ¨¡å—å…¨é¢åˆ†æ 86 ä¸ªä¾èµ–æ¨¡å—çš„åŠŸèƒ½ã€æ¶æ„å’Œäº¤äº’æ–¹å¼è¯¦è§£ RabbitMQ é˜Ÿåˆ—å£°æ˜æµç¨‹æ·±åº¦åˆ†æ é˜Ÿåˆ—å£°æ˜çš„å®Œæ•´æ‰§è¡Œæµç¨‹å’Œæºç åˆ†æ ğŸ”— ç›¸å…³èµ„æº RabbitMQ å®˜æ–¹æ–‡æ¡£ RabbitMQ GitHub ä»“åº“ Erlang&#x2F;OTP æ–‡æ¡£ â† è¿”å›é¦–é¡µ | â†‘ è¿”å›é¡¶éƒ¨ æœ¬æ–‡æ¡£é›†åˆæŒç»­æ›´æ–°ä¸­ã€‚"},{"title":"åˆ†ç±»","date":"2026-01-16T04:38:09.167Z","updated":"2026-01-16T04:38:09.167Z","comments":false,"path":"categories/index.html","permalink":"https://hzsunzixiang.github.io/categories/","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2026-01-16T04:38:09.289Z","updated":"2026-01-16T04:38:09.289Z","comments":false,"path":"tags/index.html","permalink":"https://hzsunzixiang.github.io/tags/","excerpt":"","text":""}],"posts":[{"title":"RabbitMQ ä¾èµ–æ¨¡å—å…¨é¢åˆ†æ","slug":"rabbitmq-rabbitmq-dependencies-analysis","date":"2026-01-16T16:00:00.000Z","updated":"2026-01-17T11:10:00.932Z","comments":true,"path":"2026/01/17/rabbitmq-rabbitmq-dependencies-analysis/","permalink":"https://hzsunzixiang.github.io/2026/01/17/rabbitmq-rabbitmq-dependencies-analysis/","excerpt":"","text":"RabbitMQ ä¾èµ–æ¨¡å—å…¨é¢åˆ†ææ¦‚è¿°æœ¬æ–‡æ¡£å¯¹ RabbitMQ 4.0.5 ç‰ˆæœ¬ deps/ ç›®å½•ä¸‹çš„ 86 ä¸ªä¾èµ–æ¨¡å—è¿›è¡Œå…¨é¢åˆ†æï¼Œæ¶µç›–æ¯ä¸ªæ¨¡å—çš„åŠŸèƒ½ã€ä¸ RabbitMQ æ ¸å¿ƒçš„äº¤äº’æ–¹å¼ä»¥åŠåœ¨æ•´ä½“æ¶æ„ä¸­çš„ä½œç”¨ã€‚ æ¶æ„å±‚æ¬¡æ¦‚è§ˆ12345678910111213141516171819202122232425262728293031323334â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ åº”ç”¨å±‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ å‘½ä»¤è¡Œå·¥å…· â”‚ â”‚ Webç®¡ç†ç•Œé¢ â”‚ â”‚ HTTP APIâ”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ åè®®å±‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚AMQP 0-9-1â”‚ â”‚ MQTT â”‚ â”‚ STOMP â”‚ â”‚ Stream Protocolâ”‚ â”‚â”‚ â”‚ /1.0 â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ æ ¸å¿ƒå±‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ rabbit-æ ¸å¿ƒæœåŠ¡å™¨â”‚ â”‚rabbit_common â”‚ â”‚amqp_client â”‚ â”‚â”‚ â”‚ â”‚ â”‚ å…±äº«åº“ â”‚ â”‚ å®¢æˆ·ç«¯ â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ å­˜å‚¨å±‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ ra-Raftä¸€è‡´æ€§ â”‚ â”‚osiris-æ—¥å¿—å­˜å‚¨ â”‚ â”‚khepri-æ ‘å½¢ â”‚ â”‚â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ æ•°æ®åº“ â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ç½‘ç»œå±‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚cowboy-HTTPæœåŠ¡å™¨â”‚ â”‚ ranch-è¿æ¥æ±  â”‚ â”‚gun-HTTPå®¢æˆ·ç«¯â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ åŸºç¡€è®¾æ–½å±‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ è®¤è¯æˆæƒ â”‚ â”‚ ç›‘æ§æŒ‡æ ‡ â”‚ â”‚ é›†ç¾¤å‘ç° â”‚ â”‚ å·¥å…·åº“ â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æ ¸å¿ƒæ¶æ„æ¨¡å—1. rabbit - RabbitMQ æ ¸å¿ƒæœåŠ¡å™¨ æ¨¡å—è·¯å¾„: deps/rabbit/ ä¸»è¦åŠŸèƒ½: AMQP 0-9-1, AMQP 1.0, MQTT, STOMP åè®®æ”¯æŒ é˜Ÿåˆ—ç®¡ç†ã€äº¤æ¢å™¨è·¯ç”±ã€æƒé™æ§åˆ¶ é›†ç¾¤ç®¡ç†ã€æŒä¹…åŒ–å­˜å‚¨ã€ç³»ç»Ÿç›‘æ§ æ ¸å¿ƒæ–‡ä»¶:123456src/rabbit.erl % ä¸»åº”ç”¨æ¨¡å—src/rabbit_amqqueue.erl % é˜Ÿåˆ—ç®¡ç† (82KB)src/rabbit_exchange.erl % äº¤æ¢å™¨ç®¡ç†src/rabbit_channel.erl % é€šé“ç®¡ç† (119KB)src/rabbit_reader.erl % åè®®è¯»å–å™¨src/rabbit_networking.erl % ç½‘ç»œç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: ä½œä¸ºæ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒï¼Œåè°ƒæ‰€æœ‰å…¶ä»–æ¨¡å— ä¾èµ–å…³ç³»: ä¾èµ– rabbit_commonã€raã€osirisã€khepri ç­‰æ ¸å¿ƒåº“ 2. rabbit_common - å…±äº«é€šç”¨åº“ æ¨¡å—è·¯å¾„: deps/rabbit_common/ ä¸»è¦åŠŸèƒ½: AMQP åè®®è§£æå’Œç”Ÿæˆ é€šç”¨æ•°æ®ç»“æ„å’Œå·¥å…·å‡½æ•° è®¤è¯å’ŒæˆæƒåŸºç¡€è®¾æ–½ æ ¸å¿ƒæ–‡ä»¶:123src/rabbit_framing.erl % AMQP å¸§å¤„ç†src/rabbit_binary_parser.erl % äºŒè¿›åˆ¶åè®®è§£æsrc/rabbit_misc.erl % é€šç”¨å·¥å…·å‡½æ•° ä¸æ ¸å¿ƒäº¤äº’: è¢« rabbit å’Œ amqp_client å…±åŒä½¿ç”¨ ä¾èµ–å…³ç³»: åŸºç¡€åº“ï¼Œè¢«å¤šä¸ªæ¨¡å—ä¾èµ– 3. amqp_client - AMQP å®¢æˆ·ç«¯åº“ æ¨¡å—è·¯å¾„: deps/amqp_client/ ä¸»è¦åŠŸèƒ½: æä¾›è¿æ¥å’Œé€šé“ç®¡ç† æ”¯æŒç›´è¿å’Œç½‘ç»œè¿æ¥ RPC å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å®ç° æ ¸å¿ƒæ–‡ä»¶:123src/amqp_connection.erl % è¿æ¥ç®¡ç†src/amqp_channel.erl % é€šé“ç®¡ç†src/amqp_direct_connection.erl % ç›´è¿å®ç° ä¸æ ¸å¿ƒäº¤äº’: ç”¨äºå†…éƒ¨ç»„ä»¶é—´é€šä¿¡å’Œå¤–éƒ¨å®¢æˆ·ç«¯è¿æ¥ ä¾èµ–å…³ç³»: ä¾èµ– rabbit_common åˆ†å¸ƒå¼å­˜å‚¨å’Œä¸€è‡´æ€§æ¨¡å—4. ra - Raft ä¸€è‡´æ€§ç®—æ³•å®ç° æ¨¡å—è·¯å¾„: deps/ra/ ä¸»è¦åŠŸèƒ½: é¢†å¯¼è€…é€‰ä¸¾ã€æ—¥å¿—å¤åˆ¶ é›†ç¾¤æˆå‘˜å˜æ›´ã€æ—¥å¿—å‹ç¼© å¿«ç…§å®‰è£…å’Œæ¢å¤ æ ¸å¿ƒæ–‡ä»¶:1234src/ra.erl % ä¸» API æ¨¡å—src/ra_server.erl % Raft æœåŠ¡å™¨ (3,348 è¡Œ)src/ra_machine.erl % çŠ¶æ€æœºè¡Œä¸ºå®šä¹‰src/ra_log.erl % æ—¥å¿—ç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: ä¸ºä»²è£é˜Ÿåˆ—å’Œæµæä¾›ä¸€è‡´æ€§ä¿è¯ ä¾èµ–å…³ç³»: ä¾èµ– atenã€gen_batch_serverã€seshat æ€§èƒ½ç‰¹ç‚¹: é«˜ååé‡ã€ä½å»¶è¿Ÿçš„ä¸€è‡´æ€§ä¿è¯ 5. osiris - æ—¥å¿—æµå­˜å‚¨åŸºç¡€ æ¨¡å—è·¯å¾„: deps/osiris/ ä¸»è¦åŠŸèƒ½: é«˜æ€§èƒ½æ—¥å¿—å­˜å‚¨ æ”¯æŒæµå¼æ•°æ®å¤„ç† ä¸º RabbitMQ æµåŠŸèƒ½æä¾›åº•å±‚æ”¯æŒ æ ¸å¿ƒæ–‡ä»¶:123src/osiris_log.erl % æ—¥å¿—ç®¡ç† (3,243 è¡Œ)src/osiris_writer.erl % æ—¥å¿—å†™å…¥å™¨src/osiris_reader.erl % æ—¥å¿—è¯»å–å™¨ ä¸æ ¸å¿ƒäº¤äº’: è¢« rabbitmq_stream ä½¿ç”¨ ä¾èµ–å…³ç³»: ä¾èµ– gen_batch_serverã€seshat 6. khepri - æ ‘å½¢å¤åˆ¶æ•°æ®åº“ æ¨¡å—è·¯å¾„: deps/khepri/ ä¸»è¦åŠŸèƒ½: æ ‘å½¢æ•°æ®ç»“æ„å­˜å‚¨ åŸºäº Ra çš„ä¸€è‡´æ€§ä¿è¯ äº‹åŠ¡æ”¯æŒå’Œè§¦å‘å™¨ æ ¸å¿ƒæ–‡ä»¶:123src/khepri.erl % ä¸» API (3,839 è¡Œ)src/khepri_machine.erl % Ra çŠ¶æ€æœºå®ç°src/khepri_tx.erl % äº‹åŠ¡å¤„ç† ä¸æ ¸å¿ƒäº¤äº’: ä½œä¸º RabbitMQ å…ƒæ•°æ®å­˜å‚¨çš„ç°ä»£åŒ–æ›¿ä»£æ–¹æ¡ˆ ä¾èµ–å…³ç³»: ä¾èµ– raã€horus 7. khepri_mnesia_migration - æ•°æ®åº“è¿ç§»å·¥å…· æ¨¡å—è·¯å¾„: deps/khepri_mnesia_migration/ ä¸»è¦åŠŸèƒ½: é›†ç¾¤æˆå‘˜åŒæ­¥ Mnesia è¡¨åˆ° Khepri çš„æ•°æ®è¿ç§» ä¸æ ¸å¿ƒäº¤äº’: å¸®åŠ© RabbitMQ ä»ä¼ ç»Ÿå­˜å‚¨è¿ç§»åˆ°ç°ä»£å­˜å‚¨ åè®®æ”¯æŒæ¨¡å—8. rabbitmq_mqtt - MQTT åè®®æ”¯æŒ æ¨¡å—è·¯å¾„: deps/rabbitmq_mqtt/ ä¸»è¦åŠŸèƒ½: MQTT 3.1.1 åè®®æ”¯æŒ æ¶ˆæ¯å‘å¸ƒ&#x2F;è®¢é˜…ã€ä¼šè¯ç®¡ç† ä¿ç•™æ¶ˆæ¯ã€QoS çº§åˆ«æ”¯æŒ æ ¸å¿ƒæ–‡ä»¶:123src/rabbit_mqtt_reader.erl % MQTT åè®®è¯»å–å™¨src/rabbit_mqtt_processor.erl % æ¶ˆæ¯å¤„ç†å™¨src/rabbit_mqtt_retained_msg_store.erl % ä¿ç•™æ¶ˆæ¯å­˜å‚¨ ä¸æ ¸å¿ƒäº¤äº’: ä½œä¸ºåè®®é€‚é…å™¨ï¼Œå°† MQTT æ¶ˆæ¯è½¬æ¢ä¸º AMQP é»˜è®¤ç«¯å£: 1883 (TCP), 8883 (TLS) 9. rabbitmq_stomp - STOMP åè®®æ”¯æŒ æ¨¡å—è·¯å¾„: deps/rabbitmq_stomp/ ä¸»è¦åŠŸèƒ½: STOMP 1.0-1.2 åè®®æ”¯æŒ ç®€å•æ–‡æœ¬æ¶ˆæ¯åè®® æ”¯æŒå¤šç§å®¢æˆ·ç«¯è¯­è¨€ æ ¸å¿ƒæ–‡ä»¶:12src/rabbit_stomp_reader.erl % STOMP åè®®è¯»å–å™¨src/rabbit_stomp_processor.erl % æ¶ˆæ¯å¤„ç†å™¨ ä¸æ ¸å¿ƒäº¤äº’: åè®®é€‚é…å™¨ï¼Œè½¬æ¢ STOMP åˆ° AMQP é»˜è®¤ç«¯å£: 61613 (TCP), 61614 (TLS) 10. rabbitmq_stream - æµåè®®æ”¯æŒ æ¨¡å—è·¯å¾„: deps/rabbitmq_stream/ ä¸»è¦åŠŸèƒ½: RabbitMQ æµçš„è‡ªå®šä¹‰äºŒè¿›åˆ¶åè®® é«˜æ€§èƒ½æµå¼æ•°æ®å¤„ç† è¿½åŠ å¼ FIFO ç»“æ„ æ ¸å¿ƒæ–‡ä»¶:12src/rabbit_stream_reader.erl % æµåè®®è¯»å–å™¨ (3,992 è¡Œ)src/rabbit_stream_coordinator.erl % æµåè°ƒå™¨ ä¸æ ¸å¿ƒäº¤äº’: åŸºäº osiris æä¾›æµåŠŸèƒ½ ä¾èµ–å…³ç³»: ä¾èµ– rabbitmq_stream_commonã€osiris é»˜è®¤ç«¯å£: 5552 11. amqp10_client å’Œ amqp10_common - AMQP 1.0 æ”¯æŒ æ¨¡å—è·¯å¾„: deps/amqp10_client/, deps/amqp10_common/ ä¸»è¦åŠŸèƒ½: AMQP 1.0 åè®®å®ç° ä¸ AMQP 0-9-1 çš„äº’æ“ä½œæ€§ ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±• RabbitMQ çš„åè®®æ”¯æŒèŒƒå›´ ç®¡ç†å’Œç›‘æ§æ¨¡å—12. rabbitmq_management - ç®¡ç†æ§åˆ¶å° æ¨¡å—è·¯å¾„: deps/rabbitmq_management/ ä¸»è¦åŠŸèƒ½: Web UI ç®¡ç†ç•Œé¢ REST API æ¥å£ ç»Ÿè®¡ä¿¡æ¯å±•ç¤ºã€ç”¨æˆ·ç®¡ç† æ ¸å¿ƒæ–‡ä»¶:12src/rabbit_mgmt_wm_*.erl % Web ç®¡ç†ç«¯ç‚¹priv/www/ % Web é™æ€æ–‡ä»¶ ä¸æ ¸å¿ƒäº¤äº’: é€šè¿‡ rabbitmq_management_agent è·å–æ•°æ® ä¾èµ–å…³ç³»: ä¾èµ– cowboyã€rabbitmq_web_dispatch é»˜è®¤ç«¯å£: 15672 13. rabbitmq_management_agent - ç®¡ç†ä»£ç† æ¨¡å—è·¯å¾„: deps/rabbitmq_management_agent/ ä¸»è¦åŠŸèƒ½: ç»Ÿè®¡æ•°æ®æ”¶é›† æ€§èƒ½æŒ‡æ ‡èšåˆ ä¸ºç®¡ç†ç•Œé¢æä¾›æ•°æ®æº ä¸æ ¸å¿ƒäº¤äº’: ä» rabbit æ ¸å¿ƒæ”¶é›†æ•°æ®ï¼Œæä¾›ç»™ç®¡ç†ç•Œé¢ 14. rabbitmq_prometheus - Prometheus ç›‘æ§ æ¨¡å—è·¯å¾„: deps/rabbitmq_prometheus/ ä¸»è¦åŠŸèƒ½: å¯¼å‡º RabbitMQ æŒ‡æ ‡åˆ° Prometheus æ”¯æŒèšåˆå’Œè¯¦ç»†æŒ‡æ ‡ å¯é…ç½®çš„æŒ‡æ ‡ç«¯ç‚¹ æ ¸å¿ƒæ–‡ä»¶:1src/prometheus_rabbitmq_core_metrics_collector.erl % æ ¸å¿ƒæŒ‡æ ‡æ”¶é›†å™¨ é»˜è®¤ç«¯å£: 15692 ç«¯ç‚¹: /metrics, /metrics/per-object, /metrics/detailed 15. rabbitmq_cli - å‘½ä»¤è¡Œå·¥å…· æ¨¡å—è·¯å¾„: deps/rabbitmq_cli/ ä¸»è¦åŠŸèƒ½: rabbitmqctl - ä¸»è¦ç®¡ç†å·¥å…· rabbitmq-plugins - æ’ä»¶ç®¡ç† rabbitmq-diagnostics - è¯Šæ–­å·¥å…· rabbitmq-queues - é˜Ÿåˆ—ç®¡ç† rabbitmq-streams - æµç®¡ç† å®ç°è¯­è¨€: Elixir ä¸æ ¸å¿ƒäº¤äº’: é€šè¿‡ç®¡ç† API ä¸ RabbitMQ é€šä¿¡ 16. rabbitmq_top - è¿›ç¨‹ç›‘æ§ æ¨¡å—è·¯å¾„: deps/rabbitmq_top/ ä¸»è¦åŠŸèƒ½: ç±»ä¼¼ Unix top çš„è¿›ç¨‹ç›‘æ§å·¥å…· å®æ—¶è¿›ç¨‹ç›‘æ§ã€èµ„æºä½¿ç”¨ç»Ÿè®¡ ä¸æ ¸å¿ƒäº¤äº’: ç›‘æ§ RabbitMQ å†…éƒ¨è¿›ç¨‹ è®¤è¯å’Œæˆæƒæ¨¡å—17. rabbitmq_auth_backend_oauth2 - OAuth2 è®¤è¯ æ¨¡å—è·¯å¾„: deps/rabbitmq_auth_backend_oauth2/ ä¸»è¦åŠŸèƒ½: åŸºäº JWT ä»¤ç‰Œçš„ OAuth2 è®¤è¯åç«¯ æ”¯æŒå¤šç§èº«ä»½æä¾›å•† (UAAã€Keycloakã€Azure ADã€Auth0) ç»†ç²’åº¦æƒé™æ§åˆ¶ æ ¸å¿ƒæ–‡ä»¶:12src/rabbit_auth_backend_oauth2.erl % ä¸»è®¤è¯åç«¯src/uaa_jwt.erl % JWT å¤„ç† ä¸æ ¸å¿ƒäº¤äº’: ä½œä¸ºè®¤è¯åç«¯æ’ä»¶ ä¾èµ–å…³ç³»: ä¾èµ– joseã€oauth2_client 18. rabbitmq_auth_backend_http - HTTP è®¤è¯ æ¨¡å—è·¯å¾„: deps/rabbitmq_auth_backend_http/ ä¸»è¦åŠŸèƒ½: é€šè¿‡ HTTP API è¿›è¡Œè®¤è¯å’Œæˆæƒ å¤–éƒ¨ HTTP æœåŠ¡è®¤è¯ã€åŠ¨æ€æƒé™æŸ¥è¯¢ ä¸æ ¸å¿ƒäº¤äº’: è®¤è¯åç«¯æ’ä»¶ 19. rabbitmq_auth_backend_ldap - LDAP è®¤è¯ æ¨¡å—è·¯å¾„: deps/rabbitmq_auth_backend_ldap/ ä¸»è¦åŠŸèƒ½: LDAP ç›®å½•æœåŠ¡è®¤è¯ LDAP ç”¨æˆ·è®¤è¯ã€ç»„æƒé™æ˜ å°„ ä¸æ ¸å¿ƒäº¤äº’: è®¤è¯åç«¯æ’ä»¶ 20. rabbitmq_auth_backend_cache - è®¤è¯ç¼“å­˜ æ¨¡å—è·¯å¾„: deps/rabbitmq_auth_backend_cache/ ä¸»è¦åŠŸèƒ½: ç¼“å­˜è®¤è¯ç»“æœä»¥æé«˜æ€§èƒ½ å¯é…ç½®çš„ç¼“å­˜ç­–ç•¥ ä¸æ ¸å¿ƒäº¤äº’: åŒ…è£…å…¶ä»–è®¤è¯åç«¯ 21. rabbitmq_auth_mechanism_ssl - SSL è¯ä¹¦è®¤è¯ æ¨¡å—è·¯å¾„: deps/rabbitmq_auth_mechanism_ssl/ ä¸»è¦åŠŸèƒ½: åŸºäº SSL å®¢æˆ·ç«¯è¯ä¹¦çš„è®¤è¯ X.509 è¯ä¹¦è®¤è¯ã€è¯ä¹¦å­—æ®µæ˜ å°„ ä¸æ ¸å¿ƒäº¤äº’: è®¤è¯æœºåˆ¶æ’ä»¶ é›†ç¾¤å‘ç°æ¨¡å—22. rabbitmq_peer_discovery_aws - AWS é›†ç¾¤å‘ç° æ¨¡å—è·¯å¾„: deps/rabbitmq_peer_discovery_aws/ ä¸»è¦åŠŸèƒ½: åœ¨ AWS ç¯å¢ƒä¸­è‡ªåŠ¨å‘ç°é›†ç¾¤èŠ‚ç‚¹ EC2 å®ä¾‹å‘ç°ã€åŸºäºæ ‡ç­¾çš„èŠ‚ç‚¹è¯†åˆ« ä¸æ ¸å¿ƒäº¤äº’: é›†ç¾¤å‘ç°æ’ä»¶ ä¾èµ–å…³ç³»: ä¾èµ– rabbitmq_awsã€rabbitmq_peer_discovery_common 23. rabbitmq_peer_discovery_k8s - Kubernetes é›†ç¾¤å‘ç° æ¨¡å—è·¯å¾„: deps/rabbitmq_peer_discovery_k8s/ ä¸»è¦åŠŸèƒ½: åœ¨ Kubernetes ç¯å¢ƒä¸­å‘ç°é›†ç¾¤èŠ‚ç‚¹ K8s API é›†æˆã€æœåŠ¡å‘ç° ä¸æ ¸å¿ƒäº¤äº’: é›†ç¾¤å‘ç°æ’ä»¶ 24. rabbitmq_peer_discovery_consul - Consul é›†ç¾¤å‘ç° æ¨¡å—è·¯å¾„: deps/rabbitmq_peer_discovery_consul/ ä¸»è¦åŠŸèƒ½: ä½¿ç”¨ Consul è¿›è¡ŒæœåŠ¡å‘ç° Consul API é›†æˆã€å¥åº·æ£€æŸ¥ ä¸æ ¸å¿ƒäº¤äº’: é›†ç¾¤å‘ç°æ’ä»¶ 25. rabbitmq_peer_discovery_etcd - etcd é›†ç¾¤å‘ç° æ¨¡å—è·¯å¾„: deps/rabbitmq_peer_discovery_etcd/ ä¸»è¦åŠŸèƒ½: ä½¿ç”¨ etcd è¿›è¡Œé›†ç¾¤å‘ç° etcd é”®å€¼å­˜å‚¨é›†æˆã€åˆ†å¸ƒå¼é…ç½® ä¸æ ¸å¿ƒäº¤äº’: é›†ç¾¤å‘ç°æ’ä»¶ ä¾èµ–å…³ç³»: ä¾èµ– eetcd 26. rabbitmq_peer_discovery_common - é›†ç¾¤å‘ç°é€šç”¨åº“ æ¨¡å—è·¯å¾„: deps/rabbitmq_peer_discovery_common/ ä¸»è¦åŠŸèƒ½: ä¸ºå„ç§é›†ç¾¤å‘ç°æœºåˆ¶æä¾›é€šç”¨åŠŸèƒ½ é€šç”¨å‘ç°é€»è¾‘ã€é…ç½®ç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: è¢«å…¶ä»–å‘ç°æ’ä»¶ä½¿ç”¨ äº¤æ¢å™¨æ’ä»¶27. rabbitmq_consistent_hash_exchange - ä¸€è‡´æ€§å“ˆå¸Œäº¤æ¢å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_consistent_hash_exchange/ ä¸»è¦åŠŸèƒ½: åŸºäºä¸€è‡´æ€§å“ˆå¸Œçš„æ¶ˆæ¯è·¯ç”± ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ã€è´Ÿè½½å‡è¡¡ã€èŠ‚ç‚¹æ•…éšœå®¹é”™ ä¸æ ¸å¿ƒäº¤äº’: è‡ªå®šä¹‰äº¤æ¢å™¨ç±»å‹ 28. rabbitmq_random_exchange - éšæœºäº¤æ¢å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_random_exchange/ ä¸»è¦åŠŸèƒ½: éšæœºé€‰æ‹©é˜Ÿåˆ—è¿›è¡Œæ¶ˆæ¯è·¯ç”± éšæœºè´Ÿè½½å‡è¡¡ã€ç®€å•è·¯ç”±ç­–ç•¥ ä¸æ ¸å¿ƒäº¤äº’: è‡ªå®šä¹‰äº¤æ¢å™¨ç±»å‹ 29. rabbitmq_recent_history_exchange - å†å²æ¶ˆæ¯äº¤æ¢å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_recent_history_exchange/ ä¸»è¦åŠŸèƒ½: ä¿ç•™æœ€è¿‘æ¶ˆæ¯å†å²çš„äº¤æ¢å™¨ æ¶ˆæ¯å†å²ç¼“å­˜ã€æ–°è®¢é˜…è€…å¯è·å–å†å²æ¶ˆæ¯ ä¸æ ¸å¿ƒäº¤äº’: è‡ªå®šä¹‰äº¤æ¢å™¨ç±»å‹ 30. rabbitmq_event_exchange - äº‹ä»¶äº¤æ¢å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_event_exchange/ ä¸»è¦åŠŸèƒ½: å‘å¸ƒ RabbitMQ å†…éƒ¨äº‹ä»¶ ç³»ç»Ÿäº‹ä»¶å‘å¸ƒã€ç›‘æ§å’Œå®¡è®¡æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: å‘å¸ƒå†…éƒ¨äº‹ä»¶åˆ° AMQP 31. rabbitmq_jms_topic_exchange - JMS ä¸»é¢˜äº¤æ¢å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_jms_topic_exchange/ ä¸»è¦åŠŸèƒ½: æ”¯æŒ JMS é£æ ¼çš„ä¸»é¢˜è·¯ç”± JMS ä¸»é¢˜è¯­ä¹‰ã€å±‚æ¬¡åŒ–ä¸»é¢˜ç»“æ„ ä¸æ ¸å¿ƒäº¤äº’: è‡ªå®šä¹‰äº¤æ¢å™¨ç±»å‹ è”é‚¦å’Œå¤åˆ¶æ¨¡å—32. rabbitmq_federation - è”é‚¦ æ¨¡å—è·¯å¾„: deps/rabbitmq_federation/ ä¸»è¦åŠŸèƒ½: è·¨ WAN çš„æ¾è€¦åˆåˆ†å¸ƒå¼ RabbitMQ è®¾ç½® äº¤æ¢å™¨å’Œé˜Ÿåˆ—è”é‚¦ã€è·¨é›†ç¾¤æ¶ˆæ¯å¤åˆ¶ WAN å‹å¥½çš„è®¾è®¡ æ ¸å¿ƒæ–‡ä»¶:12src/rabbit_federation_link.erl % è”é‚¦é“¾æ¥src/rabbit_federation_exchange.erl % è”é‚¦äº¤æ¢å™¨ ä¸æ ¸å¿ƒäº¤äº’: åˆ›å»ºè”é‚¦é“¾æ¥å’Œå¤åˆ¶ç­–ç•¥ ä¾èµ–å…³ç³»: ä¾èµ– amqp_client 33. rabbitmq_federation_management - è”é‚¦ç®¡ç† æ¨¡å—è·¯å¾„: deps/rabbitmq_federation_management/ ä¸»è¦åŠŸèƒ½: è”é‚¦åŠŸèƒ½çš„ç®¡ç†ç•Œé¢æ‰©å±• è”é‚¦çŠ¶æ€ç›‘æ§ã€è”é‚¦é…ç½®ç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±•ç®¡ç†ç•Œé¢ 34. rabbitmq_federation_prometheus - è”é‚¦ç›‘æ§ æ¨¡å—è·¯å¾„: deps/rabbitmq_federation_prometheus/ ä¸»è¦åŠŸèƒ½: è”é‚¦ç›¸å…³çš„ Prometheus æŒ‡æ ‡ è”é‚¦é“¾æ¥çŠ¶æ€æŒ‡æ ‡ã€å¤åˆ¶æ€§èƒ½æŒ‡æ ‡ ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±• Prometheus å¯¼å‡ºå™¨ 35. rabbitmq_shovel - é“²å­ æ¨¡å—è·¯å¾„: deps/rabbitmq_shovel/ ä¸»è¦åŠŸèƒ½: WAN å‹å¥½çš„æ¶ˆæ¯ç§»åŠ¨å·¥å…· é˜Ÿåˆ—åˆ°äº¤æ¢å™¨çš„æ¶ˆæ¯ä¼ è¾“ æ”¯æŒä¸åŒ RabbitMQ èŠ‚ç‚¹é—´ä¼ è¾“ åŠ¨æ€å’Œé™æ€é“²å­é…ç½® æ ¸å¿ƒæ–‡ä»¶:12src/rabbit_shovel_worker.erl % é“²å­å·¥ä½œè¿›ç¨‹src/rabbit_shovel_dyn_worker_sup.erl % åŠ¨æ€å·¥ä½œè¿›ç¨‹ç›‘ç£å™¨ ä¸æ ¸å¿ƒäº¤äº’: ä½œä¸ºæ¶ˆæ¯ä¼ è¾“å·¥å…· ä¾èµ–å…³ç³»: ä¾èµ– amqp_client 36. rabbitmq_shovel_management - é“²å­ç®¡ç† æ¨¡å—è·¯å¾„: deps/rabbitmq_shovel_management/ ä¸»è¦åŠŸèƒ½: é“²å­åŠŸèƒ½çš„ç®¡ç†ç•Œé¢ é“²å­çŠ¶æ€ç›‘æ§ã€åŠ¨æ€é“²å­ç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±•ç®¡ç†ç•Œé¢ 37. rabbitmq_shovel_prometheus - é“²å­ç›‘æ§ æ¨¡å—è·¯å¾„: deps/rabbitmq_shovel_prometheus/ ä¸»è¦åŠŸèƒ½: é“²å­ç›¸å…³çš„ Prometheus æŒ‡æ ‡ é“²å­ä¼ è¾“æŒ‡æ ‡ã€æ€§èƒ½ç›‘æ§ ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±• Prometheus å¯¼å‡ºå™¨ Web å’Œç½‘ç»œæ¨¡å—38. rabbitmq_web_dispatch - Web åˆ†å‘å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_web_dispatch/ ä¸»è¦åŠŸèƒ½: HTTP è¯·æ±‚è·¯ç”±å’Œåˆ†å‘ æ’ä»¶ Web æ¥å£æ³¨å†Œ ä¸æ ¸å¿ƒäº¤äº’: ä¸ºç®¡ç†ç•Œé¢å’Œå…¶ä»– Web æ’ä»¶æä¾›åŸºç¡€ ä¾èµ–å…³ç³»: ä¾èµ– cowboyã€ranch 39. rabbitmq_web_mqtt - Web MQTT æ¨¡å—è·¯å¾„: deps/rabbitmq_web_mqtt/ ä¸»è¦åŠŸèƒ½: é€šè¿‡ WebSocket æä¾› MQTT æ”¯æŒ WebSocket åˆ° MQTT æ¡¥æ¥ã€æµè§ˆå™¨ MQTT å®¢æˆ·ç«¯æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±• MQTT åè®®åˆ° Web ä¾èµ–å…³ç³»: ä¾èµ– rabbitmq_mqtt é»˜è®¤ç«¯å£: 15675 40. rabbitmq_web_mqtt_examples - Web MQTT ç¤ºä¾‹ æ¨¡å—è·¯å¾„: deps/rabbitmq_web_mqtt_examples/ ä¸»è¦åŠŸèƒ½: Web MQTT åŠŸèƒ½çš„ç¤ºä¾‹ä»£ç  ç¤ºä¾‹ HTML é¡µé¢ã€JavaScript å®¢æˆ·ç«¯ç¤ºä¾‹ ä¸æ ¸å¿ƒäº¤äº’: æä¾›ä½¿ç”¨ç¤ºä¾‹ 41. rabbitmq_web_stomp - Web STOMP æ¨¡å—è·¯å¾„: deps/rabbitmq_web_stomp/ ä¸»è¦åŠŸèƒ½: é€šè¿‡ WebSocket æä¾› STOMP æ”¯æŒ WebSocket åˆ° STOMP æ¡¥æ¥ã€æµè§ˆå™¨ STOMP å®¢æˆ·ç«¯æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±• STOMP åè®®åˆ° Web ä¾èµ–å…³ç³»: ä¾èµ– rabbitmq_stomp é»˜è®¤ç«¯å£: 15674 42. rabbitmq_web_stomp_examples - Web STOMP ç¤ºä¾‹ æ¨¡å—è·¯å¾„: deps/rabbitmq_web_stomp_examples/ ä¸»è¦åŠŸèƒ½: Web STOMP åŠŸèƒ½çš„ç¤ºä¾‹ä»£ç  ç¤ºä¾‹ HTML é¡µé¢ã€JavaScript å®¢æˆ·ç«¯ç¤ºä¾‹ ä¸æ ¸å¿ƒäº¤äº’: æä¾›ä½¿ç”¨ç¤ºä¾‹ HTTP å’Œç½‘ç»œåŸºç¡€åº“43. cowboy - HTTP æœåŠ¡å™¨ æ¨¡å—è·¯å¾„: deps/cowboy/ ä¸»è¦åŠŸèƒ½: å°å‹ã€å¿«é€Ÿã€ç°ä»£çš„ HTTP æœåŠ¡å™¨ HTTP&#x2F;1.1 å’Œ HTTP&#x2F;2 æ”¯æŒ WebSocket æ”¯æŒã€è·¯ç”±å’Œå¤„ç†å™¨ æ ¸å¿ƒæ–‡ä»¶:12src/cowboy_http.erl % HTTP åè®®å¤„ç†src/cowboy_websocket.erl % WebSocket å¤„ç† ä¸æ ¸å¿ƒäº¤äº’: ä¸ºç®¡ç†ç•Œé¢å’Œ Web æ’ä»¶æä¾› HTTP æœåŠ¡ ä¾èµ–å…³ç³»: ä¾èµ– cowlibã€ranch 44. cowlib - Cowboy æ”¯æŒåº“ æ¨¡å—è·¯å¾„: deps/cowlib/ ä¸»è¦åŠŸèƒ½: Cowboy HTTP æœåŠ¡å™¨çš„æ”¯æŒåº“ HTTP åè®®è§£æã€é€šç”¨ HTTP å·¥å…· æ ¸å¿ƒæ–‡ä»¶:1src/cow_http_hd.erl % HTTP å¤´å¤„ç† (3,642 è¡Œ) ä¸æ ¸å¿ƒäº¤äº’: è¢« cowboy ä½¿ç”¨ 45. ranch - Socket æ¥å—å™¨æ±  æ¨¡å—è·¯å¾„: deps/ranch/ ä¸»è¦åŠŸèƒ½: TCP åè®®çš„ socket æ¥å—å™¨æ±  è¿æ¥æ± ç®¡ç†ã€å¹¶å‘è¿æ¥é™åˆ¶ã€ä¼ è¾“å±‚æŠ½è±¡ ä¸æ ¸å¿ƒäº¤äº’: ä¸ºæ‰€æœ‰ç½‘ç»œè¿æ¥æä¾›åŸºç¡€è®¾æ–½ ä¾èµ–å…³ç³»: è¢« cowboyã€rabbit ç­‰ä½¿ç”¨ 46. gun - HTTP å®¢æˆ·ç«¯ æ¨¡å—è·¯å¾„: deps/gun/ ä¸»è¦åŠŸèƒ½: HTTP&#x2F;1.1ã€HTTP&#x2F;2 å’Œ WebSocket å®¢æˆ·ç«¯ æŒä¹…è¿æ¥ã€å¤šåè®®æ”¯æŒã€è‡ªåŠ¨é‡è¿ ä¸æ ¸å¿ƒäº¤äº’: ç”¨äºå¤–éƒ¨ HTTP é€šä¿¡ å®‰å…¨å’ŒåŠ å¯†æ¨¡å—47. rabbitmq_trust_store - ä¿¡ä»»å­˜å‚¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_trust_store/ ä¸»è¦åŠŸèƒ½: åŠ¨æ€ SSL è¯ä¹¦ä¿¡ä»»å­˜å‚¨ç®¡ç† è¯ä¹¦éªŒè¯ã€åŠ¨æ€è¯ä¹¦æ›´æ–°ã€è¯ä¹¦æ’¤é”€åˆ—è¡¨æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: å¢å¼º SSL å®‰å…¨æ€§ 48. credentials_obfuscation - å‡­æ®æ··æ·† æ¨¡å—è·¯å¾„: deps/credentials_obfuscation/ ä¸»è¦åŠŸèƒ½: æ•æ„Ÿä¿¡æ¯åŠ å¯†å’Œæ··æ·† å¯†ç åŠ å¯†å­˜å‚¨ã€é…ç½®æ–‡ä»¶æ•æ„Ÿä¿¡æ¯ä¿æŠ¤ ä¸æ ¸å¿ƒäº¤äº’: ä¿æŠ¤é…ç½®ä¸­çš„æ•æ„Ÿä¿¡æ¯ 49. jose - JSON Web ç­¾å&#x2F;åŠ å¯† æ¨¡å—è·¯å¾„: deps/jose/ ä¸»è¦åŠŸèƒ½: JWTã€JWSã€JWEã€JWKã€JWA å®ç° JWT ä»¤ç‰Œå¤„ç†ã€æ•°å­—ç­¾åéªŒè¯ã€åŠ å¯†è§£å¯† æ ¸å¿ƒæ–‡ä»¶:123src/jose_jwt.erl % JWT å¤„ç†src/jose_jws.erl % JWS ç­¾åsrc/jose_jwe.erl % JWE åŠ å¯† ä¸æ ¸å¿ƒäº¤äº’: è¢« OAuth2 è®¤è¯åç«¯ä½¿ç”¨ ä¾èµ–å…³ç³»: è¢« rabbitmq_auth_backend_oauth2 ä½¿ç”¨ 50. base64url - Base64URL ç¼–ç  æ¨¡å—è·¯å¾„: deps/base64url/ ä¸»è¦åŠŸèƒ½: Base64URL ç¼–ç &#x2F;è§£ç  URL å®‰å…¨çš„ Base64 ç¼–ç ã€JWT ä»¤ç‰Œç¼–ç æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: æ”¯æŒ JWT å¤„ç† å·¥å…·å’Œå®ç”¨ç¨‹åºæ¨¡å—51. cuttlefish - é…ç½®ç®¡ç† æ¨¡å—è·¯å¾„: deps/cuttlefish/ ä¸»è¦åŠŸèƒ½: é…ç½®æ–‡ä»¶æ ¼å¼è½¬æ¢å’Œç®¡ç† .conf åˆ° app.config è½¬æ¢ é…ç½®éªŒè¯å’Œæ¨¡å¼å®šä¹‰ã€ç”¨æˆ·å‹å¥½çš„é…ç½®è¯­æ³• æ ¸å¿ƒæ–‡ä»¶:12src/cuttlefish.erl % ä¸»é…ç½®å¤„ç†src/cuttlefish_schema.erl % é…ç½®æ¨¡å¼ ä¸æ ¸å¿ƒäº¤äº’: å¤„ç† RabbitMQ é…ç½®æ–‡ä»¶ 52. rabbitmq_codegen - ä»£ç ç”Ÿæˆå™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_codegen/ ä¸»è¦åŠŸèƒ½: ä» AMQP è§„èŒƒç”Ÿæˆåè®®å¤„ç†ä»£ç  AMQP åè®®ä»£ç ç”Ÿæˆã€æ”¯æŒåè®®æ‰©å±• ä¸æ ¸å¿ƒäº¤äº’: æ„å»ºæ—¶ç”Ÿæˆåè®®å¤„ç†ä»£ç  53. recon - ç”Ÿäº§è¯Šæ–­å·¥å…· æ¨¡å—è·¯å¾„: deps/recon/ ä¸»è¦åŠŸèƒ½: ç”Ÿäº§ç¯å¢ƒå®‰å…¨çš„ Erlang è¯Šæ–­å·¥å…· è¿›ç¨‹ç›‘æ§ã€å†…å­˜åˆ†æã€æ€§èƒ½è¯Šæ–­ ä¸æ ¸å¿ƒäº¤äº’: æä¾›è¿è¡Œæ—¶è¯Šæ–­èƒ½åŠ› 54. redbug - è°ƒè¯•å·¥å…· æ¨¡å—è·¯å¾„: deps/redbug/ ä¸»è¦åŠŸèƒ½: ç”Ÿäº§ç¯å¢ƒå®‰å…¨çš„è°ƒè¯•å’Œè·Ÿè¸ªå·¥å…· å‡½æ•°è°ƒç”¨è·Ÿè¸ªã€æ€§èƒ½åˆ†æã€è°ƒè¯•ä¿¡æ¯æ”¶é›† æ ¸å¿ƒæ–‡ä»¶:1src/redbug_parser.erl % è·Ÿè¸ªè§£æå™¨ (3,184 è¡Œ) ä¸æ ¸å¿ƒäº¤äº’: æä¾›è°ƒè¯•èƒ½åŠ› 55. observer_cli - å‘½ä»¤è¡Œè§‚å¯Ÿå™¨ æ¨¡å—è·¯å¾„: deps/observer_cli/ ä¸»è¦åŠŸèƒ½: å‘½ä»¤è¡Œç‰ˆæœ¬çš„ Observer å·¥å…· å®æ—¶ç³»ç»Ÿç›‘æ§ã€è¿›ç¨‹å’Œå†…å­˜ç»Ÿè®¡ã€ç½‘ç»œå’Œç£ç›˜ç›‘æ§ ä¸æ ¸å¿ƒäº¤äº’: ç›‘æ§ RabbitMQ è¿è¡ŒçŠ¶æ€ æµå¤„ç†ç›¸å…³æ¨¡å—56. rabbitmq_stream_common - æµé€šç”¨åº“ æ¨¡å—è·¯å¾„: deps/rabbitmq_stream_common/ ä¸»è¦åŠŸèƒ½: æµåŠŸèƒ½çš„é€šç”¨ç»„ä»¶ æµåè®®é€šç”¨å®šä¹‰ã€å…±äº«æ•°æ®ç»“æ„ ä¸æ ¸å¿ƒäº¤äº’: è¢«æµç›¸å…³æ¨¡å—ä½¿ç”¨ 57. rabbitmq_stream_management - æµç®¡ç† æ¨¡å—è·¯å¾„: deps/rabbitmq_stream_management/ ä¸»è¦åŠŸèƒ½: æµåŠŸèƒ½çš„ç®¡ç†ç•Œé¢æ‰©å±• æµçŠ¶æ€ç›‘æ§ã€æµé…ç½®ç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±•ç®¡ç†ç•Œé¢ 58. seshat - æ—¥å¿—ç®¡ç† æ¨¡å—è·¯å¾„: deps/seshat/ ä¸»è¦åŠŸèƒ½: é«˜æ€§èƒ½æ—¥å¿—ç®¡ç†åº“ æ—¥å¿—ç´¢å¼•å’ŒæŸ¥è¯¢ã€é«˜æ•ˆæ—¥å¿—å­˜å‚¨ ä¸æ ¸å¿ƒäº¤äº’: è¢« ra å’Œ osiris ä½¿ç”¨ ç³»ç»Ÿé›†æˆæ¨¡å—59. rabbitmq_prelaunch - é¢„å¯åŠ¨å¤„ç† æ¨¡å—è·¯å¾„: deps/rabbitmq_prelaunch/ ä¸»è¦åŠŸèƒ½: RabbitMQ å¯åŠ¨å‰çš„å‡†å¤‡å·¥ä½œ ç¯å¢ƒæ£€æŸ¥ã€é…ç½®é¢„å¤„ç†ã€ä¾èµ–éªŒè¯ ä¸æ ¸å¿ƒäº¤äº’: å¯åŠ¨æµç¨‹çš„ä¸€éƒ¨åˆ† 60. systemd - Systemd é›†æˆ æ¨¡å—è·¯å¾„: deps/systemd/ ä¸»è¦åŠŸèƒ½: ä¸ systemd ç³»ç»ŸæœåŠ¡ç®¡ç†å™¨é›†æˆ æœåŠ¡çŠ¶æ€é€šçŸ¥ã€ç³»ç»Ÿé›†æˆæ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: æä¾›ç³»ç»ŸæœåŠ¡é›†æˆ 61. syslog - ç³»ç»Ÿæ—¥å¿— æ¨¡å—è·¯å¾„: deps/syslog/ ä¸»è¦åŠŸèƒ½: ç³»ç»Ÿæ—¥å¿—é›†æˆ syslog åè®®æ”¯æŒã€æ—¥å¿—è½¬å‘ ä¸æ ¸å¿ƒäº¤äº’: æä¾›æ—¥å¿—è¾“å‡ºé€‰é¡¹ 62. sysmon_handler - ç³»ç»Ÿç›‘æ§å¤„ç†å™¨ æ¨¡å—è·¯å¾„: deps/sysmon_handler/ ä¸»è¦åŠŸèƒ½: ç³»ç»Ÿç›‘æ§äº‹ä»¶å¤„ç† ç³»ç»Ÿäº‹ä»¶ç›‘æ§ã€æ€§èƒ½è­¦æŠ¥ ä¸æ ¸å¿ƒäº¤äº’: ç›‘æ§ç³»ç»Ÿå¥åº·çŠ¶æ€ æ•°æ®å¤„ç†å’Œåºåˆ—åŒ–æ¨¡å—63. thoas - JSON å¤„ç† æ¨¡å—è·¯å¾„: deps/thoas/ ä¸»è¦åŠŸèƒ½: é«˜æ€§èƒ½ JSON ç¼–ç &#x2F;è§£ç  å¿«é€Ÿ JSON å¤„ç†ã€å†…å­˜é«˜æ•ˆ ä¸æ ¸å¿ƒäº¤äº’: å¤„ç† JSON æ ¼å¼æ•°æ® 64. json - JSON åº“ (Elixir) æ¨¡å—è·¯å¾„: deps/json/ ä¸»è¦åŠŸèƒ½: Elixir JSON å¤„ç†åº“ JSON ç¼–ç è§£ç ã€Elixir æ•°æ®ç»“æ„æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: è¢« rabbitmq_cli ä½¿ç”¨ 65. csv - CSV å¤„ç† (Elixir) æ¨¡å—è·¯å¾„: deps/csv/ ä¸»è¦åŠŸèƒ½: CSV æ–‡ä»¶å¤„ç† CSV è§£æå’Œç”Ÿæˆã€æµå¼å¤„ç† ä¸æ ¸å¿ƒäº¤äº’: æ•°æ®å¯¼å…¥å¯¼å‡ºæ”¯æŒ ç›‘æ§å’ŒæŒ‡æ ‡æ¨¡å—66. prometheus - Prometheus å®¢æˆ·ç«¯åº“ æ¨¡å—è·¯å¾„: deps/prometheus/ ä¸»è¦åŠŸèƒ½: Prometheus æŒ‡æ ‡æ”¶é›†åº“ æŒ‡æ ‡å®šä¹‰å’Œæ”¶é›†ã€å¤šç§æŒ‡æ ‡ç±»å‹æ”¯æŒ æ ¸å¿ƒæ–‡ä»¶:1src/prometheus_model.erl % Prometheus æ¨¡å‹ (2,983 è¡Œ) ä¸æ ¸å¿ƒäº¤äº’: è¢« rabbitmq_prometheus ä½¿ç”¨ 67. quantile_estimator - åˆ†ä½æ•°ä¼°ç®— æ¨¡å—è·¯å¾„: deps/quantile_estimator/ ä¸»è¦åŠŸèƒ½: é«˜æ•ˆçš„åˆ†ä½æ•°è®¡ç®— æµå¼åˆ†ä½æ•°ä¼°ç®—ã€å†…å­˜é«˜æ•ˆç®—æ³• ä¸æ ¸å¿ƒäº¤äº’: æä¾›æ€§èƒ½æŒ‡æ ‡è®¡ç®— 68. rabbitmq_tracing - æ¶ˆæ¯è·Ÿè¸ª æ¨¡å—è·¯å¾„: deps/rabbitmq_tracing/ ä¸»è¦åŠŸèƒ½: æ¶ˆæ¯æµè·Ÿè¸ªå’Œè°ƒè¯• æ¶ˆæ¯è·¯å¾„è·Ÿè¸ªã€è°ƒè¯•ä¿¡æ¯æ”¶é›† ä¸æ ¸å¿ƒäº¤äº’: æä¾›æ¶ˆæ¯æµå¯è§†åŒ– åˆ†ç‰‡å’Œè´Ÿè½½å‡è¡¡æ¨¡å—69. rabbitmq_sharding - åˆ†ç‰‡ æ¨¡å—è·¯å¾„: deps/rabbitmq_sharding/ ä¸»è¦åŠŸèƒ½: é˜Ÿåˆ—åˆ†ç‰‡å’Œè´Ÿè½½åˆ†å¸ƒ è‡ªåŠ¨é˜Ÿåˆ—åˆ†ç‰‡ã€è´Ÿè½½å‡è¡¡ã€æ°´å¹³æ‰©å±•æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: æä¾›é˜Ÿåˆ—åˆ†ç‰‡ç­–ç•¥ è¾…åŠ©å’Œæ”¯æŒæ¨¡å—70. rabbitmq_aws - AWS é›†æˆ æ¨¡å—è·¯å¾„: deps/rabbitmq_aws/ ä¸»è¦åŠŸèƒ½: AWS æœåŠ¡é›†æˆæ”¯æŒ AWS API å®¢æˆ·ç«¯ã€äº‘æœåŠ¡é›†æˆ ä¸æ ¸å¿ƒäº¤äº’: æ”¯æŒ AWS ç¯å¢ƒéƒ¨ç½² 71. oauth2_client - OAuth2 å®¢æˆ·ç«¯ æ¨¡å—è·¯å¾„: deps/oauth2_client/ ä¸»è¦åŠŸèƒ½: OAuth2 å®¢æˆ·ç«¯å®ç° OAuth2 æµç¨‹å¤„ç†ã€ä»¤ç‰Œç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: æ”¯æŒ OAuth2 è®¤è¯ 72. accept - å†…å®¹åå•† æ¨¡å—è·¯å¾„: deps/accept/ ä¸»è¦åŠŸèƒ½: HTTP å†…å®¹åå•†å¤„ç† Accept å¤´è§£æã€å†…å®¹ç±»å‹åå•† ä¸æ ¸å¿ƒäº¤äº’: æ”¯æŒ HTTP API å†…å®¹åå•† 73. aten - æ•…éšœæ£€æµ‹ æ¨¡å—è·¯å¾„: deps/aten/ ä¸»è¦åŠŸèƒ½: åˆ†å¸ƒå¼æ•…éšœæ£€æµ‹ èŠ‚ç‚¹æ•…éšœæ£€æµ‹ã€ç½‘ç»œåˆ†åŒºæ£€æµ‹ ä¸æ ¸å¿ƒäº¤äº’: è¢« ra ä½¿ç”¨è¿›è¡Œæ•…éšœæ£€æµ‹ 74. gen_batch_server - æ‰¹å¤„ç†æœåŠ¡å™¨ æ¨¡å—è·¯å¾„: deps/gen_batch_server/ ä¸»è¦åŠŸèƒ½: æ‰¹é‡æ“ä½œçš„é€šç”¨æœåŠ¡å™¨è¡Œä¸º æ‰¹é‡è¯·æ±‚å¤„ç†ã€æ€§èƒ½ä¼˜åŒ– ä¸æ ¸å¿ƒäº¤äº’: è¢« raã€osiris ç­‰ä½¿ç”¨ 75. enough - èµ„æºé™åˆ¶ æ¨¡å—è·¯å¾„: deps/enough/ ä¸»è¦åŠŸèƒ½: èµ„æºä½¿ç”¨é™åˆ¶å’Œç›‘æ§ å†…å­˜ä½¿ç”¨ç›‘æ§ã€èµ„æºé™åˆ¶æ‰§è¡Œ ä¸æ ¸å¿ƒäº¤äº’: æä¾›èµ„æºä¿æŠ¤ 76. getopt - å‘½ä»¤è¡Œé€‰é¡¹è§£æ æ¨¡å—è·¯å¾„: deps/getopt/ ä¸»è¦åŠŸèƒ½: å‘½ä»¤è¡Œå‚æ•°è§£æ é€‰é¡¹è§£æã€å¸®åŠ©ä¿¡æ¯ç”Ÿæˆ ä¸æ ¸å¿ƒäº¤äº’: è¢«å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨ 77. horus - å‡½æ•°åºåˆ—åŒ– æ¨¡å—è·¯å¾„: deps/horus/ ä¸»è¦åŠŸèƒ½: Erlang å‡½æ•°åºåˆ—åŒ–å’Œååºåˆ—åŒ– å‡½æ•°æŒä¹…åŒ–ã€è·¨èŠ‚ç‚¹å‡½æ•°ä¼ è¾“ æ ¸å¿ƒæ–‡ä»¶:1src/horus.erl % ä¸»æ¨¡å— (3,043 è¡Œ) ä¸æ ¸å¿ƒäº¤äº’: è¢« khepri ä½¿ç”¨å­˜å‚¨å‡½æ•° 78. stdout_formatter - æ ‡å‡†è¾“å‡ºæ ¼å¼åŒ– æ¨¡å—è·¯å¾„: deps/stdout_formatter/ ä¸»è¦åŠŸèƒ½: æ—¥å¿—è¾“å‡ºæ ¼å¼åŒ– å½©è‰²è¾“å‡ºã€æ ¼å¼åŒ–æ—¥å¿— ä¸æ ¸å¿ƒäº¤äº’: æä¾›æ—¥å¿—æ ¼å¼åŒ– æµ‹è¯•å’Œå¼€å‘æ”¯æŒæ¨¡å—79. rabbitmq_ct_helpers - æµ‹è¯•è¾…åŠ©å·¥å…· æ¨¡å—è·¯å¾„: deps/rabbitmq_ct_helpers/ ä¸»è¦åŠŸèƒ½: Common Test æµ‹è¯•æ¡†æ¶è¾…åŠ© æµ‹è¯•ç¯å¢ƒè®¾ç½®ã€æµ‹è¯•å·¥å…·å‡½æ•° ä¸æ ¸å¿ƒäº¤äº’: æ”¯æŒæµ‹è¯•å¼€å‘ 80. rabbitmq_ct_client_helpers - å®¢æˆ·ç«¯æµ‹è¯•è¾…åŠ© æ¨¡å—è·¯å¾„: deps/rabbitmq_ct_client_helpers/ ä¸»è¦åŠŸèƒ½: å®¢æˆ·ç«¯æµ‹è¯•è¾…åŠ©å·¥å…· å®¢æˆ·ç«¯æµ‹è¯•æ”¯æŒã€è¿æ¥ç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: æ”¯æŒå®¢æˆ·ç«¯æµ‹è¯• 81. elvis_mk - ä»£ç é£æ ¼æ£€æŸ¥ æ¨¡å—è·¯å¾„: deps/elvis_mk/ ä¸»è¦åŠŸèƒ½: Erlang ä»£ç é£æ ¼æ£€æŸ¥å·¥å…· ä»£ç é£æ ¼éªŒè¯ã€è´¨é‡æ£€æŸ¥ ä¸æ ¸å¿ƒäº¤äº’: å¼€å‘æ—¶ä»£ç è´¨é‡ä¿è¯ ç‰¹æ®Šç”¨é€”æ¨¡å—82. rabbitmq_amqp1_0 - AMQP 1.0 æ¡¥æ¥ æ¨¡å—è·¯å¾„: deps/rabbitmq_amqp1_0/ ä¸»è¦åŠŸèƒ½: AMQP 1.0 åè®®æ¡¥æ¥ åè®®è½¬æ¢ã€å…¼å®¹æ€§æ”¯æŒ ä¸æ ¸å¿ƒäº¤äº’: æä¾› AMQP 1.0 æ”¯æŒ 83. rabbitmq_amqp_client - AMQP å®¢æˆ·ç«¯é€‚é…å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_amqp_client/ ä¸»è¦åŠŸèƒ½: AMQP å®¢æˆ·ç«¯åŠŸèƒ½é€‚é… å®¢æˆ·ç«¯æ¥å£é€‚é…ã€åè®®è½¬æ¢ ä¸æ ¸å¿ƒäº¤äº’: æä¾›å®¢æˆ·ç«¯æ”¯æŒ 84. trust_store_http - HTTP ä¿¡ä»»å­˜å‚¨ æ¨¡å—è·¯å¾„: deps/trust_store_http/ ä¸»è¦åŠŸèƒ½: é€šè¿‡ HTTP ç®¡ç†ä¿¡ä»»å­˜å‚¨ HTTP API ä¿¡ä»»å­˜å‚¨ã€è¿œç¨‹è¯ä¹¦ç®¡ç† ä¸æ ¸å¿ƒäº¤äº’: æ‰©å±•ä¿¡ä»»å­˜å‚¨åŠŸèƒ½ 85. eetcd - etcd å®¢æˆ·ç«¯ æ¨¡å—è·¯å¾„: deps/eetcd/ ä¸»è¦åŠŸèƒ½: etcd é”®å€¼å­˜å‚¨å®¢æˆ·ç«¯ etcd API å®¢æˆ·ç«¯ã€åˆ†å¸ƒå¼é…ç½® æ ¸å¿ƒæ–‡ä»¶:123src/protos/router_pb.erl % è·¯ç”±åè®® (64,412 è¡Œ)src/protos/auth_pb.erl % è®¤è¯åè®® (29,983 è¡Œ)src/protos/kv_pb.erl % é”®å€¼åè®® (29,658 è¡Œ) ä¸æ ¸å¿ƒäº¤äº’: æ”¯æŒ etcd é›†ç¾¤å‘ç° 86. rabbitmq_consistent_hash_exchange - ä¸€è‡´æ€§å“ˆå¸Œäº¤æ¢å™¨ æ¨¡å—è·¯å¾„: deps/rabbitmq_consistent_hash_exchange/ ä¸»è¦åŠŸèƒ½: ä¸€è‡´æ€§å“ˆå¸Œè·¯ç”±äº¤æ¢å™¨ ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ã€è´Ÿè½½å‡è¡¡è·¯ç”± ä¸æ ¸å¿ƒäº¤äº’: è‡ªå®šä¹‰äº¤æ¢å™¨ç±»å‹ ä¾èµ–å…³ç³»å›¾123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ rabbit â”‚ â”‚ (æ ¸å¿ƒæœåŠ¡å™¨) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â–¼ â–¼ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ rabbit_common â”‚ â”‚ ra â”‚ â”‚ osiris â”‚â”‚ (å…±äº«åº“) â”‚ â”‚ (Raftä¸€è‡´æ€§) â”‚ â”‚ (æ—¥å¿—å­˜å‚¨) â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â–¼ â”‚ â–¼ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ aten â”‚ â”‚ â”‚ seshat â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ (æ•…éšœæ£€æµ‹) â”‚ â”‚ â”‚(æ—¥å¿—ç®¡ç†)â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â–¼ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚gen_batch_server â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ (æ‰¹å¤„ç†æœåŠ¡å™¨) â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ amqp_client â”‚ â”‚ khepri â”‚â”‚ (AMQPå®¢æˆ·ç«¯) â”‚ â”‚ (æ ‘å½¢æ•°æ®åº“) â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ horus â”‚ â”‚ (å‡½æ•°åºåˆ—åŒ–) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ç½‘ç»œå±‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ cowboy â”‚â”€â–¶â”‚ cowlib â”‚ â”‚ ranch â”‚â—„â”€â”€â”€â”€â”€â”‚ â”‚ â”‚(HTTPæœåŠ¡)â”‚ â”‚(HTTPåº“) â”‚ â”‚ (è¿æ¥æ± ) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ åè®®å±‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚rabbitmq_mqtt â”‚ â”‚ rabbitmq_stream â”‚ â”‚ â”‚ â”‚ (MQTTåè®®) â”‚ â”‚ (æµåè®®) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚rabbitmq_stompâ”‚ â”‚ â”‚ â”‚ (STOMPåè®®) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ç®¡ç†å±‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚rabbitmq_managementâ”‚ â”‚rabbitmq_prometheus â”‚ â”‚ â”‚ â”‚ (Webç®¡ç†) â”‚ â”‚ (Prometheusç›‘æ§) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â–¼ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚rabbitmq_web_dispatch â”‚ â”‚ â”‚ â”‚ (Webåˆ†å‘å™¨) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æ€»ä½“æ¶æ„ç‰¹ç‚¹1. æ¨¡å—åŒ–è®¾è®¡ æ¸…æ™°åˆ†å±‚: æ ¸å¿ƒã€å­˜å‚¨ã€åè®®ã€ç®¡ç†ã€å·¥å…·ç­‰å±‚æ¬¡åˆ†æ˜ èŒè´£å•ä¸€: æ¯ä¸ªæ¨¡å—éƒ½æœ‰æ˜ç¡®çš„åŠŸèƒ½è¾¹ç•Œ æ¥å£æ ‡å‡†: ç»Ÿä¸€çš„æ’ä»¶æ¥å£å’Œæ‰©å±•æœºåˆ¶ 2. å¯æ‰©å±•æ€§ æ’ä»¶æ¶æ„: æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶å’Œè‡ªå®šä¹‰æ‰©å±• åè®®æ‰©å±•: æ”¯æŒå¤šç§æ¶ˆæ¯åè®® è®¤è¯æ‰©å±•: æ”¯æŒå¤šç§è®¤è¯åç«¯ 3. ä¼ä¸šçº§ç‰¹æ€§ é«˜å¯ç”¨: é›†ç¾¤ã€è”é‚¦ã€åˆ†ç‰‡æ”¯æŒ å®‰å…¨æ€§: å¤šç§è®¤è¯ã€æˆæƒã€åŠ å¯†æœºåˆ¶ ç›‘æ§: å…¨é¢çš„ç›‘æ§å’Œè¯Šæ–­å·¥å…· ç®¡ç†: å®Œå–„çš„ç®¡ç†ç•Œé¢å’Œ CLI å·¥å…· 4. ç°ä»£åŒ–æŠ€æœ¯æ ˆ ä¸€è‡´æ€§: åŸºäº Raft ç®—æ³•çš„å¼ºä¸€è‡´æ€§ æ€§èƒ½: é«˜æ€§èƒ½æ—¥å¿—å­˜å‚¨å’Œæ‰¹å¤„ç† äº‘åŸç”Ÿ: æ”¯æŒå®¹å™¨åŒ–å’Œäº‘ç¯å¢ƒéƒ¨ç½² æ ‡å‡†åŒ–: éµå¾ªè¡Œä¸šæ ‡å‡†å’Œæœ€ä½³å®è·µ æ€»ç»“RabbitMQ 4.0.5 çš„ 86 ä¸ªä¾èµ–æ¨¡å—å…±åŒæ„æˆäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜å¼‚ã€é«˜åº¦å¯æ‰©å±•çš„ä¼ä¸šçº§æ¶ˆæ¯ä»£ç†ç³»ç»Ÿã€‚è¿™äº›æ¨¡å—æŒ‰åŠŸèƒ½å¯åˆ†ä¸ºï¼š åˆ†ç±» æ¨¡å—æ•°é‡ ä»£è¡¨æ¨¡å— æ ¸å¿ƒæ¶æ„ 3 rabbit, rabbit_common, amqp_client åˆ†å¸ƒå¼å­˜å‚¨ 4 ra, osiris, khepri, khepri_mnesia_migration åè®®æ”¯æŒ 5 rabbitmq_mqtt, rabbitmq_stomp, rabbitmq_stream ç®¡ç†ç›‘æ§ 5 rabbitmq_management, rabbitmq_prometheus, rabbitmq_cli è®¤è¯æˆæƒ 5 rabbitmq_auth_backend_oauth2, rabbitmq_auth_backend_ldap é›†ç¾¤å‘ç° 5 rabbitmq_peer_discovery_k8s, rabbitmq_peer_discovery_consul äº¤æ¢å™¨æ’ä»¶ 5 rabbitmq_consistent_hash_exchange, rabbitmq_random_exchange è”é‚¦å¤åˆ¶ 6 rabbitmq_federation, rabbitmq_shovel Webç½‘ç»œ 10 cowboy, ranch, rabbitmq_web_dispatch å®‰å…¨åŠ å¯† 4 jose, credentials_obfuscation å·¥å…·å®ç”¨ 10 cuttlefish, recon, observer_cli å…¶ä»–è¾…åŠ© 24 aten, gen_batch_server, horus è¿™ç§ç²¾å¿ƒè®¾è®¡çš„æ¨¡å—åŒ–æ¶æ„ä½“ç°äº† RabbitMQ åœ¨æ¶ˆæ¯ä¸­é—´ä»¶é¢†åŸŸçš„æŠ€æœ¯é¢†å…ˆåœ°ä½ï¼Œä¸ºä¼ä¸šçº§åº”ç”¨æä¾›äº†å¯é ã€é«˜æ•ˆçš„æ¶ˆæ¯ä¼ é€’è§£å†³æ–¹æ¡ˆã€‚","categories":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/RabbitMQ/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"æ¶æ„åˆ†æ","slug":"æ¶æ„åˆ†æ","permalink":"https://hzsunzixiang.github.io/tags/%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90/"},{"name":"ä¾èµ–æ¨¡å—","slug":"ä¾èµ–æ¨¡å—","permalink":"https://hzsunzixiang.github.io/tags/%E4%BE%9D%E8%B5%96%E6%A8%A1%E5%9D%97/"}]},{"title":"RabbitMQ é˜Ÿåˆ—å£°æ˜æµç¨‹æ·±åº¦åˆ†æ","slug":"rabbitmq-rabbitmq-queue-declare-flow-analysis","date":"2026-01-16T16:00:00.000Z","updated":"2026-01-17T11:32:14.354Z","comments":true,"path":"2026/01/17/rabbitmq-rabbitmq-queue-declare-flow-analysis/","permalink":"https://hzsunzixiang.github.io/2026/01/17/rabbitmq-rabbitmq-queue-declare-flow-analysis/","excerpt":"","text":"RabbitMQ é˜Ÿåˆ—å£°æ˜æµç¨‹æ·±åº¦åˆ†æ1. æ¦‚è¿°æœ¬æ–‡æ¡£æ·±å…¥åˆ†æ RabbitMQ é˜Ÿåˆ—å£°æ˜ï¼ˆrabbit_amqqueue:declare/6ï¼‰çš„å®Œæ•´æ‰§è¡Œæµç¨‹ï¼ŒåŸºäºä»¥ä¸‹ç¤ºä¾‹å‘½ä»¤ï¼š 1234567891011121314(rabbit@debian-1)1&gt; rabbit_amqqueue:declare( rabbit_misc:r(&lt;&lt;&quot;/&quot;&gt;&gt;, queue, &lt;&lt;&quot;testqueue2&quot;&gt;&gt;), false, % Durable false, % AutoDelete [], % Args none, % Owner &lt;&lt;&quot;acting-user&quot;&gt;&gt; % ActingUser).%% è¿”å›ç»“æœ&#123;new, &#123;amqqueue, &#123;resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;testqueue2&quot;&gt;&gt;&#125;, false, false, none, [], &lt;0.862.0&gt;, [], [], [], undefined, undefined, [], [], live, 0, [], &lt;&lt;&quot;/&quot;&gt;&gt;, #&#123;user =&gt; &lt;&lt;&quot;acting-user&quot;&gt;&gt;&#125;&#125;&#125; 2. æµç¨‹æ¶æ„å›¾12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Queue Declaration Flow â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ rabbit_misc â”‚â”€â”€â”€â–¶â”‚ rabbit_amqqueue â”‚â”€â”€â”€â–¶â”‚ rabbit_queue_type â”‚ â”‚â”‚ â”‚ :r/3 â”‚ â”‚ :declare/6 â”‚ â”‚ :declare/2 â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚ â”‚ â”‚â”‚ â–¼ â–¼ â–¼ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ #resource â”‚ â”‚ amqqueue â”‚ â”‚ rabbit_classic_queue â”‚ â”‚â”‚ â”‚ record â”‚ â”‚ :new/9 â”‚ â”‚ :declare/2 â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚ â”‚â”‚ â–¼ â–¼ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ rabbit_policy â”‚ â”‚rabbit_amqqueue_sup_supâ”‚ â”‚â”‚ â”‚ :set/1 â”‚ â”‚:start_queue_process/2â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚ â”‚â”‚ â–¼ â–¼ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚rabbit_queue_ â”‚ â”‚ rabbit_amqqueue_sup â”‚ â”‚â”‚ â”‚ decorator:set â”‚ â”‚ :start_link/2 â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚â”‚ â–¼ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚rabbit_amqqueue_processâ”‚ â”‚â”‚ â”‚ :start_link/2 â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚â”‚ â–¼ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ gen_server2:call â”‚ â”‚â”‚ â”‚ &#123;init, new&#125; â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚â”‚ â–¼ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ rabbit_db_queue â”‚ â”‚â”‚ â”‚ :create_or_get/1 â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚ â”‚â”‚ â–¼ â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ Mnesia / Khepri â”‚ â”‚â”‚ â”‚ æŒä¹…åŒ–å­˜å‚¨ â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 3. è¯¦ç»†æµç¨‹åˆ†æ3.1 é˜¶æ®µä¸€ï¼šèµ„æºåç§°æ„å»º (rabbit_misc:r/3)æºç ä½ç½®deps/rabbit_common/src/rabbit_misc.erl:413-419 1234567r(#resource&#123;virtual_host = VHostPath&#125;, Kind, Name) -&gt; #resource&#123;virtual_host = VHostPath, kind = Kind, name = Name&#125;;r(VHostPath, Kind, Name) -&gt; #resource&#123;virtual_host = VHostPath, kind = Kind, name = Name&#125;.r(VHostPath, Kind) -&gt; #resource&#123;virtual_host = VHostPath, kind = Kind, name = &#x27;_&#x27;&#125;. åŠŸèƒ½è¯´æ˜ è¾“å…¥: &lt;&lt;&quot;/&quot;&gt;&gt;, queue, &lt;&lt;&quot;testqueue2&quot;&gt;&gt; è¾“å‡º: #resource{virtual_host = &lt;&lt;&quot;/&quot;&gt;&gt;, kind = queue, name = &lt;&lt;&quot;testqueue2&quot;&gt;&gt;} æ•°æ®ç»“æ„12345-record(resource, &#123; virtual_host :: binary(), % VHost åç§° kind :: queue | exchange, % èµ„æºç±»å‹ name :: binary() % èµ„æºåç§°&#125;). 3.2 é˜¶æ®µäºŒï¼šé˜Ÿåˆ—å£°æ˜å…¥å£ (rabbit_amqqueue:declare/6)æºç ä½ç½®deps/rabbit/src/rabbit_amqqueue.erl:201-250 1234567891011121314151617181920212223242526272829303132333435363738declare(QueueName, Durable, AutoDelete, Args, Owner, ActingUser) -&gt; declare(QueueName, Durable, AutoDelete, Args, Owner, ActingUser, node()).declare(QueueName = #resource&#123;virtual_host = VHost&#125;, Durable, AutoDelete, Args, Owner, ActingUser, Node) -&gt; %% 1. è·å–é»˜è®¤é˜Ÿåˆ—ç±»å‹ DQT = rabbit_vhost:default_queue_type(VHost, rabbit_queue_type:fallback()), %% 2. éªŒè¯å£°æ˜å‚æ•° ok = check_declare_arguments(QueueName, Args, DQT), %% 3. ç¡®å®šé˜Ÿåˆ—ç±»å‹ Type = get_queue_type(Args, DQT), %% 4. æ£€æŸ¥é˜Ÿåˆ—ç±»å‹æ˜¯å¦å¯ç”¨ case rabbit_queue_type:is_enabled(Type) of true -&gt; %% 5. åˆ›å»º amqqueue è®°å½• Q = amqqueue:new(QueueName, none, % pid (åˆå§‹ä¸º none) Durable, AutoDelete, Owner, Args, VHost, #&#123;user =&gt; ActingUser&#125;, Type), %% 6. æ£€æŸ¥å‚æ•°ç»„åˆæ˜¯å¦å…è®¸ case is_queue_args_combination_permitted(Q) of true -&gt; %% 7. å§”æ‰˜ç»™é˜Ÿåˆ—ç±»å‹æ¨¡å—å¤„ç† rabbit_queue_type:declare(Q, Node); false -&gt; &#123;protocol_error, internal_error, &quot;~ts&quot;, [Warning]&#125; end; false -&gt; &#123;protocol_error, internal_error, &quot;...&quot;, [...]&#125; end. å…³é”®æ­¥éª¤è¯¦è§£3.2.1 è·å–é»˜è®¤é˜Ÿåˆ—ç±»å‹1234567891011121314%% rabbit_vhost.erldefault_queue_type(VHost, DefaultQT) -&gt; case lookup(VHost) of &#123;ok, VHostRec&#125; -&gt; case vhost:get_default_queue_type(VHostRec) of undefined -&gt; DefaultQT; DQT -&gt; rabbit_queue_type:discover(DQT) end; &#123;error, _&#125; -&gt; DefaultQT end.%% rabbit_queue_type.erlfallback() -&gt; rabbit_classic_queue. 3.2.2 éªŒè¯å£°æ˜å‚æ•°123456789101112131415161718192021222324%% rabbit_amqqueue.erl:849-859check_declare_arguments(QueueName, Args0, DefaultQueueType) -&gt; %% æ³¨å…¥é»˜è®¤é˜Ÿåˆ—ç±»å‹ Args = maybe_inject_default_queue_type_shortcut_into_args(Args0, DefaultQueueType), %% æ£€æŸ¥ x-queue-type å‚æ•° check_arguments_type_and_value(QueueName, Args, [&#123;&lt;&lt;&quot;x-queue-type&quot;&gt;&gt;, fun check_queue_type/2&#125;]), %% è·å–é˜Ÿåˆ—ç±»å‹ Type = get_queue_type(Args), %% è·å–è¯¥ç±»å‹æ”¯æŒçš„å‚æ•° QueueTypeArgs = rabbit_queue_type:arguments(queue_arguments, Type), %% éªŒè¯å‚æ•°ç±»å‹å’Œå€¼ Validators = lists:filter( fun(&#123;Arg, _&#125;) -&gt; lists:member(Arg, QueueTypeArgs) end, declare_args()), check_arguments_type_and_value(QueueName, Args, Validators), %% æ£€æŸ¥æ— æ•ˆå‚æ•° InvalidArgs = rabbit_queue_type:arguments(queue_arguments) -- QueueTypeArgs, check_arguments_key(QueueName, Type, Args, InvalidArgs). 3.2.3 ç¡®å®šé˜Ÿåˆ—ç±»å‹1234567891011121314%% rabbit_amqqueue.erl:261-273get_queue_type([], DefaultQueueType) -&gt; rabbit_queue_type:discover(DefaultQueueType);get_queue_type(Args, DefaultQueueType) -&gt; case rabbit_misc:table_lookup(Args, &lt;&lt;&quot;x-queue-type&quot;&gt;&gt;) of undefined -&gt; rabbit_queue_type:discover(DefaultQueueType); &#123;longstr, undefined&#125; -&gt; rabbit_queue_type:discover(DefaultQueueType); &#123;longstr, &lt;&lt;&quot;undefined&quot;&gt;&gt;&#125; -&gt; rabbit_queue_type:discover(DefaultQueueType); &#123;_, V&#125; -&gt; rabbit_queue_type:discover(V) end. é˜Ÿåˆ—ç±»å‹æ˜ å°„å…³ç³»ï¼š å‚æ•°å€¼ æ¨¡å— classic rabbit_classic_queue quorum rabbit_quorum_queue stream rabbit_stream_queue 3.3 é˜¶æ®µä¸‰ï¼šåˆ›å»º amqqueue è®°å½• (amqqueue:new/9)æºç ä½ç½®deps/rabbit/src/amqqueue.erl:215-319 12345678910111213141516171819202122232425262728293031323334353637383940new(#resource&#123;kind = queue&#125; = Name, Pid, Durable, AutoDelete, Owner, Args, VHost, Options, Type) when (is_pid(Pid) orelse is_tuple(Pid) orelse Pid =:= none) andalso is_boolean(Durable) andalso is_boolean(AutoDelete) andalso (is_pid(Owner) orelse Owner =:= none) andalso is_list(Args) andalso (is_binary(VHost) orelse VHost =:= undefined) andalso is_map(Options) andalso is_atom(Type) -&gt; new_with_version( ?record_version, % amqqueue_v2 Name, Pid, Durable, AutoDelete, Owner, Args, VHost, Options, Type).new_with_version(?record_version, Name, Pid, Durable, AutoDelete, Owner, Args, VHost, Options, Type) -&gt; #amqqueue&#123;name = Name, durable = Durable, auto_delete = AutoDelete, arguments = Args, exclusive_owner = Owner, pid = Pid, vhost = VHost, options = Options, type = Type&#125;. amqqueue è®°å½•ç»“æ„12345678910111213141516171819202122232425262728-record(amqqueue, &#123; %% ä¸å¯å˜å­—æ®µ name :: rabbit_amqqueue:name() | ets:match_pattern(), durable :: boolean() | ets:match_pattern(), auto_delete :: boolean() | ets:match_pattern(), exclusive_owner = none :: pid() | none | ets:match_pattern(), arguments = [] :: rabbit_framing:amqp_table() | ets:match_pattern(), %% å¯å˜å­—æ®µ pid :: pid() | ra_server_id() | none | ets:match_pattern(), slave_pids = [], % ä¿ç•™å­—æ®µ sync_slave_pids = [], % ä¿ç•™å­—æ®µ recoverable_slaves = [], % ä¿ç•™å­—æ®µ %% ç­–ç•¥ç›¸å…³ policy :: proplists:proplist() | none | undefined | ets:match_pattern(), operator_policy :: proplists:proplist() | none | undefined, %% è¿è¡Œæ—¶çŠ¶æ€ gm_pids = [] :: [&#123;pid(), pid()&#125;] | none, decorators :: [atom()] | none | undefined, state = live :: atom(), policy_version = 0 :: non_neg_integer(), type_state = #&#123;&#125; :: map(), vhost :: binary() | undefined, options = #&#123;&#125; :: map(), type = rabbit_classic_queue :: module()&#125;). 3.4 é˜¶æ®µå››ï¼šé˜Ÿåˆ—ç±»å‹åˆ†å‘ (rabbit_queue_type:declare/2)æºç ä½ç½®deps/rabbit/src/rabbit_queue_type.erl:389-397 12345678910111213141516171819202122-spec declare(amqqueue:amqqueue(), node() | &#123;&#x27;ignore_location&#x27;, node()&#125;) -&gt; &#123;&#x27;new&#x27; | &#x27;existing&#x27; | &#x27;owner_died&#x27;, amqqueue:amqqueue()&#125; | &#123;&#x27;absent&#x27;, amqqueue:amqqueue(), rabbit_amqqueue:absent_reason()&#125; | &#123;protocol_error, Type :: atom(), Reason :: string(), Args :: term()&#125; | &#123;&#x27;error&#x27;, Type :: atom(), Reason :: string(), Args :: term()&#125; | &#123;&#x27;error&#x27;, Err :: term() &#125;.declare(Q0, Node) -&gt; %% 1. è®¾ç½®ç­–ç•¥å’Œè£…é¥°å™¨ Q = rabbit_queue_decorator:set(rabbit_policy:set(Q0)), %% 2. è·å–é˜Ÿåˆ—ç±»å‹æ¨¡å— Mod = amqqueue:get_type(Q), %% 3. æ£€æŸ¥é˜Ÿåˆ—é™åˆ¶ case check_queue_limits(Q) of ok -&gt; %% 4. è°ƒç”¨å…·ä½“ç±»å‹çš„ declare Mod:declare(Q, Node); Error -&gt; Error end. ç­–ç•¥è®¾ç½® (rabbit_policy:set/1)12345678910%% rabbit_policy.erl:94-105set(Q0) when ?is_amqqueue(Q0) -&gt; %% åŒ¹é…å½“å‰ VHost çš„ç­–ç•¥ Policy = match(Q0), OpPolicy = match_op(Q0), %% è®¾ç½®ç­–ç•¥åˆ°é˜Ÿåˆ—è®°å½• Q1 = amqqueue:set_policy(Q0, Policy), Q2 = amqqueue:set_operator_policy(Q1, OpPolicy), Q2. è£…é¥°å™¨è®¾ç½® (rabbit_queue_decorator:set/1)12345%% rabbit_queue_decorator.erl:42-44set(Q) when ?is_amqqueue(Q) -&gt; %% è·å–æ‰€æœ‰æ´»è·ƒçš„è£…é¥°å™¨ Decorators = [D || D &lt;- list(), D:active_for(Q)], amqqueue:set_decorators(Q, Decorators). é˜Ÿåˆ—é™åˆ¶æ£€æŸ¥1234567891011121314151617%% rabbit_queue_type.erl:876-895check_queue_limits(Q) -&gt; maybe ok ?= check_vhost_queue_limit(Q), ok ?= check_cluster_queue_limit(Q) end.check_vhost_queue_limit(Q) -&gt; #resource&#123;name = QueueName&#125; = amqqueue:get_name(Q), VHost = amqqueue:get_vhost(Q), case rabbit_vhost_limit:is_over_queue_limit(VHost) of false -&gt; ok; &#123;true, Limit&#125; -&gt; queue_limit_error(&quot;cannot declare queue &#x27;~ts&#x27;: &quot; &quot;queue limit in vhost &#x27;~ts&#x27; (~tp) is reached&quot;, [QueueName, VHost, Limit]) end. 3.5 é˜¶æ®µäº”ï¼šClassic é˜Ÿåˆ—å£°æ˜ (rabbit_classic_queue:declare/2)æºç ä½ç½®deps/rabbit/src/rabbit_classic_queue.erl:120-146 1234567891011121314151617181920212223242526272829303132333435declare(Q, Node) when ?amqqueue_is_classic(Q) -&gt; case validate_arguments(amqqueue:get_arguments(Q)) of ok -&gt; do_declare(Q, Node); Error -&gt; Error end.do_declare(Q, Node) when ?amqqueue_is_classic(Q) -&gt; QName = amqqueue:get_name(Q), VHost = amqqueue:get_vhost(Q), %% 1. ç¡®å®šé˜Ÿåˆ—æ‰€åœ¨èŠ‚ç‚¹ Node1 = case &#123;Node, rabbit_amqqueue:is_exclusive(Q)&#125; of &#123;&#123;ignore_location, Node0&#125;, _&#125; -&gt; Node0; &#123;_, true&#125; -&gt; Node; % ç‹¬å é˜Ÿåˆ—åœ¨å½“å‰èŠ‚ç‚¹ _ -&gt; %% ä½¿ç”¨ä½ç½®é€‰æ‹©ç­–ç•¥ &#123;Node0, _&#125; = rabbit_queue_location:select_leader_and_followers(Q, 1), Node0 end, %% 2. æ£€æŸ¥ VHost æ˜¯å¦å­˜åœ¨ case rabbit_vhost_sup_sup:get_vhost_sup(VHost, Node1) of &#123;ok, _&#125; -&gt; %% 3. å¯åŠ¨é˜Ÿåˆ—è¿›ç¨‹å¹¶ç­‰å¾…åˆå§‹åŒ– gen_server2:call( rabbit_amqqueue_sup_sup:start_queue_process(Node1, Q), &#123;init, new&#125;, infinity); &#123;error, Error&#125; -&gt; &#123;protocol_error, internal_error, &quot;Cannot declare a queue &#x27;~ts&#x27; on node &#x27;~ts&#x27;: ~255p&quot;, [rabbit_misc:rs(QName), Node1, Error]&#125; end. 3.6 é˜¶æ®µå…­ï¼šå¯åŠ¨é˜Ÿåˆ—è¿›ç¨‹3.6.1 å¯åŠ¨é˜Ÿåˆ—è¿›ç¨‹ (rabbit_amqqueue_sup_sup:start_queue_process/2)12345678910%% rabbit_amqqueue_sup_sup.erl:32-36start_queue_process(Node, Q) -&gt; #resource&#123;virtual_host = VHost&#125; = amqqueue:get_name(Q), %% æ‰¾åˆ° VHost çš„é˜Ÿåˆ—ç›‘ç£è€… &#123;ok, Sup&#125; = find_for_vhost(VHost, Node), %% å¯åŠ¨æ–°çš„é˜Ÿåˆ—å­è¿›ç¨‹ &#123;ok, _SupPid, QPid&#125; = supervisor:start_child(Sup, [Q, declare]), QPid. 3.6.2 é˜Ÿåˆ—ç›‘ç£è€…åˆå§‹åŒ– (rabbit_amqqueue_sup:start_link/2)12345678910111213141516171819202122232425%% rabbit_amqqueue_sup.erl:23-37start_link(Q, _StartMode) -&gt; %% åˆ›å»º Marker è¿›ç¨‹ç”¨äºåŒºåˆ†å¯åŠ¨å’Œé‡å¯ Marker = spawn_link(fun() -&gt; receive stop -&gt; ok end end), %% å®šä¹‰é˜Ÿåˆ—è¿›ç¨‹çš„å¯åŠ¨è§„èŒƒ StartMFA = &#123;rabbit_amqqueue_process, start_link, [Q, Marker]&#125;, ChildSpec = #&#123;id =&gt; rabbit_amqqueue, start =&gt; StartMFA, restart =&gt; transient, significant =&gt; true, shutdown =&gt; ?CLASSIC_QUEUE_WORKER_WAIT, type =&gt; worker, modules =&gt; [rabbit_amqqueue_process]&#125;, %% å¯åŠ¨ç›‘ç£è€… &#123;ok, SupPid&#125; = supervisor:start_link(?MODULE, []), %% å¯åŠ¨é˜Ÿåˆ—è¿›ç¨‹ &#123;ok, QPid&#125; = supervisor:start_child(SupPid, ChildSpec), %% æ¸…ç† Marker unlink(Marker), Marker ! stop, &#123;ok, SupPid, QPid&#125;. 3.7 é˜¶æ®µä¸ƒï¼šé˜Ÿåˆ—è¿›ç¨‹åˆå§‹åŒ– (rabbit_amqqueue_process)æºç ä½ç½®deps/rabbit/src/rabbit_amqqueue_process.erl:144-239 123456789101112131415161718192021222324%% å¯åŠ¨å…¥å£start_link(Q, Marker) -&gt; gen_server2:start_link(?MODULE, &#123;Q, Marker&#125;, []).%% åˆå§‹åŒ–init(&#123;Q, Marker&#125;) -&gt; case is_process_alive(Marker) of true -&gt; %% æ­£å¸¸å¯åŠ¨ init(Q); false -&gt; %% é‡å¯åœºæ™¯ QueueName = amqqueue:get_name(Q), &#123;ok, Q1&#125; = rabbit_amqqueue:lookup(QueueName), gen_server2:cast(self(), init), init(Q1) end;init(Q) -&gt; process_flag(trap_exit, true), ?store_proc_name(amqqueue:get_name(Q)), &#123;ok, init_state(amqqueue:set_pid(Q, self())), hibernate, &#123;backoff, ?HIBERNATE_AFTER_MIN, ?HIBERNATE_AFTER_MIN, ?DESIRED_HIBERNATE&#125;, ?MODULE&#125;. 3.7.1 åˆå§‹åŒ–çŠ¶æ€123456789101112131415161718%% rabbit_amqqueue_process.erl:165-180init_state(Q) -&gt; SingleActiveConsumerOn = case rabbit_misc:table_lookup( amqqueue:get_arguments(Q), &lt;&lt;&quot;x-single-active-consumer&quot;&gt;&gt;) of &#123;bool, true&#125; -&gt; true; _ -&gt; false end, State = #q&#123;q = Q, active_consumer = none, has_had_consumers = false, consumers = rabbit_queue_consumers:new(), senders = pmon:new(delegate), msg_id_to_channel = #&#123;&#125;, status = running, args_policy_version = 0, overflow = &#x27;drop-head&#x27;, single_active_consumer_on = SingleActiveConsumerOn&#125;, rabbit_event:init_stats_timer(State, #q.stats_timer). 3.7.2 å¤„ç† {init, new} è°ƒç”¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051%% handle_call ä¼šè·¯ç”±åˆ° init_it/3init_it(Recover, From, State = #q&#123;q = Q&#125;) when ?amqqueue_exclusive_owner_is(Q, none) -&gt; init_it2(Recover, From, State);init_it2(Recover, From, State = #q&#123;q = Q, backing_queue = undefined, backing_queue_state = undefined&#125;) -&gt; &#123;Barrier, TermsOrNew&#125; = recovery_status(Recover), %% å…³é”®ï¼šå†…éƒ¨å£°æ˜ï¼Œå†™å…¥æ•°æ®åº“ case rabbit_amqqueue:internal_declare(Q, Recover /= new) of &#123;Res, Q1&#125; when ?is_amqqueue(Q1) andalso (Res == created orelse Res == existing) -&gt; case matches(Recover, Q, Q1) of true -&gt; %% åˆå§‹åŒ– backing queue BQ = backing_queue_module(), BQS = bq_init(BQ, Q, TermsOrNew), %% å›å¤è°ƒç”¨è€… send_reply(From, &#123;new, Q&#125;), recovery_barrier(Barrier), %% å¤„ç†ç­–ç•¥å’Œå‚æ•° State1 = process_args_policy( State#q&#123;backing_queue = BQ, backing_queue_state = BQS&#125;), %% é€šçŸ¥è£…é¥°å™¨ notify_decorators(startup, State), %% å‘é€äº‹ä»¶é€šçŸ¥ rabbit_event:notify(queue_created, queue_created_infos(State1)), %% å‘é€ç»Ÿè®¡ä¿¡æ¯ rabbit_event:if_enabled(State1, #q.stats_timer, fun() -&gt; emit_stats(State1) end), noreply(State1); false -&gt; &#123;stop, normal, &#123;existing, Q1&#125;, State&#125; end; &#123;error, timeout&#125; -&gt; %% è¶…æ—¶å¤„ç† ...; Err -&gt; &#123;stop, normal, Err, State&#125; end. 3.8 é˜¶æ®µå…«ï¼šæ•°æ®åº“æŒä¹…åŒ– (rabbit_amqqueue:internal_declare/2)æºç ä½ç½®deps/rabbit/src/rabbit_amqqueue.erl:275-302 1234567891011121314151617181920212223242526272829-spec internal_declare(Queue, Recover) -&gt; Ret when Queue :: amqqueue:amqqueue(), Recover :: boolean(), Ret :: &#123;created | existing, amqqueue:amqqueue()&#125; | queue_absent() | rabbit_khepri:timeout_error().internal_declare(Q, Recover) -&gt; do_internal_declare(Q, Recover).%% æ¢å¤æ¨¡å¼do_internal_declare(Q0, true) -&gt; Q = amqqueue:set_state(Q0, live), case store_queue(Q) of ok -&gt; &#123;created, Q0&#125;; &#123;error, timeout&#125; = Err -&gt; Err end;%% æ–°å»ºæ¨¡å¼ (æˆ‘ä»¬çš„ç¤ºä¾‹èµ°è¿™æ¡è·¯å¾„)do_internal_declare(Q0, false) -&gt; %% 1. è®¾ç½®çŠ¶æ€ä¸º live %% 2. åº”ç”¨ç­–ç•¥ Q = rabbit_policy:set(amqqueue:set_state(Q0, live)), %% 3. è®¾ç½®è£…é¥°å™¨ Queue = rabbit_queue_decorator:set(Q), %% 4. å†™å…¥æ•°æ®åº“ rabbit_db_queue:create_or_get(Queue). æ•°æ®åº“æ“ä½œ (rabbit_db_queue:create_or_get/1)12345678910111213141516171819202122232425262728293031323334353637383940414243%% rabbit_db_queue.erl:895-930create_or_get(Q) -&gt; rabbit_khepri:handle_fallback( #&#123;mnesia =&gt; fun() -&gt; create_or_get_in_mnesia(Q) end, khepri =&gt; fun() -&gt; create_or_get_in_khepri(Q) end &#125;).%% Mnesia å®ç°create_or_get_in_mnesia(Q) -&gt; DurableQ = amqqueue:reset_decorators(Q), QueueName = amqqueue:get_name(Q), rabbit_mnesia:execute_mnesia_transaction( fun () -&gt; case mnesia:wread(&#123;?MNESIA_TABLE, QueueName&#125;) of [] -&gt; %% é˜Ÿåˆ—ä¸å­˜åœ¨ case get_durable_in_mnesia_tx(QueueName) of &#123;error, not_found&#125; -&gt; %% åˆ›å»ºæ–°é˜Ÿåˆ— set_in_mnesia_tx(DurableQ, Q), &#123;created, Q&#125;; &#123;ok, QRecord&#125; -&gt; %% å­˜åœ¨æŒä¹…åŒ–è®°å½•ä½†è¿è¡Œæ—¶ä¸å­˜åœ¨ &#123;absent, QRecord, nodedown&#125; end; [ExistingQ] -&gt; %% é˜Ÿåˆ—å·²å­˜åœ¨ &#123;existing, ExistingQ&#125; end end).%% Khepri å®ç°create_or_get_in_khepri(Q) -&gt; QueueName = amqqueue:get_name(Q), Path = khepri_queue_path(QueueName), case rabbit_khepri:adv_create(Path, Q) of &#123;error, &#123;khepri, mismatching_node, #&#123;node_props := #&#123;data := ExistingQ&#125;&#125;&#125;&#125; -&gt; &#123;existing, ExistingQ&#125;; &#123;ok, _&#125; -&gt; &#123;created, Q&#125;; Error -&gt; Error end. 4. è¿›ç¨‹ç›‘ç£æ ‘ç»“æ„123456rabbit_supâ”œâ”€â”€ rabbit_vhost_sup_supâ”‚ â””â”€â”€ rabbit_vhost_sup (per VHost)â”‚ â””â”€â”€ rabbit_amqqueue_sup_supâ”‚ â””â”€â”€ rabbit_amqqueue_sup (per Queue)â”‚ â””â”€â”€ rabbit_amqqueue_process (é˜Ÿåˆ—å·¥ä½œè¿›ç¨‹) 1234567891011121314151617181920212223 rabbit_sup â”‚ â–¼ rabbit_vhost_sup_sup â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ â–¼ rabbit_vhost_sup rabbit_vhost_sup ... (vhost: /) (vhost: test) â”‚ â–¼rabbit_amqqueue_sup_sup â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ â–¼rabbit_amqqueue_sup rabbit_amqqueue_sup ... (testqueue1) (testqueue2) â”‚ â”‚ â–¼ â–¼rabbit_amqqueue_ rabbit_amqqueue_ process process &lt;0.861.0&gt; &lt;0.862.0&gt; 5. è¿”å›ç»“æœè§£æ123456789101112131415161718&#123;new, &#123;amqqueue, &#123;resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;testqueue2&quot;&gt;&gt;&#125;, false, % durable false, % auto_delete none, % exclusive_owner [], % arguments &lt;0.862.0&gt;, % pid (é˜Ÿåˆ—è¿›ç¨‹) [], % slave_pids (ä¿ç•™) [], % sync_slave_pids (ä¿ç•™) [], % recoverable_slaves (ä¿ç•™) undefined, % policy undefined, % operator_policy [], % gm_pids (ä¿ç•™) [], % decorators live, % state 0, % policy_version [], % type_state &lt;&lt;&quot;/&quot;&gt;&gt;, % vhost #&#123;user =&gt; &lt;&lt;&quot;acting-user&quot;&gt;&gt;&#125;&#125;&#125; % options å­—æ®µ å€¼ è¯´æ˜ ç»“æœç±»å‹ new æ–°åˆ›å»ºçš„é˜Ÿåˆ— name {resource,&lt;&lt;&quot;/&quot;&gt;&gt;,queue,&lt;&lt;&quot;testqueue2&quot;&gt;&gt;} é˜Ÿåˆ—èµ„æºæ ‡è¯† durable false éæŒä¹…åŒ–é˜Ÿåˆ— auto_delete false ä¸è‡ªåŠ¨åˆ é™¤ exclusive_owner none éç‹¬å é˜Ÿåˆ— arguments [] æ— é¢å¤–å‚æ•° pid &lt;0.862.0&gt; é˜Ÿåˆ—è¿›ç¨‹ PID state live è¿è¡ŒçŠ¶æ€ vhost &lt;&lt;&quot;/&quot;&gt;&gt; æ‰€å± VHost options #{user =&gt; &lt;&lt;&quot;acting-user&quot;&gt;&gt;} æ“ä½œç”¨æˆ· 6. å…³é”®æ•°æ®æµå›¾12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758è¾“å…¥å‚æ•° â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ rabbit_misc:r(&lt;&lt;&quot;/&quot;&gt;&gt;, queue, &lt;&lt;&quot;testqueue2&quot;&gt;&gt;) â”‚â”‚ =&gt; #resource&#123;virtual_host = &lt;&lt;&quot;/&quot;&gt;&gt;, â”‚â”‚ kind = queue, â”‚â”‚ name = &lt;&lt;&quot;testqueue2&quot;&gt;&gt;&#125; â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ rabbit_amqqueue:declare/6 â”‚â”‚ 1. check_declare_arguments/3 âœ“ â”‚â”‚ 2. get_queue_type/2 =&gt; rabbit_classic_queue â”‚â”‚ 3. amqqueue:new/9 =&gt; #amqqueue&#123;...&#125; â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ rabbit_queue_type:declare/2 â”‚â”‚ 1. rabbit_policy:set/1 =&gt; åº”ç”¨ç­–ç•¥ â”‚â”‚ 2. rabbit_queue_decorator:set/1 =&gt; è®¾ç½®è£…é¥°å™¨ â”‚â”‚ 3. check_queue_limits/1 âœ“ â”‚â”‚ 4. Mod:declare/2 =&gt; rabbit_classic_queue:declare/2 â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ rabbit_classic_queue:declare/2 â”‚â”‚ 1. validate_arguments/1 âœ“ â”‚â”‚ 2. select_leader_and_followers/2 =&gt; é€‰æ‹©èŠ‚ç‚¹ â”‚â”‚ 3. rabbit_amqqueue_sup_sup:start_queue_process/2 â”‚â”‚ 4. gen_server2:call(&#123;init, new&#125;, infinity) â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ rabbit_amqqueue_process â”‚â”‚ 1. init/1 =&gt; åˆå§‹åŒ–è¿›ç¨‹çŠ¶æ€ â”‚â”‚ 2. handle_call(&#123;init, new&#125;, ...) =&gt; init_it2/3 â”‚â”‚ 3. rabbit_amqqueue:internal_declare/2 â”‚â”‚ 4. rabbit_db_queue:create_or_get/1 â”‚â”‚ 5. åˆå§‹åŒ– backing_queue â”‚â”‚ 6. å‘é€ queue_created äº‹ä»¶ â”‚â”‚ 7. è¿”å› &#123;new, Q&#125; â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ rabbit_db_queue:create_or_get/1 â”‚â”‚ Mnesia: mnesia:wread + mnesia:write â”‚â”‚ Khepri: rabbit_khepri:adv_create â”‚â”‚ =&gt; &#123;created, Q&#125; | &#123;existing, Q&#125; â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼è¿”å›ç»“æœ: &#123;new, #amqqueue&#123;...&#125;&#125; 7. æ—¶åºå›¾123456789101112131415161718192021222324252627282930313233343536373839Client rabbit_amqqueue rabbit_queue_type rabbit_classic_queue â”‚ â”‚ â”‚ â”‚ â”‚ declare/6 â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ check_arguments â”‚ â”‚ â”‚ â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ amqqueue:new/9 â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ declare/2 â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ declare/2 â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚rabbit_classic_queue rabbit_amqqueue_sup_sup rabbit_amqqueue_process rabbit_db_queue â”‚ â”‚ â”‚ â”‚ â”‚ start_queue_process â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ supervisor:start_child â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ gen_server2:call â”‚ â”‚ â”‚ â”‚ &#123;init, new&#125; â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ â”‚ internal_declare â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚ create_or_get â”‚ â”‚ â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ â”‚ â”‚ â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚ â”‚ &#123;created, Q&#125; â”‚ â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚ â”‚ &#123;new, Q&#125; â”‚ â”‚ â”‚ 8. é˜Ÿåˆ—ç±»å‹å¯¹æ¯” ç‰¹æ€§ Classic Queue Quorum Queue Stream Queue æ¨¡å— rabbit_classic_queue rabbit_quorum_queue rabbit_stream_queue å­˜å‚¨ rabbit_variable_queue Ra (Raft) Osiris æŒä¹…åŒ– å¯é€‰ å¼ºåˆ¶ å¼ºåˆ¶ å¤åˆ¶ ä¸æ”¯æŒ æ”¯æŒ (Raft) æ”¯æŒ å£°æ˜æµç¨‹ gen_server2:call ra:start_cluster rabbit_stream_coordinator 9. é”™è¯¯å¤„ç†9.1 å¸¸è§é”™è¯¯ç±»å‹ é”™è¯¯ åŸå›  å¤„ç† {existing, Q} é˜Ÿåˆ—å·²å­˜åœ¨ è¿”å›ç°æœ‰é˜Ÿåˆ— {absent, Q, nodedown} èŠ‚ç‚¹å®•æœº è¿”å›ç¼ºå¸­çŠ¶æ€ {error, timeout} æ•°æ®åº“è¶…æ—¶ è¿”å›è¶…æ—¶é”™è¯¯ {protocol_error, ...} å‚æ•°éªŒè¯å¤±è´¥ è¿”å›åè®®é”™è¯¯ 9.2 é˜Ÿåˆ—é™åˆ¶æ£€æŸ¥1234567891011121314%% VHost é˜Ÿåˆ—æ•°é‡é™åˆ¶check_vhost_queue_limit(Q) -&gt; case rabbit_vhost_limit:is_over_queue_limit(VHost) of false -&gt; ok; &#123;true, Limit&#125; -&gt; queue_limit_error(...) end.%% é›†ç¾¤é˜Ÿåˆ—æ•°é‡é™åˆ¶check_cluster_queue_limit(Q) -&gt; case rabbit_misc:get_env(rabbit, cluster_queue_limit, infinity) of infinity -&gt; ok; Limit when Count &gt;= Limit -&gt; queue_limit_error(...); _ -&gt; ok end. 10. æ€»ç»“10.1 å®Œæ•´è°ƒç”¨é“¾12345678910111213141516171819202122232425262728293031323334353637rabbit_misc:r/3 â†“rabbit_amqqueue:declare/6 â†“rabbit_amqqueue:declare/7 â†“ â”œâ”€â”€ check_declare_arguments/3 â”œâ”€â”€ get_queue_type/2 â”œâ”€â”€ amqqueue:new/9 â””â”€â”€ rabbit_queue_type:declare/2 â†“ â”œâ”€â”€ rabbit_policy:set/1 â”œâ”€â”€ rabbit_queue_decorator:set/1 â”œâ”€â”€ check_queue_limits/1 â””â”€â”€ rabbit_classic_queue:declare/2 â†“ â”œâ”€â”€ validate_arguments/1 â”œâ”€â”€ rabbit_queue_location:select_leader_and_followers/2 â”œâ”€â”€ rabbit_amqqueue_sup_sup:start_queue_process/2 â”‚ â†“ â”‚ â””â”€â”€ supervisor:start_child/2 â”‚ â†“ â”‚ â””â”€â”€ rabbit_amqqueue_sup:start_link/2 â”‚ â†“ â”‚ â””â”€â”€ rabbit_amqqueue_process:start_link/2 â””â”€â”€ gen_server2:call(&#123;init, new&#125;, infinity) â†“ â””â”€â”€ rabbit_amqqueue_process:init_it2/3 â†“ â”œâ”€â”€ rabbit_amqqueue:internal_declare/2 â”‚ â†“ â”‚ â””â”€â”€ rabbit_db_queue:create_or_get/1 â”‚ â†“ â”‚ â””â”€â”€ Mnesia/Khepri å†™å…¥ â”œâ”€â”€ bq_init/3 (backing queue) â”œâ”€â”€ notify_decorators/2 â””â”€â”€ rabbit_event:notify(queue_created, ...) 10.2 å…³é”®æ¨¡å—èŒè´£ æ¨¡å— èŒè´£ rabbit_misc é€šç”¨å·¥å…·å‡½æ•°ï¼Œèµ„æºåç§°æ„å»º rabbit_amqqueue é˜Ÿåˆ—ç®¡ç† API å…¥å£ rabbit_queue_type é˜Ÿåˆ—ç±»å‹æŠ½è±¡å±‚ï¼Œåˆ†å‘åˆ°å…·ä½“å®ç° rabbit_classic_queue Classic é˜Ÿåˆ—ç±»å‹å®ç° rabbit_amqqueue_sup_sup é˜Ÿåˆ—ç›‘ç£è€…çš„ç›‘ç£è€… rabbit_amqqueue_sup å•ä¸ªé˜Ÿåˆ—çš„ç›‘ç£è€… rabbit_amqqueue_process é˜Ÿåˆ—å·¥ä½œè¿›ç¨‹ (gen_server2) rabbit_db_queue é˜Ÿåˆ—æ•°æ®åº“æ“ä½œ (Mnesia&#x2F;Khepri) rabbit_policy ç­–ç•¥åŒ¹é…å’Œåº”ç”¨ rabbit_queue_decorator é˜Ÿåˆ—è£…é¥°å™¨ç®¡ç† amqqueue é˜Ÿåˆ—è®°å½•å®šä¹‰å’Œæ“ä½œ 11. å‚è€ƒæºæ–‡ä»¶ æ–‡ä»¶ ä»£ç è¡Œæ•° è¯´æ˜ rabbit_amqqueue.erl 2142 é˜Ÿåˆ—ç®¡ç†ä¸»æ¨¡å— rabbit_queue_type.erl ~900 é˜Ÿåˆ—ç±»å‹æŠ½è±¡å±‚ rabbit_classic_queue.erl ~600 Classic é˜Ÿåˆ—å®ç° rabbit_amqqueue_process.erl ~1500 é˜Ÿåˆ—å·¥ä½œè¿›ç¨‹ rabbit_amqqueue_sup_sup.erl 94 é˜Ÿåˆ—ç›‘ç£è€…ç®¡ç† rabbit_amqqueue_sup.erl 49 å•é˜Ÿåˆ—ç›‘ç£è€… rabbit_db_queue.erl ~1000 æ•°æ®åº“æ“ä½œ amqqueue.erl ~500 é˜Ÿåˆ—è®°å½•å®šä¹‰ rabbit_policy.erl ~500 ç­–ç•¥ç®¡ç† rabbit_misc.erl ~1500 é€šç”¨å·¥å…·","categories":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/RabbitMQ/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"https://hzsunzixiang.github.io/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"},{"name":"é˜Ÿåˆ—ç®¡ç†","slug":"é˜Ÿåˆ—ç®¡ç†","permalink":"https://hzsunzixiang.github.io/tags/%E9%98%9F%E5%88%97%E7%AE%A1%E7%90%86/"}]},{"title":"Erlang Trace è°ƒè¯•æŠ€æœ¯è¯¦è§£","slug":"erlang-erlang-trace-debugging-guide","date":"2026-01-16T15:00:00.000Z","updated":"2026-01-17T10:59:55.386Z","comments":true,"path":"2026/01/16/erlang-erlang-trace-debugging-guide/","permalink":"https://hzsunzixiang.github.io/2026/01/16/erlang-erlang-trace-debugging-guide/","excerpt":"","text":"Erlang Trace è°ƒè¯•æŠ€æœ¯è¯¦è§£æ¦‚è¿°ä¸ C&#x2F;C++ çš„ GDB å•æ­¥è°ƒè¯•å’Œ Java IDEï¼ˆEclipse&#x2F;IntelliJ IDEAï¼‰çš„æ–­ç‚¹è°ƒè¯•ä¸åŒï¼ŒErlang é‡‡ç”¨åŸºäºè¿›ç¨‹çš„ trace æœºåˆ¶è¿›è¡Œè°ƒè¯•ã€‚æœ¬æ–‡æ·±å…¥ä»‹ç» Erlang çš„ trace è°ƒè¯•æŠ€æœ¯ï¼Œè¿™æ˜¯ RabbitMQ æºç åˆ†æçš„é‡è¦å·¥å…·ã€‚ å‚è€ƒèµ„æ–™æ¨èä¹¦ç± Erlang in Anger - ç”Ÿäº§ç¯å¢ƒ Erlang è°ƒè¯•å®æˆ˜æŒ‡å— Erlang Programming - Francesco Cesarini, Simon Thompson æŠ€æœ¯æ–‡æ¡£ dbg.pdf - Erlang Factory æ¼”è®² Declarative debugging of concurrent Erlang programs Trace Analysis of Erlang Programs Profiling and Tracing for all with Xprof Erlang è°ƒè¯•å·¥å…·æ€»è§ˆErlang æä¾›äº†å¤šå±‚æ¬¡çš„è°ƒè¯•å·¥å…·ï¼š å·¥å…· å±‚çº§ ç‰¹ç‚¹ erlang:trace/3 åº•å±‚ BIF æœ€åŸºç¡€ï¼Œæ‰€æœ‰å·¥å…·çš„åŸºç¡€ erlang:trace_pattern/3 åº•å±‚ BIF å‡½æ•°è°ƒç”¨è¿½è¸ª dbg æ ‡å‡†åº“ åŸºäº trace çš„å°è£…ï¼Œæ›´æ˜“ç”¨ redbug ç¬¬ä¸‰æ–¹ ç”Ÿäº§ç¯å¢ƒå®‰å…¨çš„è¿½è¸ªå·¥å…· recon_trace ç¬¬ä¸‰æ–¹ ä¸“æ³¨å‡½æ•°è°ƒç”¨è¿½è¸ª Trace åŸºç¡€æ¦‚å¿µå¯è¿½è¸ªçš„äº‹ä»¶ç±»å‹Trace å¯ä»¥è¿½è¸ªä¸‰å¤§ç±»äº‹ä»¶ï¼š äº‹ä»¶ç±»å‹ å·¥å…· Trace Flag è¿›ç¨‹ç›¸å…³æ´»åŠ¨å’Œæ¶ˆæ¯ä¼ é€’ trace, dbg, redbug all, send, &#39;receive&#39;, procs, running åƒåœ¾å›æ”¶å’Œå†…å­˜ä½¿ç”¨ trace, dbg, redbug garbage_collection, timestamp å…¨å±€å’Œæœ¬åœ°å‡½æ•°è°ƒç”¨ trace + trace_pattern, dbg, recon_trace call, arity, return_to Trace æ¶ˆæ¯æ ¼å¼è·Ÿè¸ªäº‹ä»¶ä»¥æ¶ˆæ¯å½¢å¼å‘é€ï¼š 1&#123;trace, Pid, Tag, Data1 [,Data2]&#125; å…¶ä¸­ [,Data2] æ˜¯å¯é€‰å­—æ®µï¼Œä¾èµ–äºè·Ÿè¸ªæ¶ˆæ¯ç±»å‹ã€‚ erlang:trace&#x2F;3 API è¯¦è§£åŸºæœ¬è¯­æ³•1erlang:trace(PidSpec, Bool, TraceFlags) -&gt; integer() PidSpec: è¦è¿½è¸ªçš„è¿›ç¨‹ï¼ˆall, new, existing, Pidï¼‰ Bool: true å¯ç”¨è¿½è¸ªï¼Œfalse ç¦ç”¨ TraceFlags: è¿½è¸ªæ ‡å¿—åˆ—è¡¨ è¿”å›å€¼: è¢«è¿½è¸ªçš„è¿›ç¨‹æ•°é‡ é‡è¦æ³¨æ„äº‹é¡¹ Tracer è¿›ç¨‹ä¸èƒ½è¢«è¿½è¸ª 12%% é”™è¯¯ï¼štracer ä¸èƒ½è¿½è¸ªè‡ªå·±erlang:trace(self(), true, [send]). %% badarg error æŒ‡å®šå…¶ä»–è¿›ç¨‹æ¥æ”¶è¿½è¸ªæ¶ˆæ¯ 12%% å°†è¿½è¸ªæ¶ˆæ¯å‘é€åˆ°æŒ‡å®šè¿›ç¨‹erlang:trace(all, true, [send, &#123;tracer, TracerPid&#125;]). ç»ˆç«¯éœ€è¦ flush() æŸ¥çœ‹æ¶ˆæ¯ 123%% è¿½è¸ªæ¶ˆæ¯åœ¨ mailbox ä¸­ï¼Œéœ€è¦ flush æ˜¾ç¤º1&gt; erlang:trace(Pid, true, [send]).2&gt; flush(). è¿›ç¨‹å’Œæ¶ˆæ¯è¿½è¸ªsend å’Œ â€˜receiveâ€™ è¿½è¸ªsend è¿½è¸ª123456%% å¯ç”¨å‘é€è¿½è¸ªerlang:trace(Pid, true, [send]).%% è¿½è¸ªæ¶ˆæ¯æ ¼å¼&#123;trace, PidPort, send, Msg, To&#125;&#123;trace, PidPort, send_to_non_existing_process, Msg, To&#125; â€˜receiveâ€™ è¿½è¸ª12345%% å¯ç”¨æ¥æ”¶è¿½è¸ªï¼ˆæ³¨æ„ï¼š&#x27;receive&#x27; éœ€è¦å¼•å·ï¼Œå› ä¸ºæ˜¯ä¿ç•™å­—ï¼‰erlang:trace(Pid, true, [&#x27;receive&#x27;]).%% è¿½è¸ªæ¶ˆæ¯æ ¼å¼&#123;trace, PidPort, &#x27;receive&#x27;, Msg&#125; è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸè¿½è¸ª (procs)12345%% è¿½è¸ªè¿›ç¨‹åˆ›å»ºã€é€€å‡ºç­‰äº‹ä»¶erlang:trace(all, true, [procs]).%% é…åˆ set_on_spawn è¿½è¸ªæ–°åˆ›å»ºçš„è¿›ç¨‹erlang:trace(all, true, [set_on_spawn, procs]). running è¿½è¸ª12%% è¿½è¸ªè¿›ç¨‹è°ƒåº¦ï¼ˆè¿è¡Œ/æŒ‚èµ·ï¼‰erlang:trace(Pid, true, [running, procs]). åƒåœ¾å›æ”¶è¿½è¸ª12%% è¿½è¸ª GC äº‹ä»¶ï¼Œå¸¦æ—¶é—´æˆ³erlang:trace(Pid, true, [garbage_collection, timestamp]). æ³¨æ„: å ç”¨å†…å­˜å¤ªå°å¯èƒ½è§¦å‘ä¸åˆ°åƒåœ¾å›æ”¶ã€‚ å‡½æ•°è°ƒç”¨è¿½è¸ªå‡½æ•°è¿½è¸ªéœ€è¦ erlang:trace/3 å’Œ erlang:trace_pattern/3 é…åˆä½¿ç”¨ã€‚ åŸºæœ¬åŸç† å‡½æ•° ä½œç”¨ erlang:trace/3 å®šä¹‰è¿½è¸ªå“ªäº›è¿›ç¨‹ erlang:trace_pattern/3 å®šä¹‰è¿½è¸ªå“ªäº›å‡½æ•° åªæœ‰å½“è¢«è¿½è¸ªçš„è¿›ç¨‹è°ƒç”¨è¢«è¿½è¸ªçš„å‡½æ•°æ—¶ï¼Œæ‰ä¼šäº§ç”Ÿè¿½è¸ªäº‹ä»¶ã€‚ trace_pattern åŸºæœ¬è¯­æ³•1erlang:trace_pattern(MFA, MatchSpec, FlagList) -&gt; integer() MFA: {Module, Function, Arity} æˆ– {Module, &#39;_&#39;, &#39;_&#39;} MatchSpec: åŒ¹é…è§„åˆ™ï¼ˆtrue, [], æˆ–è¯¦ç»†è§„åˆ™ï¼‰ FlagList: [global], [local], [meta] ç­‰ åŸºæœ¬ç¤ºä¾‹12345678%% 1. å¯ç”¨è¿›ç¨‹çš„å‡½æ•°è°ƒç”¨è¿½è¸ªerlang:trace(all, true, [call]).%% 2. æŒ‡å®šè¿½è¸ªçš„å‡½æ•°ï¼ˆå¿…é¡»å…ˆ load moduleï¼‰erlang:trace_pattern(&#123;mymodule, myfunction, 2&#125;, true, [local]).%% æ³¨æ„ï¼šæ¨¡å—å¿…é¡»å…ˆåŠ è½½ï¼l(mymodule). %% æˆ– code:ensure_loaded(mymodule) global vs local é€‰é¡¹ è¯´æ˜ global é»˜è®¤å€¼ï¼Œåªè¿½è¸ªå¤–éƒ¨è°ƒç”¨ï¼ˆè·¨æ¨¡å—è°ƒç”¨ï¼‰ local è¿½è¸ªæ‰€æœ‰è°ƒç”¨ï¼ŒåŒ…æ‹¬æ¨¡å—å†…éƒ¨è°ƒç”¨ 12345%% è¿½è¸ªæ‰€æœ‰è°ƒç”¨ï¼ˆåŒ…æ‹¬å†…éƒ¨è°ƒç”¨ï¼‰erlang:trace_pattern(&#123;mymodule, &#x27;_&#x27;, &#x27;_&#x27;&#125;, true, [local]).%% åªè¿½è¸ªå¤–éƒ¨è°ƒç”¨erlang:trace_pattern(&#123;mymodule, &#x27;_&#x27;, &#x27;_&#x27;&#125;, true, [global]). return_to è¿½è¸ªè¿½è¸ªå‡½æ•°è¿”å›åˆ°å“ªé‡Œï¼ˆåªå¯¹ local æœ‰æ•ˆï¼‰ï¼š 123456%% å¯ç”¨ return_toerlang:trace(all, true, [call, return_to]).erlang:trace_pattern(&#123;mymodule, &#x27;_&#x27;, &#x27;_&#x27;&#125;, true, [local]).%% è¿½è¸ªæ¶ˆæ¯æ ¼å¼&#123;trace, Pid, return_to, &#123;M, F, A&#125;&#125; æ³¨æ„: return_to æ— æ³•è·å–å‡½æ•°è¿”å›å€¼ï¼ return_trace è·å–è¿”å›å€¼è¦è·å–å‡½æ•°è¿”å›å€¼ï¼Œä½¿ç”¨ MatchSpec ä¸­çš„ {return_trace}ï¼š 1234567%% ä½¿ç”¨ return_trace è·å–è¿”å›å€¼erlang:trace(all, true, [call]).erlang:trace_pattern(&#123;mymodule, myfunction, 1&#125;, [&#123;&#x27;_&#x27;, [], [&#123;return_trace&#125;]&#125;], [local]).%% è¿½è¸ªæ¶ˆæ¯æ ¼å¼&#123;trace, Pid, call, &#123;M, F, Args&#125;&#125;&#123;trace, Pid, return_from, &#123;M, F, Arity&#125;, ReturnValue&#125; arity é€‰é¡¹12345%% ä½¿ç”¨ arityï¼šåªæ˜¾ç¤ºå‚æ•°ä¸ªæ•°ï¼Œä¸æ˜¾ç¤ºå‚æ•°å†…å®¹erlang:trace(all, true, [call, arity]).%% ä¸ä½¿ç”¨ arityï¼šæ˜¾ç¤ºå®Œæ•´å‚æ•°erlang:trace(all, true, [call]). ä½¿ç”¨ arity å¯ä»¥å‡å°‘è¿½è¸ªæ¶ˆæ¯å¤§å°ã€‚ Match SpecificationsMatch Specifications æ˜¯å¼ºå¤§çš„è¿‡æ»¤å’Œæ“ä½œæœºåˆ¶ã€‚ åŸºæœ¬ç»“æ„1MatchSpec = [&#123;MatchHead, MatchConditions, MatchBody&#125;] ä½¿ç”¨ dbg:fun2ms&#x2F;1 ç”Ÿæˆ123%% ä½¿ç”¨ fun2ms ç”Ÿæˆ MatchSpec1&gt; dbg:fun2ms(fun([A, B]) when A &gt; 10 -&gt; return_trace() end).[&#123;[&#x27;$1&#x27;,&#x27;$2&#x27;],[&#123;&#x27;&gt;&#x27;,&#x27;$1&#x27;,10&#125;],[&#123;return_trace&#125;]&#125;] å¸¸ç”¨ MatchSpec ç¤ºä¾‹12345678%% è¿½è¸ªæ‰€æœ‰è°ƒç”¨å¹¶è¿”å›å€¼erlang:trace_pattern(&#123;M, F, A&#125;, [&#123;&#x27;_&#x27;, [], [&#123;return_trace&#125;]&#125;], [local]).%% è¿½è¸ªç‰¹å®šå‚æ•°å€¼erlang:trace_pattern(&#123;M, F, 1&#125;, [&#123;[&#x27;$1&#x27;], [&#123;&#x27;==&#x27;, &#x27;$1&#x27;, foo&#125;], []&#125;], [local]).%% è¿½è¸ªå¹¶æ‰“å°æ¶ˆæ¯erlang:trace_pattern(&#123;M, F, A&#125;, [&#123;&#x27;_&#x27;, [], [&#123;message, &#123;process_dump&#125;&#125;]&#125;], [local]). dbg æ¨¡å—dbg æ˜¯åŸºäº erlang:trace/3 çš„é«˜çº§å°è£…ï¼Œä½¿ç”¨æ›´ç®€ä¾¿ã€‚ åŸºæœ¬ä½¿ç”¨æµç¨‹1234567891011%% 1. å¯åŠ¨ tracerdbg:tracer().%% 2. è®¾ç½®è¿½è¸ªçš„è¿›ç¨‹dbg:p(all, c). %% all è¿›ç¨‹ï¼Œc = call%% 3. è®¾ç½®è¿½è¸ªçš„å‡½æ•°dbg:tpl(mymodule, myfunction, x). %% x = æ‰€æœ‰ arity%% 4. åœæ­¢è¿½è¸ªdbg:stop_clear(). å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ è¯´æ˜ dbg:tracer() å¯åŠ¨é»˜è®¤ tracer dbg:p(PidSpec, Flags) è®¾ç½®è¿›ç¨‹è¿½è¸ª dbg:tp(M, F, A, MS) è¿½è¸ªå…¨å±€å‡½æ•°è°ƒç”¨ dbg:tpl(M, F, A, MS) è¿½è¸ªæœ¬åœ°+å…¨å±€å‡½æ•°è°ƒç”¨ dbg:ctp(M, F, A) æ¸…é™¤è¿½è¸ªæ¨¡å¼ dbg:stop() åœæ­¢ tracer dbg:stop_clear() åœæ­¢å¹¶æ¸…é™¤æ‰€æœ‰è¿½è¸ª dbg:p&#x2F;2 çš„ Flags Flag è¯´æ˜ c call - å‡½æ•°è°ƒç”¨ s send - å‘é€æ¶ˆæ¯ r receive - æ¥æ”¶æ¶ˆæ¯ m messages - send + receive p procs - è¿›ç¨‹äº‹ä»¶ sos set_on_spawn sol set_on_link å®é™…ç¤ºä¾‹12345678910111213141516%% è¿½è¸ª lists:seq/2 çš„è°ƒç”¨1&gt; dbg:tracer().&#123;ok,&lt;0.90.0&gt;&#125;2&gt; dbg:p(all, c).&#123;ok,[&#123;matched,nonode@nohost,26&#125;]&#125;3&gt; dbg:tpl(lists, seq, x).&#123;ok,[&#123;matched,nonode@nohost,2&#125;]&#125;4&gt; lists:seq(1, 5).(&lt;0.84.0&gt;) call lists:seq(1,5)[1,2,3,4,5]5&gt; dbg:stop_clear().ok å¸¦è¿”å›å€¼çš„è¿½è¸ª12345678%% ä½¿ç”¨ dbg:fun2ms ç”Ÿæˆå¸¦ return_trace çš„ MatchSpec1&gt; dbg:tracer().2&gt; dbg:p(all, c).3&gt; dbg:tpl(lists, seq, dbg:fun2ms(fun(_) -&gt; return_trace() end)).4&gt; lists:seq(1, 3).(&lt;0.84.0&gt;) call lists:seq(1,3)(&lt;0.84.0&gt;) returned from lists:seq/2 -&gt; [1,2,3][1,2,3] recon_tracerecon_trace æ˜¯ç”Ÿäº§ç¯å¢ƒå®‰å…¨çš„è¿½è¸ªå·¥å…·ï¼Œæ¥è‡ª recon åº“ã€‚ ç‰¹ç‚¹ è‡ªåŠ¨é™åˆ¶è¿½è¸ªæ¶ˆæ¯æ•°é‡ï¼Œé˜²æ­¢ç³»ç»Ÿè¿‡è½½ åªèƒ½è¿½è¸ªå‡½æ•°è°ƒç”¨ï¼Œä¸èƒ½è¿½è¸ªæ¶ˆæ¯ ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨ åŸºæœ¬ä½¿ç”¨12345678%% è¿½è¸ª 10 æ¬¡è°ƒç”¨recon_trace:calls(&#123;lists, seq, 2&#125;, 10).%% å¸¦è¿”å›å€¼recon_trace:calls(&#123;lists, seq, 2&#125;, 10, [&#123;scope, local&#125;]).%% è¿½è¸ªç‰¹å®šè¿›ç¨‹recon_trace:calls(&#123;M, F, A&#125;, 10, [&#123;pid, Pid&#125;]). é‡è¦æç¤ºä½¿ç”¨ recon_trace å‰ï¼Œéœ€è¦é¢„åŠ è½½æ‰€æœ‰è¦è¿½è¸ªçš„æ¨¡å—ï¼š 123456%% åŠ è½½æ‰€æœ‰ beam æ–‡ä»¶å¯¹åº”çš„æ¨¡å—LP = fun() -&gt; [code:ensure_loaded(list_to_atom(filename:rootname(filename:basename(F)))) || P &lt;- code:get_path(), F &lt;- filelib:wildcard(P ++ &quot;/*.beam&quot;)] end.LP(). å®æˆ˜æŠ€å·§1. è¿½è¸ª RabbitMQ å‡½æ•°è°ƒç”¨123456%% è¿½è¸ª rabbit_channel æ¨¡å—1&gt; dbg:tracer().2&gt; dbg:p(all, c).3&gt; dbg:tpl(rabbit_channel, handle_cast, x).4&gt; %% æ‰§è¡Œç›¸å…³æ“ä½œ...5&gt; dbg:stop_clear(). 2. è¿½è¸ªæ¶ˆæ¯ä¼ é€’12345%% è¿½è¸ªç‰¹å®šè¿›ç¨‹çš„æ¶ˆæ¯1&gt; Pid = whereis(rabbit_reader).2&gt; erlang:trace(Pid, true, [send, &#x27;receive&#x27;]).3&gt; flush(). %% æŸ¥çœ‹è¿½è¸ªæ¶ˆæ¯4&gt; erlang:trace(Pid, false, [send, &#x27;receive&#x27;]). %% åœæ­¢è¿½è¸ª 3. ç”Ÿäº§ç¯å¢ƒå®‰å…¨è¿½è¸ª12345%% ä½¿ç”¨ recon_traceï¼Œé™åˆ¶ 100 æ¬¡è°ƒç”¨recon_trace:calls(&#123;rabbit_channel, handle_cast, &#x27;_&#x27;&#125;, 100).%% 10 ç§’åè‡ªåŠ¨åœæ­¢recon_trace:calls(&#123;rabbit_channel, handle_cast, &#x27;_&#x27;&#125;, &#123;100, 10000&#125;). 4. è¿½è¸ªç‰¹å®šå‚æ•°çš„è°ƒç”¨123%% åªè¿½è¸ªç¬¬ä¸€ä¸ªå‚æ•°ä¸º foo çš„è°ƒç”¨MS = dbg:fun2ms(fun([foo, _]) -&gt; return_trace() end).dbg:tpl(mymodule, myfunction, MS). å¸¸è§é—®é¢˜Q: ä¸ºä»€ä¹ˆ trace_pattern ä¸ç”Ÿæ•ˆï¼Ÿ æ¨¡å—æœªåŠ è½½ï¼šå…ˆæ‰§è¡Œ l(module) æˆ– code:ensure_loaded(module) åªä½¿ç”¨äº† trace æˆ– trace_pattern å…¶ä¸­ä¸€ä¸ªï¼šä¸¤è€…å¿…é¡»é…åˆä½¿ç”¨ ä½¿ç”¨äº† global ä½†è°ƒç”¨æ˜¯æ¨¡å—å†…éƒ¨è°ƒç”¨ï¼šæ”¹ç”¨ local Q: å¦‚ä½•è·å–å‡½æ•°è¿”å›å€¼ï¼Ÿä½¿ç”¨ return_trace MatchSpecï¼Œè€Œä¸æ˜¯ return_to flagï¼š 1erlang:trace_pattern(&#123;M, F, A&#125;, [&#123;&#x27;_&#x27;, [], [&#123;return_trace&#125;]&#125;], [local]). Q: ä¸ºä»€ä¹ˆçœ‹ä¸åˆ°è¿½è¸ªæ¶ˆæ¯ï¼Ÿ ç»ˆç«¯ä½œä¸º tracer æ—¶éœ€è¦ flush() tracer è¿›ç¨‹ä¸èƒ½è¿½è¸ªè‡ªå·± æ£€æŸ¥ trace å’Œ trace_pattern æ˜¯å¦éƒ½è®¾ç½®äº† Q: å¦‚ä½•è¿½è¸ªæ–°åˆ›å»ºçš„è¿›ç¨‹ï¼Ÿ12%% ä½¿ç”¨ set_on_spawnerlang:trace(all, true, [set_on_spawn, procs, call]). æ€»ç»“ åœºæ™¯ æ¨èå·¥å…· å¼€å‘ç¯å¢ƒå¿«é€Ÿè°ƒè¯• dbg ç”Ÿäº§ç¯å¢ƒå®‰å…¨è¿½è¸ª recon_trace ç²¾ç»†æ§åˆ¶ erlang:trace/3 + erlang:trace_pattern/3 æ¶ˆæ¯è¿½è¸ª erlang:trace/3 çš„ send&#x2F;&#39;receive&#39; è¿›ç¨‹è¿½è¸ª erlang:trace/3 çš„ procs æŒæ¡ Erlang trace æŠ€æœ¯æ˜¯æ·±å…¥ç†è§£ RabbitMQ ç­‰ Erlang ç³»ç»Ÿçš„å…³é”®ã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è¿›è¡Œé—®é¢˜æ’æŸ¥å’Œæ€§èƒ½åˆ†æã€‚ å‚è€ƒé“¾æ¥ Erlang trace&#x2F;3 å®˜æ–¹æ–‡æ¡£ Erlang trace_pattern&#x2F;3 å®˜æ–¹æ–‡æ¡£ Erlang dbg å®˜æ–¹æ–‡æ¡£ Match Specifications in Erlang Guide to Tracing in Erlang recon åº“æ–‡æ¡£","categories":[{"name":"technology","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"Erlang","slug":"technology/Erlang","permalink":"https://hzsunzixiang.github.io/categories/technology/Erlang/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"https://hzsunzixiang.github.io/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"},{"name":"è°ƒè¯•","slug":"è°ƒè¯•","permalink":"https://hzsunzixiang.github.io/tags/%E8%B0%83%E8%AF%95/"},{"name":"trace","slug":"trace","permalink":"https://hzsunzixiang.github.io/tags/trace/"},{"name":"dbg","slug":"dbg","permalink":"https://hzsunzixiang.github.io/tags/dbg/"}]},{"title":"RabbitMQ ç¼–è¯‘æ„å»ºå®Œå…¨æŒ‡å—","slug":"rabbitmq-rabbitmq-complete-build-guide","date":"2026-01-16T14:30:00.000Z","updated":"2026-01-16T14:41:31.149Z","comments":true,"path":"2026/01/16/rabbitmq-rabbitmq-complete-build-guide/","permalink":"https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-complete-build-guide/","excerpt":"","text":"RabbitMQ ç¼–è¯‘æ„å»ºå®Œå…¨æŒ‡å—æ¦‚è¿°åŸºäº RabbitMQ 4.0.5 æºç æ·±åº¦åˆ†æå’Œå®é™…æ„å»ºéªŒè¯ï¼Œæœ¬æ–‡æ¡£å…¨é¢è§£æå„ç§ç¼–è¯‘æ–¹å¼çš„æŠ€æœ¯åŸç†ã€å®ç°æœºåˆ¶å’Œæœ€ä½³å®è·µã€‚ å¿«é€Ÿå¯¹æ¯”è¡¨æ„å»ºå‘½ä»¤ å‘½ä»¤ ä½œç”¨ è¾“å‡ºæ ¼å¼ éƒ¨ç½²æ–¹å¼ ç¼–è¯‘æ—¶é—´ ç£ç›˜å ç”¨ é€‚ç”¨åœºæ™¯ make ç¼–è¯‘ æºç ç›®å½• + beam æ–‡ä»¶ å¼€å‘è°ƒè¯• æœ€å¿« ä¸­ç­‰ æœ¬åœ°å¼€å‘ã€è°ƒè¯• make dist æ‰“åŒ…æ–‡ä»¶ æ’ä»¶ç›®å½•ç»“æ„ ç›®å½•éƒ¨ç½² å¿« å¤§ ç”Ÿäº§ç¯å¢ƒã€æ’ä»¶å¼€å‘ make dist DIST_AS_EZS=true æ‰“åŒ…æˆ ez æ–‡ä»¶ .ez å‹ç¼©åŒ… æ’ä»¶å®‰è£… ä¸­ç­‰ å° æ’ä»¶åˆ†å‘ã€çƒ­åŠ è½½ make source-dist åˆ›å»ºæºç åŒ… tar.xz æºç å½’æ¡£ æºç åˆ†å‘ å¿« å° ç¦»çº¿æ„å»ºã€ç‰ˆæœ¬å‘å¸ƒ make package-generic-unix æ‰“åŒ…æˆ PACKAGE æ–‡ä»¶ tar.xz åŒ… è§£å‹å®‰è£… æ…¢ æœ€å° å®¹å™¨ã€è·¨å¹³å° make install å®‰è£…åˆ°ç³»ç»Ÿ ç³»ç»Ÿç›®å½• ç³»ç»Ÿå®‰è£… ä¸­ç­‰ ä¸­ç­‰ ç”Ÿäº§éƒ¨ç½² make install PREFIX=/opt/rabbitmq å®‰è£…åˆ°æŒ‡å®šç›®å½• è‡ªå®šä¹‰ç›®å½• è‡ªå®šä¹‰å®‰è£… ä¸­ç­‰ ä¸­ç­‰ è‡ªå®šä¹‰éƒ¨ç½²è·¯å¾„ å¼€å‘è°ƒè¯•å‘½ä»¤ å‘½ä»¤ ä½œç”¨ é€‚ç”¨åœºæ™¯ make run-broker å¯åŠ¨ RabbitMQ æœåŠ¡å™¨ï¼ˆå‰å°è¿è¡Œï¼‰ å¼€å‘è°ƒè¯•ã€æ—¥å¿—æŸ¥çœ‹ make run-broker PLUGINS=&quot;plugin_name&quot; å¯åŠ¨å¹¶åŠ è½½æŒ‡å®šæ’ä»¶ æ’ä»¶æµ‹è¯•ã€åŠŸèƒ½éªŒè¯ make shell è¿›å…¥ Erlang Shell ä»£ç è°ƒè¯•ã€æ¨¡å—æµ‹è¯• make run-background-broker åå°å¯åŠ¨ RabbitMQ è‡ªåŠ¨åŒ–æµ‹è¯• make run-node å¯åŠ¨è£¸ Erlang èŠ‚ç‚¹ï¼ˆæ—  RabbitMQï¼‰ Erlang è°ƒè¯• 1. make - åŸºç¡€ç¼–è¯‘æŠ€æœ¯åŸç†åŸºäº erlang.mk æ„å»ºç³»ç»Ÿï¼Œæ‰§è¡Œ Erlang&#x2F;OTP æ ‡å‡†ç¼–è¯‘æµç¨‹ã€‚ æ ¸å¿ƒå®ç°æœºåˆ¶123456789101112# æ¥æºï¼šMakefile (ç¬¬ 77 è¡Œ)include erlang.mk# æ¥æºï¼šerlang.mk æ ¸å¿ƒé€»è¾‘app:: deps $(PROJECT).d $(verbose) $(MAKE) --no-print-directory app-build# é»˜è®¤ç›®æ ‡ç»§æ‰¿è‡ª erlang.mk# ç¼–è¯‘æµç¨‹ï¼š# 1. ç¼–è¯‘ä¾èµ– (deps)# 2. ç¼–è¯‘æ ¸å¿ƒåº”ç”¨ (app) # 3. ç”Ÿæˆå¯åŠ¨è„šæœ¬ ç¼–è¯‘æµç¨‹1234567891011make â†“è§£æä¾èµ– â†“ç¼–è¯‘ deps/ â†“ç¼–è¯‘ .erl â†’ .beam â†“ç”Ÿæˆå¯åŠ¨è„šæœ¬ â†“åˆ›å»º sbin/ ç›®å½• å®é™…ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„1234567891011rabbitmq-server/â”œâ”€â”€ deps/ # ä¾èµ–æ¨¡å—â”‚ â”œâ”€â”€ rabbit/ebin/*.beam # æ ¸å¿ƒæ¨¡å—å­—èŠ‚ç â”‚ â”œâ”€â”€ rabbit_common/ebin/*.beam # å…¬å…±æ¨¡å—å­—èŠ‚ç â”‚ â””â”€â”€ */ebin/*.beam # å…¶ä»–æ’ä»¶å­—èŠ‚ç â”œâ”€â”€ sbin/ # å¯åŠ¨è„šæœ¬ (25 ä¸ªæ–‡ä»¶)â”‚ â”œâ”€â”€ rabbitmq-server # ä¸»æœåŠ¡å™¨è„šæœ¬â”‚ â”œâ”€â”€ rabbitmqctl # ç®¡ç†å·¥å…·â”‚ â”œâ”€â”€ rabbitmq-plugins # æ’ä»¶ç®¡ç†â”‚ â””â”€â”€ ... # å…¶ä»–ç®¡ç†è„šæœ¬â””â”€â”€ escript/ # Erlang è„šæœ¬ ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µå¼€å‘ç¯å¢ƒ123456789# 1. å¿«é€Ÿå¼€å‘è¿­ä»£make clean &amp;&amp; makesbin/rabbitmq-server# 2. å¢é‡ç¼–è¯‘ï¼ˆæ¨èï¼‰make # åªç¼–è¯‘ä¿®æ”¹çš„æ–‡ä»¶# 3. å¼€å‘è°ƒè¯•make shell # è¿›å…¥ Erlang shell æ€§èƒ½ç‰¹ç‚¹ ç¼–è¯‘æ—¶é—´: æœ€å¿«ï¼ˆæ”¯æŒå¢é‡ç¼–è¯‘ï¼‰ ç£ç›˜å ç”¨: ä¸­ç­‰ï¼ˆåŒ…å«æºç å’Œå­—èŠ‚ç ï¼‰ å†…å­˜ä½¿ç”¨: ä½ é€‚ç”¨åœºæ™¯: å¼€å‘è°ƒè¯•ã€æºç ä¿®æ”¹ã€æ€§èƒ½æµ‹è¯• 2. make dist - æ’ä»¶ç›®å½•åˆ†å‘æŠ€æœ¯åŸç†åŸºäº rabbitmq-dist.mk å®ç°æ’ä»¶æ‰“åŒ…æœºåˆ¶ï¼Œåˆ›å»ºæ ‡å‡†çš„ RabbitMQ æ’ä»¶ç›®å½•ç»“æ„ã€‚ æ ¸å¿ƒå®ç°æºç 1234567891011121314# æ¥æºï¼šdeps/rabbit_common/mk/rabbitmq-dist.mk (ç¬¬ 166 è¡Œ)dist:: $(ERLANG_MK_RECURSIVE_DEPS_LIST) all $(verbose) rm -rf $(DIST_DIR) $(verbose) mkdir -p $(DIST_DIR) $(gen_verbose) $(MAKE) --no-print-directory do-dist# æ’ä»¶ç›®å½•åˆ›å»ºé€»è¾‘ (ç¬¬ 48-54 è¡Œ)dist_$(1)_ez_dir = $$(if $(2),$(DIST_DIR)/$(1)-$(2), \\ $$(if $$(VERSION),$(DIST_DIR)/$(1)-$$(VERSION),$(DIST_DIR)/$(1)))ifeq ($(DIST_AS_EZS),)dist_$(1)_ez = $$(dist_$(1)_ez_dir) # ç›®å½•æ ¼å¼elsedist_$(1)_ez = $$(dist_$(1)_ez_dir).ez # EZ æ ¼å¼endif æ‰“åŒ…æµç¨‹è¯¦è§£ ç¼–è¯‘æ‰€æœ‰æ¨¡å— - ç¡®ä¿æ‰€æœ‰ .erl æ–‡ä»¶ç¼–è¯‘ä¸º .beam æ”¶é›†ä¾èµ– - å°†æ‰€æœ‰æ’ä»¶å’Œä¾èµ–æ”¶é›†åˆ° plugins/ ç›®å½• ç”Ÿæˆæ’ä»¶ç»“æ„ - æ¯ä¸ªæ’ä»¶åŒ…å« ebin/ã€priv/ ç­‰æ ‡å‡†ç›®å½• åˆ›å»ºå…ƒæ•°æ® - ç”Ÿæˆ .app æ–‡ä»¶æè¿°æ’ä»¶ä¿¡æ¯ å®é™…ç”Ÿæˆçš„ç›®å½•ç»“æ„1234567891011plugins/â”œâ”€â”€ rabbit-4.0.5/ # æ ¸å¿ƒæ¨¡å—ç›®å½•â”‚ â”œâ”€â”€ ebin/â”‚ â”‚ â”œâ”€â”€ rabbit.app # åº”ç”¨æè¿°æ–‡ä»¶â”‚ â”‚ â”œâ”€â”€ rabbit.beam # ç¼–è¯‘åçš„å­—èŠ‚ç â”‚ â”‚ â””â”€â”€ *.beam # å…¶ä»–æ¨¡å—å­—èŠ‚ç â”‚ â”œâ”€â”€ include/ # å¤´æ–‡ä»¶â”‚ â””â”€â”€ priv/ # ç§æœ‰èµ„æºâ”œâ”€â”€ rabbitmq_management-4.0.5/ # ç®¡ç†æ’ä»¶ç›®å½•â”œâ”€â”€ rabbitmq_prometheus-4.0.5/ # ç›‘æ§æ’ä»¶ç›®å½•â””â”€â”€ ... # å…¶ä»–æ’ä»¶ç›®å½• ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µç”Ÿäº§ç¯å¢ƒ12345678# 1. åˆ›å»ºå‘å¸ƒç‰ˆæœ¬make dist# 2. éªŒè¯æ’ä»¶ç»“æ„ls -la plugins/# 3. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒrsync -av plugins/ /opt/rabbitmq/plugins/ æ’ä»¶å¼€å‘12345# 1. å¼€å‘æ¨¡å¼make dist# 2. æ’ä»¶æµ‹è¯•make run-broker PLUGINS=&quot;plugin_name&quot; 3. make dist DIST_AS_EZS=true - EZ å‹ç¼©åŒ…åˆ†å‘æŠ€æœ¯åŸç†EZ æ ¼å¼æ˜¯ Erlang çš„æ ‡å‡†æ’ä»¶æ‰“åŒ…æ ¼å¼ï¼Œæœ¬è´¨ä¸Šæ˜¯é‡å‘½åçš„ ZIP æ–‡ä»¶ã€‚ æ ¸å¿ƒå®ç°é€»è¾‘12345678# æ¥æºï¼šdeps/rabbit_common/mk/rabbitmq-dist.mk (ç¬¬ 8-14 è¡Œ)# Set $(DIST_AS_EZS) to a non-empty value to enable the packaging of# plugins as .ez archives.ifeq ($(USE_RABBIT_BOOT_SCRIPT),)DIST_AS_EZS ?= # é»˜è®¤ä¸ºç©ºï¼ˆç›®å½•æ ¼å¼ï¼‰elseDIST_AS_EZS = # å¼ºåˆ¶ç›®å½•æ ¼å¼endif EZ æ–‡ä»¶ç”Ÿæˆæµç¨‹12345678910111213make dist DIST_AS_EZS=true â†“ç¼–è¯‘æ‰€æœ‰æ¨¡å— â†“æ”¶é›† ebin/ include/ priv/ â†“åˆ›å»ºä¸´æ—¶ç›®å½•ç»“æ„ â†“ZIP å‹ç¼© â†“é‡å‘½åä¸º .ez â†“ç§»åŠ¨åˆ° plugins/ å®é™…ç”Ÿæˆçš„ EZ æ–‡ä»¶ï¼ˆå·²éªŒè¯ï¼‰123456789plugins/â”œâ”€â”€ rabbit-4.0.5.ez # 3.38 MB - æ ¸å¿ƒæ¨¡å—â”œâ”€â”€ rabbit_common-4.0.5.ez # 770.91 KB - å…¬å…±æ¨¡å— â”œâ”€â”€ rabbitmq_management-4.0.5.ez # ç®¡ç†ç•Œé¢æ’ä»¶â”œâ”€â”€ rabbitmq_prometheus-4.0.5.ez # ç›‘æ§æ’ä»¶â”œâ”€â”€ amqp_client-4.0.5.ez # 332.75 KB - AMQP å®¢æˆ·ç«¯â”œâ”€â”€ cowboy-2.12.0.ez # 350.76 KB - HTTP æœåŠ¡å™¨â”œâ”€â”€ gun-1.3.3.ez # 109.35 KB - HTTP å®¢æˆ·ç«¯â””â”€â”€ ... # å…¶ä»–æ’ä»¶ EZ æ–‡ä»¶ EZ æ ¼å¼æ·±åº¦åˆ†æEZ æ–‡ä»¶å†…éƒ¨ç»“æ„12345678# EZ æ–‡ä»¶å®é™…ä¸Šæ˜¯ ZIP æ ¼å¼$ unzip -l rabbit-4.0.5.ezArchive: rabbit-4.0.5.ez Length Date Time Name--------- ---------- ----- ---- 1234 2025-01-16 22:05 rabbit-4.0.5/ebin/rabbit.app 45678 2025-01-16 22:05 rabbit-4.0.5/ebin/rabbit.beam ... ç›®å½• vs EZ æ ¼å¼å¯¹æ¯” ç‰¹æ€§ ç›®å½•æ ¼å¼ EZ æ ¼å¼ å­˜å‚¨ å±•å¼€çš„æ–‡ä»¶å¤¹ å‹ç¼©çš„ ZIP æ–‡ä»¶ åŠ è½½é€Ÿåº¦ å¿«é€Ÿ ç•¥æ…¢ï¼ˆéœ€è§£å‹ï¼‰ è°ƒè¯• å®¹æ˜“ï¼ˆç›´æ¥è®¿é—®æ–‡ä»¶ï¼‰ å›°éš¾ï¼ˆéœ€è§£å‹æŸ¥çœ‹ï¼‰ åˆ†å‘ å ç”¨ç©ºé—´å¤§ å ç”¨ç©ºé—´å° çƒ­åŠ è½½ æ”¯æŒ æ›´å¥½æ”¯æŒ ç‰ˆæœ¬ç®¡ç† å¤æ‚ ç®€å•ï¼ˆæ–‡ä»¶ååŒ…å«ç‰ˆæœ¬ï¼‰ EZ æ ¼å¼ä¼˜åŠ¿ å‹ç¼©å­˜å‚¨: å‡å°‘ç£ç›˜å ç”¨å’Œç½‘ç»œä¼ è¾“ åŸå­æ€§: å•æ–‡ä»¶éƒ¨ç½²ï¼Œé¿å…éƒ¨åˆ†æ–‡ä»¶ä¸¢å¤± ç‰ˆæœ¬ç®¡ç†: æ–‡ä»¶ååŒ…å«ç‰ˆæœ¬ä¿¡æ¯ çƒ­åŠ è½½: Erlang VM åŸç”Ÿæ”¯æŒ EZ æ–‡ä»¶çƒ­åŠ è½½ ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µæ’ä»¶åˆ†å‘1234567# 1. æ’ä»¶å¼€å‘è€…make dist DIST_AS_EZS=true# ç”Ÿæˆ .ez æ–‡ä»¶ç”¨äºåˆ†å‘# 2. æ’ä»¶ç”¨æˆ·rabbitmq-plugins enable plugin_name# ä» .ez æ–‡ä»¶å®‰è£…æ’ä»¶ 4. make source-dist - æºç åˆ†å‘åŒ…æŠ€æœ¯åŸç†make source-dist åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ã€å¯å¤ç°çš„æºç å½’æ¡£åŒ…ï¼ˆtar.xzï¼‰ï¼ŒåŒ…å«æ‰€æœ‰ä¾èµ–å’Œæ„å»ºæ‰€éœ€çš„æ–‡ä»¶ã€‚è¿™æ˜¯ make package-generic-unix çš„å‰ç½®æ­¥éª¤ã€‚ æ ¸å¿ƒå®ç°æºç 12345678910111213141516# æ¥æºï¼šMakefile (ç¬¬ 142-152 è¡Œ)SOURCE_DIST_BASE ?= rabbitmq-serverSOURCE_DIST_SUFFIXES ?= tar.xzSOURCE_DIST ?= $(PACKAGES_DIR)/$(SOURCE_DIST_BASE)-$(PROJECT_VERSION)# æºç åŒ…æ–‡ä»¶SOURCE_DIST_FILES = $(addprefix $(SOURCE_DIST).,$(SOURCE_DIST_SUFFIXES))source-dist: $(SOURCE_DIST_FILES) @:# æ¥æºï¼šMakefile (ç¬¬ 234-306 è¡Œ)$(SOURCE_DIST): $(ERLANG_MK_RECURSIVE_DEPS_LIST) $(verbose) mkdir -p $(dir $@) $(gen_verbose) $(RSYNC) $(RSYNC_FLAGS) ./ $@/ # æ”¶é›†ä¾èµ–ã€è®¸å¯è¯ã€ç‰ˆæœ¬ä¿¡æ¯ç­‰ æ‰“åŒ…æµç¨‹è¯¦è§£123456789101112131415161718192021make source-dist â†“è§£æä¾èµ–åˆ—è¡¨ (ERLANG_MK_RECURSIVE_DEPS_LIST) â†“rsync å¤åˆ¶ä¸»é¡¹ç›® (æ’é™¤ .git, .beam, deps/ ç­‰) â†“æ”¶é›†æ‰€æœ‰ä¾èµ–åˆ° deps/ â†“å¤„ç†è®¸å¯è¯æ–‡ä»¶ (LICENSE) â†“æ›´æ–°ç‰ˆæœ¬ä¿¡æ¯ (.app.src æ–‡ä»¶) â†“ç”Ÿæˆ git-revisions.txt (ç‰ˆæœ¬è¿½è¸ª) â†“å¤„ç† Mix/Hex ç¼“å­˜ (ç”¨äºç¦»çº¿æ„å»º) â†“å›ºå®šæ–‡ä»¶æ—¶é—´æˆ³ (å¯å¤ç°æ€§) â†“ç”Ÿæˆ manifest æ–‡ä»¶ â†“åˆ›å»º tar.xz å½’æ¡£ RSYNC æ’é™¤è§„åˆ™12345678910111213141516RSYNC_FLAGS += -a $(RSYNC_V) \\ --exclude &#x27;.sw?&#x27; --exclude &#x27;.*.sw?&#x27; \\ # vim äº¤æ¢æ–‡ä»¶ --exclude &#x27;*.beam&#x27; \\ # ç¼–è¯‘äº§ç‰© --exclude &#x27;*.d&#x27; \\ # ä¾èµ–æ–‡ä»¶ --exclude &#x27;*.pyc&#x27; \\ # Python ç¼“å­˜ --exclude &#x27;.git*&#x27; \\ # Git æ–‡ä»¶ --exclude &#x27;.hg*&#x27; \\ # Mercurial æ–‡ä»¶ --exclude &#x27;*.bzl&#x27; \\ # Bazel æ–‡ä»¶ --exclude &#x27;*.bazel&#x27; \\ --exclude &#x27;BUILD.*&#x27; \\ --exclude &#x27;deps/&#x27; \\ # ä¾èµ–ç›®å½•ï¼ˆå•ç‹¬å¤„ç†ï¼‰ --exclude &#x27;ebin/&#x27; \\ # ç¼–è¯‘è¾“å‡º --exclude &#x27;plugins/&#x27; \\ # æ’ä»¶ç›®å½• --exclude &#x27;test/&#x27; \\ # æµ‹è¯•æ–‡ä»¶ --exclude &#x27;sbin/&#x27; \\ # ç”Ÿæˆçš„è„šæœ¬ # ... æ›´å¤šæ’é™¤è§„åˆ™ å®é™…ç”Ÿæˆçš„æ–‡ä»¶123456789101112131415PACKAGES/â”œâ”€â”€ rabbitmq-server-4.0.5/ # è§£å‹åçš„æºç ç›®å½•â”‚ â”œâ”€â”€ Makefile # ä¸»æ„å»ºæ–‡ä»¶â”‚ â”œâ”€â”€ erlang.mk # Erlang.mk æ„å»ºç³»ç»Ÿâ”‚ â”œâ”€â”€ plugins.mk # æ’ä»¶å®šä¹‰â”‚ â”œâ”€â”€ deps/ # æ‰€æœ‰ä¾èµ–æºç â”‚ â”‚ â”œâ”€â”€ rabbit/ # æ ¸å¿ƒæ¨¡å—â”‚ â”‚ â”œâ”€â”€ rabbit_common/ # å…¬å…±æ¨¡å—â”‚ â”‚ â”œâ”€â”€ rabbitmq_management/ # ç®¡ç†æ’ä»¶â”‚ â”‚ â””â”€â”€ ... # å…¶ä»–ä¾èµ–â”‚ â”œâ”€â”€ LICENSE # åˆå¹¶çš„è®¸å¯è¯æ–‡ä»¶â”‚ â”œâ”€â”€ LICENSE-* # å„ç»„ä»¶è®¸å¯è¯â”‚ â””â”€â”€ git-revisions.txt # Git ç‰ˆæœ¬è¿½è¸ªâ”œâ”€â”€ rabbitmq-server-4.0.5.tar.xz # æºç å½’æ¡£åŒ… (~5MB)â””â”€â”€ rabbitmq-server-4.0.5.manifest # æ–‡ä»¶æ¸…å• å¯å¤ç°æ€§ç‰¹æ€§ å›ºå®šæ—¶é—´æˆ³ - æ‰€æœ‰æ–‡ä»¶æ—¶é—´æˆ³åŸºäºæœ€æ–° Git æäº¤ æ’åºæ–‡ä»¶åˆ—è¡¨ - manifest ä½¿ç”¨ LC_COLLATE=C sort ç¡®ä¿ä¸€è‡´æ€§ Hex ç¼“å­˜å¤„ç† - å°† ETS ç¼“å­˜è½¬ä¸º Erlang term æ–‡ä»¶é¿å…äºŒè¿›åˆ¶å·®å¼‚ ç‰ˆæœ¬ä¿¡æ¯åµŒå…¥ - è‡ªåŠ¨æ›´æ–°æ‰€æœ‰ .app.src ä¸­çš„ç‰ˆæœ¬å· ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µç¦»çº¿æ„å»º1234567891011# 1. åœ¨è”ç½‘ç¯å¢ƒåˆ›å»ºæºç åŒ…make source-dist# 2. ä¼ è¾“åˆ°ç¦»çº¿ç¯å¢ƒscp PACKAGES/rabbitmq-server-4.0.5.tar.xz offline-server:/tmp/# 3. ç¦»çº¿æ„å»ºssh offline-servertar -xf /tmp/rabbitmq-server-4.0.5.tar.xzcd rabbitmq-server-4.0.5make ç‰ˆæœ¬å‘å¸ƒ123# å®˜æ–¹å‘å¸ƒæµç¨‹make source-dist# ç”Ÿæˆçš„ tar.xz å¯ä¸Šä¼ åˆ° GitHub Releases ä½œä¸º package-generic-unix çš„è¾“å…¥123456# make package-generic-unix å†…éƒ¨ä¾èµ– source-distmake package-generic-unix# å®é™…æ‰§è¡Œï¼š# 1. make source-dist (ç”Ÿæˆæºç åŒ…)# 2. è§£å‹æºç åŒ…# 3. ç¼–è¯‘å¹¶æ‰“åŒ…ä¸ºé€šç”¨åŒ… 5. make package-generic-unix - é€šç”¨ Unix åŒ…æŠ€æœ¯åŸç†åˆ›å»ºè·¨å¹³å°çš„ tar.xz å®‰è£…åŒ…ï¼ŒåŒ…å«å®Œæ•´çš„ RabbitMQ è¿è¡Œç¯å¢ƒã€‚ä¾èµ– make source-dist ç”Ÿæˆçš„æºç åŒ…ä½œä¸ºè¾“å…¥ã€‚ æ ¸å¿ƒå®ç°æºç 123456789101112131415161718192021222324# æ¥æºï¼špackaging/generic-unix/Makefile (ç¬¬ 33-76 è¡Œ)SOURCE_DIR = rabbitmq-server-$(VERSION)TARGET_DIR = rabbitmq_server-$(VERSION)TARGET_TARBALL = rabbitmq-server-$(TARBALL_SUFFIX)-$(VERSION)dist: # è§£å‹æºç åŒ… xzcat $(SOURCE_DIST_FILE) | tar -xf - # ç¼–è¯‘å¹¶å®‰è£…åˆ°ç›®æ ‡ç›®å½• $(MAKE) -C $(SOURCE_DIR) \\ PREFIX= RMQ_ROOTDIR= \\ RMQ_ERLAPP_DIR=`pwd`/$(TARGET_DIR) \\ MANDIR=`pwd`/$(TARGET_DIR)/share/man \\ manpages web-manpages install install-man # ä¿®æ”¹é…ç½®æ–‡ä»¶ sed -e &#x27;s:^SYS_PREFIX=$$:SYS_PREFIX=\\$$&#123;RABBITMQ_HOME&#125;:&#x27; \\ $(TARGET_DIR)/sbin/rabbitmq-defaults &gt;$(TARGET_DIR)/sbin/rabbitmq-defaults.tmp # åˆ›å»º tar.xz åŒ… find $(TARGET_DIR) | LC_COLLATE=C sort &gt; $(TARGET_TARBALL).manifest tar --no-recursion -T $(TARGET_TARBALL).manifest -cf - | \\ xz &gt; $(CURDIR)/$(TARGET_TARBALL).tar.xz æ‰“åŒ…æµç¨‹è¯¦è§£ è§£å‹æºç åŒ… - ä» tar.xz æºç åŒ…å¼€å§‹ ç¼–è¯‘å®‰è£… - ä½¿ç”¨æ ‡å‡† Unix å®‰è£…è·¯å¾„ ç”Ÿæˆæ–‡æ¡£ - åˆ›å»º man æ‰‹å†Œé¡µ é…ç½®è„šæœ¬ - è°ƒæ•´å¯åŠ¨è„šæœ¬çš„è·¯å¾„å˜é‡ åˆ›å»ºå½’æ¡£ - æ‰“åŒ…æˆ tar.xz æ ¼å¼ å®é™…ç”Ÿæˆçš„åŒ…ç»“æ„ï¼ˆå·²éªŒè¯ï¼‰123456789PACKAGES/â”œâ”€â”€ rabbitmq-server-4.0.5.tar.xz # 4.95 MB - æºç åŒ…â”œâ”€â”€ rabbitmq-server-generic-unix-4.0.5.tar.xz # 15.51 MB - é€šç”¨åŒ…â”œâ”€â”€ rabbitmq-server-4.0.5.manifest # 230.22 KB - æ–‡ä»¶æ¸…å•â””â”€â”€ rabbitmq-server-4.0.5/ # è§£å‹åçš„æºç ç›®å½• â”œâ”€â”€ sbin/ # å¯åŠ¨è„šæœ¬ (25 ä¸ªæ–‡ä»¶) â”œâ”€â”€ deps/ # ä¾èµ–æ¨¡å— (86 ä¸ªç›®å½•) â”œâ”€â”€ etc/ # é…ç½®ç›®å½• â””â”€â”€ ... # å…¶ä»–æ–‡ä»¶ é€šç”¨åŒ…å†…å®¹åˆ†æ12345678910111213141516# è§£å‹é€šç”¨åŒ…åçš„ç›®å½•ç»“æ„rabbitmq_server-4.0.5/â”œâ”€â”€ lib/ # Erlang åº”ç”¨åº“â”‚ â””â”€â”€ rabbitmq_server-4.0.5/â”‚ â”œâ”€â”€ ebin/ # å­—èŠ‚ç æ–‡ä»¶â”‚ â”œâ”€â”€ include/ # å¤´æ–‡ä»¶â”‚ â””â”€â”€ priv/ # ç§æœ‰èµ„æºâ”œâ”€â”€ sbin/ # å¯åŠ¨è„šæœ¬â”‚ â”œâ”€â”€ rabbitmq-server # å·²é…ç½® RABBITMQ_HOMEâ”‚ â”œâ”€â”€ rabbitmqctlâ”‚ â””â”€â”€ ...â”œâ”€â”€ etc/ # é…ç½®ç›®å½•â”‚ â””â”€â”€ rabbitmq/â”œâ”€â”€ share/ # æ–‡æ¡£å’Œæ‰‹å†Œâ”‚ â””â”€â”€ man/â””â”€â”€ plugins/ # æ’ä»¶ç›®å½• é€šç”¨åŒ…ç‰¹ç‚¹ è‡ªåŒ…å«: åŒ…å«æ‰€æœ‰è¿è¡Œæ—¶ä¾èµ– å¯ç§»æ¤: é€‚ç”¨äºå„ç§ Unix ç³»ç»Ÿ æ ‡å‡†åŒ–: éµå¾ª Unix ç›®å½•ç»“æ„è§„èŒƒ ç”Ÿäº§å°±ç»ª: åŒ…å«å®Œæ•´çš„é…ç½®å’Œæ–‡æ¡£ ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µå®¹å™¨åŒ–éƒ¨ç½²1234567# 1. æ„å»ºé€šç”¨åŒ…make package-generic-unix# 2. Dockerfile ç¤ºä¾‹FROM ubuntu:20.04COPY PACKAGES/rabbitmq-server-generic-unix-*.tar.xz /tmp/RUN tar -xf /tmp/rabbitmq-server-generic-unix-*.tar.xz -C /opt/ è·¨å¹³å°åˆ†å‘123456# 1. åˆ›å»ºåˆ†å‘åŒ…make package-generic-unix# 2. éƒ¨ç½²åˆ°ä¸åŒç³»ç»Ÿscp PACKAGES/rabbitmq-server-generic-unix-*.tar.xz user@server:/tmp/ssh user@server &#x27;cd /opt &amp;&amp; tar -xf /tmp/rabbitmq-server-generic-unix-*.tar.xz&#x27; 6. make install - ç³»ç»Ÿçº§å®‰è£…æŠ€æœ¯åŸç†å°† RabbitMQ å®‰è£…åˆ°ç³»ç»Ÿæ ‡å‡†è·¯å¾„ï¼Œéµå¾ª FHS (Filesystem Hierarchy Standard)ã€‚ æ ¸å¿ƒå®ç°é€»è¾‘12345678910111213141516# æ¥æºï¼šMakefile ç¬¬ 489-523 è¡ŒPREFIX ?= /usr/localRMQ_ROOTDIR ?= $(PREFIX)/lib/erlangRMQ_BINDIR ?= $(RMQ_ROOTDIR)/binRMQ_LIBDIR ?= $(RMQ_ROOTDIR)/libRMQ_ERLAPP_DIR ?= $(RMQ_LIBDIR)/rabbitmq_server-$(PROJECT_VERSION)install: install-erlapp install-scriptsinstall-erlapp: dist $(verbose) mkdir -p $(DESTDIR)$(RMQ_ERLAPP_DIR) $(inst_verbose) cp -r \\ LICENSE* \\ $(DEPS_DIR)/rabbit/INSTALL \\ $(DIST_DIR) \\ $(DESTDIR)$(RMQ_ERLAPP_DIR) å®‰è£…ç»„ä»¶è¯¦è§£ æ ¸å¿ƒåº”ç”¨ (install-erlapp) - å®‰è£… Erlang åº”ç”¨å’Œæ’ä»¶ å¯åŠ¨è„šæœ¬ (install-scripts) - å®‰è£…æœåŠ¡å¯åŠ¨è„šæœ¬ å‘½ä»¤è¡Œå·¥å…· (install-bin) - å®‰è£…ç®¡ç†å·¥å…· æ‰‹å†Œé¡µ (install-man) - å®‰è£…æ–‡æ¡£ ç³»ç»Ÿå®‰è£…ç›®å½•ç»“æ„1234567891011121314151617/usr/local/â”œâ”€â”€ bin/ # å¯æ‰§è¡Œæ–‡ä»¶â”‚ â”œâ”€â”€ rabbitmq-serverâ”‚ â”œâ”€â”€ rabbitmqctlâ”‚ â””â”€â”€ ...â”œâ”€â”€ lib/ # åº“æ–‡ä»¶â”‚ â””â”€â”€ rabbitmq/â”‚ â”œâ”€â”€ lib/ # Erlang åº”ç”¨â”‚ â””â”€â”€ plugins/ # æ’ä»¶ç›®å½•â”œâ”€â”€ etc/ # é…ç½®æ–‡ä»¶â”‚ â””â”€â”€ rabbitmq/â”‚ â””â”€â”€ rabbitmq.confâ”œâ”€â”€ var/ # æ•°æ®ç›®å½•â”‚ â”œâ”€â”€ log/rabbitmq/ # æ—¥å¿—â”‚ â””â”€â”€ lib/rabbitmq/ # æ•°æ®åº“â””â”€â”€ share/ # æ–‡æ¡£ â””â”€â”€ man/ # æ‰‹å†Œé¡µ ç³»ç»Ÿå®‰è£…ä¼˜åŠ¿ æ ‡å‡†åŒ–: éµå¾ª Unix æ ‡å‡†ç›®å½•ç»“æ„ å¤šç”¨æˆ·: æ”¯æŒç³»ç»Ÿçº§å¤šç”¨æˆ·è®¿é—® æœåŠ¡é›†æˆ: ä¾¿äºé›†æˆåˆ°ç³»ç»ŸæœåŠ¡ç®¡ç† æƒé™ç®¡ç†: åˆ©ç”¨ç³»ç»Ÿæƒé™æ§åˆ¶ ä½¿ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µç³»ç»Ÿçº§éƒ¨ç½²12345678910# 1. ç³»ç»Ÿå®‰è£…sudo make install PREFIX=/opt/rabbitmq# 2. æœåŠ¡é…ç½®sudo systemctl enable rabbitmq-serversudo systemctl start rabbitmq-server# 3. å¤šç”¨æˆ·ç¯å¢ƒsudo adduser rabbitmqsudo chown -R rabbitmq:rabbitmq /opt/rabbitmq åŒ…ç®¡ç†å™¨é›†æˆ12345678# 1. åˆ›å»º deb/rpm åŒ…make install DESTDIR=/tmp/rabbitmq-package PREFIX=/usr# 2. æ‰“åŒ…fpm -s dir -t deb -C /tmp/rabbitmq-package \\ --name rabbitmq-server \\ --version 4.0.5 \\ . 7. å¼€å‘è°ƒè¯•å‘½ä»¤make run-broker - å¯åŠ¨å¼€å‘æœåŠ¡å™¨æŠ€æœ¯åŸç†make run-broker åœ¨å‰å°å¯åŠ¨ RabbitMQ æœåŠ¡å™¨ï¼Œé€‚åˆå¼€å‘è°ƒè¯•ã€‚æ—¥å¿—ç›´æ¥è¾“å‡ºåˆ°ç»ˆç«¯ï¼Œä¾¿äºå®æ—¶æŸ¥çœ‹ã€‚ æ ¸å¿ƒå®ç°æºç 12345678910# æ¥æºï¼šdeps/rabbit_common/mk/rabbitmq-run.mk (ç¬¬ 269-278 è¡Œ)run-broker run-tls-broker: RABBITMQ_CONFIG_FILE := $(basename $(TEST_CONFIG_FILE))run-broker: config = $(test_rabbitmq_config)run-tls-broker: config = $(test_rabbitmq_config_with_tls)run-broker run-tls-broker: node-tmpdir $(DIST_TARGET) $(TEST_CONFIG_FILE) $(BASIC_SCRIPT_ENV_SETTINGS) \\ RABBITMQ_ALLOW_INPUT=true \\ RABBITMQ_CONFIG_FILE=$(RABBITMQ_CONFIG_FILE) \\ $(RABBITMQ_SERVER) æ‰§è¡Œæµç¨‹1234567891011make run-broker â†“åˆ›å»ºä¸´æ—¶ç›®å½• (node-tmpdir) â†“æ‰§è¡Œ make dist (å¦‚éœ€è¦) â†“ç”Ÿæˆæµ‹è¯•é…ç½®æ–‡ä»¶ â†“è®¾ç½®ç¯å¢ƒå˜é‡ â†“å¯åŠ¨ rabbitmq-server (å‰å°) ä½¿ç”¨åœºæ™¯1234567891011# 1. åŸºç¡€å¼€å‘è°ƒè¯•make run-broker# æ—¥å¿—ç›´æ¥è¾“å‡ºåˆ°ç»ˆç«¯ï¼ŒCtrl+C åœæ­¢# 2. åå°å¯åŠ¨make run-background-broker# æœåŠ¡åœ¨åå°è¿è¡Œ# 3. TLS æ¨¡å¼å¯åŠ¨make run-tls-broker# ä½¿ç”¨ TLS é…ç½®å¯åŠ¨ make run-broker PLUGINS= - æ’ä»¶æµ‹è¯•æŠ€æœ¯åŸç†é€šè¿‡ PLUGINS ç¯å¢ƒå˜é‡æŒ‡å®šè¦åŠ è½½çš„æ’ä»¶ï¼Œç”¨äºæµ‹è¯•ç‰¹å®šæ’ä»¶åŠŸèƒ½ã€‚ ä½¿ç”¨åœºæ™¯12345678# 1. æµ‹è¯•ç®¡ç†æ’ä»¶make run-broker PLUGINS=&quot;rabbitmq_management&quot;# 2. æµ‹è¯•å¤šä¸ªæ’ä»¶make run-broker PLUGINS=&quot;rabbitmq_management rabbitmq_prometheus&quot;# 3. æµ‹è¯•è‡ªå®šä¹‰æ’ä»¶make run-broker PLUGINS=&quot;my_custom_plugin&quot; æ³¨æ„äº‹é¡¹ æ’ä»¶åç§°ä½¿ç”¨ç©ºæ ¼åˆ†éš” æ’ä»¶éœ€è¦å…ˆç¼–è¯‘å®Œæˆï¼ˆmake distï¼‰ ä¾èµ–æ’ä»¶ä¼šè‡ªåŠ¨åŠ è½½ make shell - Erlang ShellæŠ€æœ¯åŸç†å¯åŠ¨ä¸€ä¸ªåŠ è½½äº†æ‰€æœ‰ RabbitMQ æ¨¡å—çš„ Erlang Shellï¼Œç”¨äºä»£ç è°ƒè¯•å’Œæ¨¡å—æµ‹è¯•ã€‚ æ ¸å¿ƒå®ç°æºç 123# æ¥æºï¼šerlang.mk (ç¬¬ 7053-7054 è¡Œ)shell:: build-shell-deps $(gen_verbose) $(SHELL_ERL) -pa $(SHELL_PATHS) $(SHELL_OPTS) ä½¿ç”¨åœºæ™¯12345678910111213# 1. è¿›å…¥ Erlang Shellmake shell# åœ¨ Shell ä¸­ï¼š# æµ‹è¯•æ¨¡å—å‡½æ•°1&gt; rabbit_misc:version().&quot;4.0.5&quot;# æ£€æŸ¥æ¨¡å—ä¿¡æ¯2&gt; m(rabbit).# ç¼–è¯‘å¹¶åŠ è½½ä¿®æ”¹åçš„æ¨¡å—3&gt; c(my_module). ä¸ erl çš„åŒºåˆ« ç‰¹æ€§ make shell erl ä»£ç è·¯å¾„ è‡ªåŠ¨è®¾ç½®æ‰€æœ‰ä¾èµ– éœ€æ‰‹åŠ¨æŒ‡å®š æ¨¡å—åŠ è½½ RabbitMQ æ¨¡å—å¯ç”¨ éœ€æ‰‹åŠ¨åŠ è½½ ç¯å¢ƒå˜é‡ ç»§æ‰¿é¡¹ç›®é…ç½® é»˜è®¤é…ç½® ç”¨é€” RabbitMQ å¼€å‘è°ƒè¯• é€šç”¨ Erlang å¼€å‘ make run-node - è£¸ Erlang èŠ‚ç‚¹æŠ€æœ¯åŸç†å¯åŠ¨ä¸€ä¸ªä¸è¿è¡Œ RabbitMQ åº”ç”¨çš„ Erlang èŠ‚ç‚¹ï¼Œä»…åŠ è½½ä»£ç ä½†ä¸å¯åŠ¨æœåŠ¡ã€‚ 123456# æ¥æºï¼šdeps/rabbit_common/mk/rabbitmq-run.mk (ç¬¬ 288-292 è¡Œ)run-node: node-tmpdir $(DIST_TARGET) $(BASIC_SCRIPT_ENV_SETTINGS) \\ RABBITMQ_NODE_ONLY=true \\ RABBITMQ_ALLOW_INPUT=true \\ $(RABBITMQ_SERVER) ä½¿ç”¨åœºæ™¯12345678# 1. Erlang çº§åˆ«è°ƒè¯•make run-node# 2. æ‰‹åŠ¨å¯åŠ¨ RabbitMQ åº”ç”¨1&gt; application:ensure_all_started(rabbit).# 3. æµ‹è¯•ç‰¹å®šæ¨¡å—è€Œä¸å¯åŠ¨å®Œæ•´æœåŠ¡1&gt; rabbit_misc:version(). å¼€å‘å·¥ä½œæµæœ€ä½³å®è·µ123456789101112131415161718192021# å®Œæ•´å¼€å‘å·¥ä½œæµ# 1. ç¼–è¯‘é¡¹ç›®make# 2. æµ‹è¯•æ¨¡å—ï¼ˆä¸å¯åŠ¨æœåŠ¡ï¼‰make shell&gt; my_module:test().# 3. å¯åŠ¨æœåŠ¡éªŒè¯make run-broker# 4. æµ‹è¯•ç‰¹å®šæ’ä»¶make run-broker PLUGINS=&quot;rabbitmq_management&quot;# 5. æŸ¥çœ‹ç®¡ç†ç•Œé¢# æµè§ˆå™¨è®¿é—® http://localhost:15672# 6. ä¿®æ”¹ä»£ç åé‡æ–°ç¼–è¯‘make # å¢é‡ç¼–è¯‘make run-broker # é‡æ–°å¯åŠ¨ æ„å»ºç³»ç»Ÿæ¶æ„æ·±åº¦è§£ææ ¸å¿ƒç»„ä»¶å…³ç³»123456789101112Makefile â”œâ”€â”€ erlang.mk â†’ ç¼–è¯‘ Erlang ä»£ç  â†’ ç”Ÿæˆ .beam æ–‡ä»¶ â”œâ”€â”€ rabbitmq-components.mk â†’ ç®¡ç†ç»„ä»¶ä¾èµ– â†’ deps/ ç›®å½• â””â”€â”€ plugins.mk â†’ æ’ä»¶åˆ—è¡¨ç®¡ç† â†’ PLUGINS å˜é‡ â†“ rabbitmq-dist.mk â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â†“ â†“ dist ç›®æ ‡ EZ æ‰“åŒ… â†“ â†“ plugins/ ç›®å½• .ez æ–‡ä»¶ å…³é”®é…ç½®æ–‡ä»¶è¯¦è§£1. Makefile - ä¸»æ§åˆ¶æ–‡ä»¶12345678910PROJECT = rabbitmq_server_releasePROJECT_DESCRIPTION = RabbitMQ Server# æ’ä»¶åˆ—è¡¨include plugins.mkDEPS = rabbit_common rabbit $(PLUGINS) $(ADDITIONAL_PLUGINS)# æ„å»ºç³»ç»Ÿinclude rabbitmq-components.mkinclude erlang.mk 2. plugins.mk - æ’ä»¶å®šä¹‰123456789PLUGINS = \\ rabbitmq_amqp1_0 \\ rabbitmq_auth_backend_cache \\ rabbitmq_auth_backend_http \\ rabbitmq_auth_backend_ldap \\ rabbitmq_auth_backend_oauth2 \\ rabbitmq_auth_mechanism_ssl \\ rabbitmq_consistent_hash_exchange \\ # ... æ›´å¤šæ’ä»¶ 3. rabbitmq-dist.mk - åˆ†å‘é€»è¾‘1234567891011# EZ æ–‡ä»¶ç”Ÿæˆå®define do_ez_target_erlangmk# å®šä¹‰ç›®æ ‡ç›®å½•å’Œæ–‡ä»¶ådist_$(1)_ez_dir = $(DIST_DIR)/$(1)-$(2)# æ ¹æ® DIST_AS_EZS å†³å®šæ ¼å¼ifeq ($(DIST_AS_EZS),)dist_$(1)_ez = $$(dist_$(1)_ez_dir) # ç›®å½•else dist_$(1)_ez = $$(dist_$(1)_ez_dir).ez # EZ æ–‡ä»¶endifendef æ„å»ºç³»ç»Ÿç‰¹ç‚¹ æ¨¡å—åŒ–è®¾è®¡ - æ¯ä¸ª .mk æ–‡ä»¶è´Ÿè´£ç‰¹å®šåŠŸèƒ½ å¯æ‰©å±•æ€§ - æ”¯æŒè‡ªå®šä¹‰æ’ä»¶å’Œæ„å»ºè§„åˆ™ æ ‡å‡†åŒ– - éµå¾ª Erlang&#x2F;OTP å’Œ Unix æ ‡å‡† è‡ªåŠ¨åŒ– - å®Œæ•´çš„ä¾èµ–ç®¡ç†å’Œæ„å»ºæµç¨‹ å®Œæ•´ç¼–è¯‘æµç¨‹å¯¹æ¯”æ€§èƒ½å’Œèµ„æºè¯¦ç»†å¯¹æ¯”æ„å»ºå‘½ä»¤ ç¼–è¯‘æ–¹å¼ ç¼–è¯‘æ—¶é—´ ç£ç›˜å ç”¨ å†…å­˜ä½¿ç”¨ ç½‘ç»œä¼ è¾“ éƒ¨ç½²å¤æ‚åº¦ ç»´æŠ¤æˆæœ¬ make æœ€å¿« (30s) ä¸­ç­‰ (200MB) ä½ (100MB) ä¸é€‚ç”¨ ç®€å• ä½ make dist å¿« (45s) å¤§ (300MB) ä¸­ç­‰ (150MB) å¤§ (300MB) ä¸­ç­‰ ä¸­ç­‰ make dist DIST_AS_EZS=true ä¸­ç­‰ (60s) å° (15MB) ä¸­ç­‰ (150MB) å° (15MB) ç®€å• ä½ make source-dist å¿« (40s) å° (~5MB) ä½ (100MB) å° (~5MB) ç®€å• ä½ make package-generic-unix æ…¢ (120s) æœ€å° (15.51MB) é«˜ (200MB) æœ€å° (15.51MB) ç®€å• ä½ make install ä¸­ç­‰ (75s) ä¸­ç­‰ (250MB) ä½ (100MB) ä¸é€‚ç”¨ å¤æ‚ é«˜ å¼€å‘è°ƒè¯•å‘½ä»¤ å‘½ä»¤ å¯åŠ¨æ—¶é—´ ç”¨é€” äº¤äº’æ€§ make run-broker å¿« (5s) å¼€å‘è°ƒè¯• å‰å°ï¼Œå¯æŸ¥çœ‹æ—¥å¿— make run-broker PLUGINS=... å¿« (5s) æ’ä»¶æµ‹è¯• å‰å°ï¼ŒæŒ‡å®šæ’ä»¶ make shell æœ€å¿« (2s) æ¨¡å—è°ƒè¯• äº¤äº’å¼ Erlang Shell make run-background-broker å¿« (5s) è‡ªåŠ¨åŒ–æµ‹è¯• åå°è¿è¡Œ make run-node æœ€å¿« (2s) Erlang è°ƒè¯• è£¸èŠ‚ç‚¹ï¼Œæ—  RabbitMQ æœ€ä½³å®è·µæŒ‡å—å¼€å‘é˜¶æ®µæœ€ä½³å®è·µ123456789101112131415# 1. åˆå§‹è®¾ç½®git clone https://github.com/rabbitmq/rabbitmq-server.gitcd rabbitmq-servergit checkout v4.0.5# 2. å¿«é€Ÿå¼€å‘è¿­ä»£make clean &amp;&amp; makesbin/rabbitmq-server# 3. å¢é‡ç¼–è¯‘ï¼ˆæ¨èï¼‰make # åªç¼–è¯‘ä¿®æ”¹çš„æ–‡ä»¶# 4. å¼€å‘è°ƒè¯•make shell # è¿›å…¥ Erlang shellmake run-broker # è¿è¡Œå¼€å‘ç‰ˆæœ¬ æµ‹è¯•é˜¶æ®µæœ€ä½³å®è·µ1234567891011121314# 1. åŠŸèƒ½æµ‹è¯•make dist# æµ‹è¯•æ’ä»¶åŠ è½½å’Œç›®å½•ç»“æ„# 2. æ’ä»¶å…¼å®¹æ€§æµ‹è¯•make dist DIST_AS_EZS=true# éªŒè¯ EZ æ–‡ä»¶åŠ è½½å’Œçƒ­åŠ è½½# 3. é›†æˆæµ‹è¯•make package-generic-unix# åœ¨ä¸åŒç¯å¢ƒæµ‹è¯•å®‰è£…åŒ…# 4. æ€§èƒ½æµ‹è¯•make # ä½¿ç”¨æœ€å¿«çš„ç¼–è¯‘æ–¹å¼ ç”Ÿäº§éƒ¨ç½²æœ€ä½³å®è·µ123456789101112131415# 1. å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆæ¨èï¼‰make package-generic-unix# ä½¿ç”¨ tar.xz åŒ…æ„å»º Docker é•œåƒ# 2. ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²make install PREFIX=/opt/rabbitmq# ç³»ç»Ÿçº§å®‰è£…# 3. äº‘åŸç”Ÿéƒ¨ç½²make dist DIST_AS_EZS=true# ä½¿ç”¨ EZ æ–‡ä»¶æ”¯æŒåŠ¨æ€æ’ä»¶ç®¡ç†# 4. é«˜å¯ç”¨éƒ¨ç½²make package-generic-unix# æ ‡å‡†åŒ–çš„éƒ¨ç½²åŒ…ï¼Œä¾¿äºé›†ç¾¤ç®¡ç† æ’ä»¶å¼€å‘æœ€ä½³å®è·µ123456789101112131415# 1. æ’ä»¶å¼€å‘make dist# å¼€å‘é˜¶æ®µä½¿ç”¨ç›®å½•æ ¼å¼ä¾¿äºè°ƒè¯•# 2. æ’ä»¶æµ‹è¯•make run-broker PLUGINS=&quot;plugin_name&quot;# æµ‹è¯•æ’ä»¶åŠŸèƒ½# 3. æ’ä»¶åˆ†å‘make dist DIST_AS_EZS=true# ç”Ÿæˆ .ez æ–‡ä»¶ç”¨äºåˆ†å‘# 4. æ’ä»¶å‘å¸ƒrabbitmq-plugins enable plugin_name# ä» .ez æ–‡ä»¶å®‰è£…æ’ä»¶ é«˜çº§é…ç½®ä¸ä¼˜åŒ–ç¯å¢ƒå˜é‡æ§åˆ¶123456789101112131415# è‡ªå®šä¹‰æ’ä»¶ç›®å½•export DIST_DIR=/custom/plugins/pathmake dist# è‡ªå®šä¹‰åŒ…è¾“å‡ºç›®å½•export PACKAGES_DIR=/custom/packages/path make package-generic-unix# å¯ç”¨ç¤¾åŒºæ’ä»¶export COMMUNITY_PLUGINS=1make dist# è‡ªå®šä¹‰ç‰ˆæœ¬å·export PROJECT_VERSION=4.0.5-custommake dist ç¼–è¯‘ä¼˜åŒ–æŠ€å·§123456789101112131415# å¹¶è¡Œç¼–è¯‘ï¼ˆæ¨èï¼‰make -j$(nproc) dist# è¯¦ç»†è¾“å‡ºï¼ˆè°ƒè¯•ç”¨ï¼‰make V=1 dist# è·³è¿‡æµ‹è¯•ï¼ˆåŠ é€Ÿç¼–è¯‘ï¼‰make SKIP_TESTS=1 dist# å¢é‡ç¼–è¯‘ï¼ˆå¼€å‘ç”¨ï¼‰make # ä¸ä½¿ç”¨ clean# å†…å­˜ä¼˜åŒ–export ERL_MAX_PORTS=32768make dist è‡ªå®šä¹‰æ„å»ºé…ç½®12345678# åˆ›å»º local.mk æ–‡ä»¶è¿›è¡Œè‡ªå®šä¹‰# local.mkADDITIONAL_PLUGINS = my_custom_pluginDIST_AS_EZS = 1PACKAGES_DIR = /opt/packages# åŒ…å«åˆ°ä¸» Makefileinclude local.mk æ•…éšœæ’é™¤æŒ‡å—å¸¸è§ç¼–è¯‘é—®é¢˜1. ä¾èµ–é—®é¢˜1234# é—®é¢˜ï¼šdeps ç¼–è¯‘å¤±è´¥# è§£å†³ï¼šæ¸…ç†å¹¶é‡æ–°è·å–ä¾èµ–make clean-depsmake deps 2. ç‰ˆæœ¬å†²çª1234# é—®é¢˜ï¼šErlang ç‰ˆæœ¬ä¸å…¼å®¹# è§£å†³ï¼šæ£€æŸ¥å¹¶åˆ‡æ¢ Erlang ç‰ˆæœ¬erl -version# ç¡®ä¿ä½¿ç”¨ Erlang 25.x æˆ– 26.x 3. ç£ç›˜ç©ºé—´ä¸è¶³1234# é—®é¢˜ï¼šç¼–è¯‘è¿‡ç¨‹ä¸­ç£ç›˜ç©ºé—´ä¸è¶³# è§£å†³ï¼šæ¸…ç†ä¸´æ—¶æ–‡ä»¶make cleanmake distclean 4. æƒé™é—®é¢˜1234# é—®é¢˜ï¼šinstall æ—¶æƒé™ä¸è¶³# è§£å†³ï¼šä½¿ç”¨æ­£ç¡®çš„æƒé™sudo make install PREFIX=/opt/rabbitmqsudo chown -R rabbitmq:rabbitmq /opt/rabbitmq æ€§èƒ½ä¼˜åŒ–å»ºè®® ä½¿ç”¨ SSD - æ˜¾è‘—æå‡ç¼–è¯‘é€Ÿåº¦ å¢åŠ å†…å­˜ - å‡å°‘äº¤æ¢æ–‡ä»¶ä½¿ç”¨ å¹¶è¡Œç¼–è¯‘ - åˆ©ç”¨å¤šæ ¸ CPU å¢é‡ç¼–è¯‘ - å¼€å‘é˜¶æ®µé¿å… clean æœ¬åœ°ç¼“å­˜ - ä½¿ç”¨æœ¬åœ° Maven&#x2F;Hex ç¼“å­˜ æ€»ç»“ä¸å»ºè®®å‘½ä»¤é€‰æ‹©çŸ©é˜µæ„å»ºåœºæ™¯ åœºæ™¯ æ¨èæ–¹å¼ ç†ç”± æœ¬åœ°å¼€å‘ make æœ€å¿«ï¼Œæ”¯æŒå¢é‡ç¼–è¯‘ åŠŸèƒ½æµ‹è¯• make dist å®Œæ•´æ’ä»¶ç»“æ„ï¼Œä¾¿äºè°ƒè¯• æ’ä»¶å¼€å‘ make dist â†’ make dist DIST_AS_EZS=true å¼€å‘ç”¨ç›®å½•ï¼Œåˆ†å‘ç”¨ EZ ç¦»çº¿æ„å»º make source-dist åŒ…å«æ‰€æœ‰ä¾èµ–ï¼Œå¯å¤ç° ç‰ˆæœ¬å‘å¸ƒ make source-dist å®˜æ–¹å‘å¸ƒæµç¨‹ï¼Œå¯å¤ç°å½’æ¡£ å®¹å™¨éƒ¨ç½² make package-generic-unix è‡ªåŒ…å«ï¼Œæ ‡å‡†åŒ– ç”Ÿäº§éƒ¨ç½² make package-generic-unix æˆ– make install ç¨³å®šï¼Œä¾¿äºç®¡ç† è‡ªå®šä¹‰å®‰è£… make install PREFIX=/opt/rabbitmq æŒ‡å®šå®‰è£…è·¯å¾„ æ’ä»¶åˆ†å‘ make dist DIST_AS_EZS=true å‹ç¼©ï¼Œä¾¿äºä¼ è¾“ CI&#x2F;CD make package-generic-unix å¯é‡ç°ï¼Œæ ‡å‡†åŒ– å¼€å‘è°ƒè¯•åœºæ™¯ åœºæ™¯ æ¨èæ–¹å¼ ç†ç”± æ—¥å¸¸å¼€å‘è°ƒè¯• make run-broker å‰å°è¿è¡Œï¼Œå®æ—¶æŸ¥çœ‹æ—¥å¿— æ’ä»¶åŠŸèƒ½éªŒè¯ make run-broker PLUGINS=&quot;plugin_name&quot; æŒ‰éœ€åŠ è½½æ’ä»¶ æ¨¡å—çº§è°ƒè¯• make shell äº¤äº’å¼æµ‹è¯•å‡½æ•° è‡ªåŠ¨åŒ–æµ‹è¯• make run-background-broker åå°è¿è¡Œï¼Œè„šæœ¬æ§åˆ¶ Erlang åº•å±‚è°ƒè¯• make run-node ä¸å¯åŠ¨ RabbitMQ åº”ç”¨ å…³é”®æŠ€æœ¯æ´å¯Ÿ EZ æ ¼å¼æ˜¯ç‹é“ - å¯¹äºæ’ä»¶åˆ†å‘å’Œçƒ­åŠ è½½ é€šç”¨åŒ…æœ€å®ç”¨ - å¯¹äºç”Ÿäº§éƒ¨ç½²å’Œå®¹å™¨åŒ– æºç åŒ…æ˜¯åŸºç¡€ - source-dist æ˜¯ package-generic-unix çš„å‰ç½®ä¾èµ– å¼€å‘è°ƒè¯•ç”¨ run-broker - æ¯” sbin/rabbitmq-server æ›´æ–¹ä¾¿ å¢é‡ç¼–è¯‘æ˜¯å…³é”® - å¯¹äºå¼€å‘æ•ˆç‡ æ„å»ºç³»ç»Ÿå¾ˆçµæ´» - æ”¯æŒé«˜åº¦å®šåˆ¶ æ ‡å‡†åŒ–å¾ˆé‡è¦ - éµå¾ª Unix å’Œ Erlang æ ‡å‡† RabbitMQ çš„æ„å»ºç³»ç»Ÿè®¾è®¡ç²¾è‰¯ï¼Œé€šè¿‡ä¸åŒçš„ç¼–è¯‘å‘½ä»¤æ»¡è¶³äº†ä»å¼€å‘åˆ°ç”Ÿäº§çš„å„ç§éœ€æ±‚ã€‚ç†è§£è¿™äº›ç¼–è¯‘æ–¹å¼çš„åŸç†å’Œæœ€ä½³å®è·µï¼Œå°†æ˜¾è‘—æå‡ RabbitMQ çš„å¼€å‘ã€éƒ¨ç½²å’Œè¿ç»´æ•ˆç‡ã€‚ å‚è€ƒèµ„æ–™ RabbitMQ å®˜æ–¹æ–‡æ¡£ Erlang.mk ç”¨æˆ·æŒ‡å— Erlang&#x2F;OTP è®¾è®¡åŸåˆ™ Unix æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡æ ‡å‡†","categories":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/RabbitMQ/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"ç¼–è¯‘","slug":"ç¼–è¯‘","permalink":"https://hzsunzixiang.github.io/tags/%E7%BC%96%E8%AF%91/"},{"name":"æ„å»ºç³»ç»Ÿ","slug":"æ„å»ºç³»ç»Ÿ","permalink":"https://hzsunzixiang.github.io/tags/%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F/"},{"name":"éƒ¨ç½²","slug":"éƒ¨ç½²","permalink":"https://hzsunzixiang.github.io/tags/%E9%83%A8%E7%BD%B2/"}]},{"title":"RabbitMQ ç¼–è¯‘æ–¹å¼æ·±åº¦è§£æä¸æºç åˆ†æ","slug":"rabbitmq-rabbitmq-build-deep-analysis","date":"2026-01-16T14:00:00.000Z","updated":"2026-01-16T14:20:58.455Z","comments":true,"path":"2026/01/16/rabbitmq-rabbitmq-build-deep-analysis/","permalink":"https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-build-deep-analysis/","excerpt":"","text":"RabbitMQ ç¼–è¯‘æ–¹å¼æ·±åº¦è§£æä¸æºç åˆ†ææ¦‚è¿°RabbitMQ ä½œä¸ºä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæä¾›äº†å¤šç§ç¼–è¯‘å’Œæ‰“åŒ…æ–¹å¼æ¥æ»¡è¶³ä¸åŒçš„éƒ¨ç½²éœ€æ±‚ã€‚æœ¬æ–‡æ¡£åŸºäº RabbitMQ 4.0.x æºç ï¼Œæ·±å…¥åˆ†æå„ç§ç¼–è¯‘å‘½ä»¤çš„åŸç†ã€å®ç°æœºåˆ¶å’Œé€‚ç”¨åœºæ™¯ã€‚ ç¼–è¯‘å‘½ä»¤å¯¹æ¯”è¡¨ å‘½ä»¤ ä½œç”¨ è¾“å‡ºæ ¼å¼ éƒ¨ç½²æ–¹å¼ é€‚ç”¨åœºæ™¯ make åŸºç¡€ç¼–è¯‘ æºç ç›®å½• + beam æ–‡ä»¶ å¼€å‘è°ƒè¯• æœ¬åœ°å¼€å‘ã€è°ƒè¯• make dist æ‰“åŒ…æ–‡ä»¶ æ’ä»¶ç›®å½•ç»“æ„ ç›®å½•éƒ¨ç½² ç”Ÿäº§ç¯å¢ƒã€æ’ä»¶å¼€å‘ make dist DIST_AS_EZS=true æ‰“åŒ…æˆ ez æ–‡ä»¶ .ez å‹ç¼©åŒ… æ’ä»¶å®‰è£… æ’ä»¶åˆ†å‘ã€çƒ­åŠ è½½ make package-generic-unix æ‰“åŒ…æˆ PACKAGE æ–‡ä»¶ tar.xz åŒ… è§£å‹å®‰è£… å®¹å™¨ã€è·¨å¹³å° make install ç³»ç»Ÿå®‰è£… ç³»ç»Ÿç›®å½• ç³»ç»Ÿå®‰è£… ç”Ÿäº§éƒ¨ç½² 1. make - åŸºç¡€ç¼–è¯‘æŠ€æœ¯åŸç†åŸºäº erlang.mk æ„å»ºç³»ç»Ÿï¼Œæ‰§è¡Œ Erlang&#x2F;OTP æ ‡å‡†ç¼–è¯‘æµç¨‹ã€‚ æ ¸å¿ƒå®ç°æœºåˆ¶123456# æ¥æºï¼šMakefile (ç¬¬ 77 è¡Œ)include erlang.mk# æ¥æºï¼šerlang.mk æ ¸å¿ƒé€»è¾‘app:: deps $(PROJECT).d $(verbose) $(MAKE) --no-print-directory app-build ç¼–è¯‘æµç¨‹1234567891011make â†“è§£æä¾èµ– â†“ç¼–è¯‘ deps/ â†“ç¼–è¯‘ .erl â†’ .beam â†“ç”Ÿæˆå¯åŠ¨è„šæœ¬ â†“åˆ›å»º sbin/ ç›®å½• ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„12345678910rabbitmq-server/â”œâ”€â”€ deps/ # ä¾èµ–æ¨¡å—â”‚ â”œâ”€â”€ rabbit/ebin/*.beam # æ ¸å¿ƒæ¨¡å—å­—èŠ‚ç â”‚ â”œâ”€â”€ rabbit_common/ebin/*.beam # å…¬å…±æ¨¡å—å­—èŠ‚ç â”‚ â””â”€â”€ */ebin/*.beam # å…¶ä»–æ’ä»¶å­—èŠ‚ç â”œâ”€â”€ sbin/ # å¯åŠ¨è„šæœ¬â”‚ â”œâ”€â”€ rabbitmq-server # ä¸»æœåŠ¡å™¨è„šæœ¬â”‚ â”œâ”€â”€ rabbitmqctl # ç®¡ç†å·¥å…·â”‚ â””â”€â”€ rabbitmq-plugins # æ’ä»¶ç®¡ç†â””â”€â”€ escript/ # Erlang è„šæœ¬ é€‚ç”¨åœºæ™¯ å¼€å‘è°ƒè¯•: å¿«é€Ÿç¼–è¯‘ï¼Œæ”¯æŒå¢é‡æ„å»º æºç ä¿®æ”¹: ç›´æ¥ä¿®æ”¹æºç åé‡æ–°ç¼–è¯‘ æ€§èƒ½æµ‹è¯•: æœ€å°åŒ–çš„ç¼–è¯‘å¼€é”€ 2. make dist - æ’ä»¶ç›®å½•åˆ†å‘æŠ€æœ¯åŸç†åŸºäº rabbitmq-dist.mk å®ç°æ’ä»¶æ‰“åŒ…æœºåˆ¶ï¼Œåˆ›å»ºæ ‡å‡†çš„ RabbitMQ æ’ä»¶ç›®å½•ç»“æ„ã€‚ æ ¸å¿ƒå®ç°æºç 1234567891011121314# æ¥æºï¼šdeps/rabbit_common/mk/rabbitmq-dist.mk (ç¬¬ 166 è¡Œ)dist:: $(ERLANG_MK_RECURSIVE_DEPS_LIST) all $(verbose) rm -rf $(DIST_DIR) $(verbose) mkdir -p $(DIST_DIR) $(gen_verbose) $(MAKE) --no-print-directory do-dist# æ’ä»¶ç›®å½•åˆ›å»ºé€»è¾‘ (ç¬¬ 48-54 è¡Œ)dist_$(1)_ez_dir = $$(if $(2),$(DIST_DIR)/$(1)-$(2), \\ $$(if $$(VERSION),$(DIST_DIR)/$(1)-$$(VERSION),$(DIST_DIR)/$(1)))ifeq ($(DIST_AS_EZS),)dist_$(1)_ez = $$(dist_$(1)_ez_dir) # ç›®å½•æ ¼å¼elsedist_$(1)_ez = $$(dist_$(1)_ez_dir).ez # EZ æ ¼å¼endif æ‰“åŒ…æµç¨‹ ç¼–è¯‘æ‰€æœ‰æ¨¡å— - ç¡®ä¿æ‰€æœ‰ .erl æ–‡ä»¶ç¼–è¯‘ä¸º .beam æ”¶é›†ä¾èµ– - å°†æ‰€æœ‰æ’ä»¶å’Œä¾èµ–æ”¶é›†åˆ° plugins/ ç›®å½• ç”Ÿæˆæ’ä»¶ç»“æ„ - æ¯ä¸ªæ’ä»¶åŒ…å« ebin/ã€priv/ ç­‰æ ‡å‡†ç›®å½• åˆ›å»ºå…ƒæ•°æ® - ç”Ÿæˆ .app æ–‡ä»¶æè¿°æ’ä»¶ä¿¡æ¯ ç”Ÿæˆçš„ç›®å½•ç»“æ„1234567891011plugins/â”œâ”€â”€ rabbit-4.0.5/ # æ ¸å¿ƒæ¨¡å—ç›®å½•â”‚ â”œâ”€â”€ ebin/â”‚ â”‚ â”œâ”€â”€ rabbit.app # åº”ç”¨æè¿°æ–‡ä»¶â”‚ â”‚ â”œâ”€â”€ rabbit.beam # ç¼–è¯‘åçš„å­—èŠ‚ç â”‚ â”‚ â””â”€â”€ *.beam # å…¶ä»–æ¨¡å—å­—èŠ‚ç â”‚ â”œâ”€â”€ include/ # å¤´æ–‡ä»¶â”‚ â””â”€â”€ priv/ # ç§æœ‰èµ„æºâ”œâ”€â”€ rabbitmq_management-4.0.5/ # ç®¡ç†æ’ä»¶ç›®å½•â”œâ”€â”€ rabbitmq_prometheus-4.0.5/ # ç›‘æ§æ’ä»¶ç›®å½•â””â”€â”€ ... # å…¶ä»–æ’ä»¶ç›®å½• ç›®å½• vs EZ æ ¼å¼å¯¹æ¯” ç‰¹æ€§ ç›®å½•æ ¼å¼ EZ æ ¼å¼ å­˜å‚¨ å±•å¼€çš„æ–‡ä»¶å¤¹ å‹ç¼©çš„ ZIP æ–‡ä»¶ åŠ è½½é€Ÿåº¦ å¿«é€Ÿ ç•¥æ…¢ï¼ˆéœ€è§£å‹ï¼‰ è°ƒè¯• å®¹æ˜“ï¼ˆç›´æ¥è®¿é—®æ–‡ä»¶ï¼‰ å›°éš¾ï¼ˆéœ€è§£å‹æŸ¥çœ‹ï¼‰ åˆ†å‘ å ç”¨ç©ºé—´å¤§ å ç”¨ç©ºé—´å° çƒ­åŠ è½½ æ”¯æŒ æ›´å¥½æ”¯æŒ 3. make dist DIST_AS_EZS=true - EZ å‹ç¼©åŒ…åˆ†å‘æŠ€æœ¯åŸç†EZ æ ¼å¼æ˜¯ Erlang çš„æ ‡å‡†æ’ä»¶æ‰“åŒ…æ ¼å¼ï¼Œæœ¬è´¨ä¸Šæ˜¯é‡å‘½åçš„ ZIP æ–‡ä»¶ã€‚ æ ¸å¿ƒå®ç°é€»è¾‘12345678# æ¥æºï¼šdeps/rabbit_common/mk/rabbitmq-dist.mk (ç¬¬ 8-14 è¡Œ)# Set $(DIST_AS_EZS) to a non-empty value to enable the packaging of# plugins as .ez archives.ifeq ($(USE_RABBIT_BOOT_SCRIPT),)DIST_AS_EZS ?= # é»˜è®¤ä¸ºç©ºï¼ˆç›®å½•æ ¼å¼ï¼‰elseDIST_AS_EZS = # å¼ºåˆ¶ç›®å½•æ ¼å¼endif EZ æ–‡ä»¶ç”Ÿæˆè¿‡ç¨‹12345678910111213make dist DIST_AS_EZS=true â†“ç¼–è¯‘æ‰€æœ‰æ¨¡å— â†“æ”¶é›† ebin/ include/ priv/ â†“åˆ›å»ºä¸´æ—¶ç›®å½•ç»“æ„ â†“ZIP å‹ç¼© â†“é‡å‘½åä¸º .ez â†“ç§»åŠ¨åˆ° plugins/ å®é™…ç”Ÿæˆçš„ EZ æ–‡ä»¶1234567plugins/â”œâ”€â”€ rabbit-4.0.5.ez # 3.38 MB - æ ¸å¿ƒæ¨¡å—â”œâ”€â”€ rabbit_common-4.0.5.ez # 770.91 KB - å…¬å…±æ¨¡å— â”œâ”€â”€ rabbitmq_management-4.0.5.ez # ç®¡ç†ç•Œé¢æ’ä»¶â”œâ”€â”€ rabbitmq_prometheus-4.0.5.ez # ç›‘æ§æ’ä»¶â”œâ”€â”€ amqp_client-4.0.5.ez # AMQP å®¢æˆ·ç«¯â””â”€â”€ ... # å…¶ä»–æ’ä»¶ EZ æ–‡ä»¶ EZ æ–‡ä»¶å†…éƒ¨ç»“æ„12345678# EZ æ–‡ä»¶å®é™…ä¸Šæ˜¯ ZIP æ ¼å¼$ unzip -l rabbit-4.0.5.ezArchive: rabbit-4.0.5.ez Length Date Time Name--------- ---------- ----- ---- 1234 2025-01-16 22:05 rabbit-4.0.5/ebin/rabbit.app 45678 2025-01-16 22:05 rabbit-4.0.5/ebin/rabbit.beam ... EZ æ ¼å¼ä¼˜åŠ¿ å‹ç¼©å­˜å‚¨: å‡å°‘ç£ç›˜å ç”¨å’Œç½‘ç»œä¼ è¾“ åŸå­æ€§: å•æ–‡ä»¶éƒ¨ç½²ï¼Œé¿å…éƒ¨åˆ†æ–‡ä»¶ä¸¢å¤± ç‰ˆæœ¬ç®¡ç†: æ–‡ä»¶ååŒ…å«ç‰ˆæœ¬ä¿¡æ¯ çƒ­åŠ è½½: Erlang VM åŸç”Ÿæ”¯æŒ EZ æ–‡ä»¶çƒ­åŠ è½½ 4. make package-generic-unix - é€šç”¨ Unix åŒ…æŠ€æœ¯åŸç†åˆ›å»ºè·¨å¹³å°çš„ tar.xz å®‰è£…åŒ…ï¼ŒåŒ…å«å®Œæ•´çš„ RabbitMQ è¿è¡Œç¯å¢ƒã€‚ æ ¸å¿ƒå®ç°æºç 123456789101112131415161718192021222324# æ¥æºï¼špackaging/generic-unix/Makefile (ç¬¬ 33-76 è¡Œ)SOURCE_DIR = rabbitmq-server-$(VERSION)TARGET_DIR = rabbitmq_server-$(VERSION)TARGET_TARBALL = rabbitmq-server-$(TARBALL_SUFFIX)-$(VERSION)dist: # è§£å‹æºç åŒ… xzcat $(SOURCE_DIST_FILE) | tar -xf - # ç¼–è¯‘å¹¶å®‰è£…åˆ°ç›®æ ‡ç›®å½• $(MAKE) -C $(SOURCE_DIR) \\ PREFIX= RMQ_ROOTDIR= \\ RMQ_ERLAPP_DIR=`pwd`/$(TARGET_DIR) \\ MANDIR=`pwd`/$(TARGET_DIR)/share/man \\ manpages web-manpages install install-man # ä¿®æ”¹é…ç½®æ–‡ä»¶ sed -e &#x27;s:^SYS_PREFIX=$$:SYS_PREFIX=\\$$&#123;RABBITMQ_HOME&#125;:&#x27; \\ $(TARGET_DIR)/sbin/rabbitmq-defaults &gt;$(TARGET_DIR)/sbin/rabbitmq-defaults.tmp # åˆ›å»º tar.xz åŒ… find $(TARGET_DIR) | LC_COLLATE=C sort &gt; $(TARGET_TARBALL).manifest tar --no-recursion -T $(TARGET_TARBALL).manifest -cf - | \\ xz &gt; $(CURDIR)/$(TARGET_TARBALL).tar.xz æ‰“åŒ…æµç¨‹ è§£å‹æºç åŒ… - ä» tar.xz æºç åŒ…å¼€å§‹ ç¼–è¯‘å®‰è£… - ä½¿ç”¨æ ‡å‡† Unix å®‰è£…è·¯å¾„ ç”Ÿæˆæ–‡æ¡£ - åˆ›å»º man æ‰‹å†Œé¡µ é…ç½®è„šæœ¬ - è°ƒæ•´å¯åŠ¨è„šæœ¬çš„è·¯å¾„å˜é‡ åˆ›å»ºå½’æ¡£ - æ‰“åŒ…æˆ tar.xz æ ¼å¼ ç”Ÿæˆçš„åŒ…ç»“æ„123456# å®é™…ç”Ÿæˆï¼šPACKAGES/PACKAGES/â”œâ”€â”€ rabbitmq-server-4.0.5.tar.xz # 4.95 MB - æºç åŒ…â”œâ”€â”€ rabbitmq-server-generic-unix-4.0.5.tar.xz # 15.51 MB - é€šç”¨åŒ…â”œâ”€â”€ rabbitmq-server-4.0.5.manifest # 230.22 KB - æ–‡ä»¶æ¸…å•â””â”€â”€ rabbitmq-server-4.0.5/ # è§£å‹åçš„æºç ç›®å½• é€šç”¨åŒ…å†…å®¹åˆ†æ12345678910# è§£å‹é€šç”¨åŒ…åçš„ç›®å½•ç»“æ„rabbitmq_server-4.0.5/â”œâ”€â”€ sbin/ # å¯åŠ¨è„šæœ¬â”‚ â”œâ”€â”€ rabbitmq-server # å·²é…ç½® RABBITMQ_HOMEâ”‚ â”œâ”€â”€ rabbitmqctlâ”‚ â””â”€â”€ ...â”œâ”€â”€ plugins/ # æ’ä»¶ç›®å½•â”œâ”€â”€ etc/rabbitmq/ # é…ç½®ç›®å½•â”œâ”€â”€ share/man/ # æ‰‹å†Œé¡µâ””â”€â”€ escript/ # CLI å·¥å…· é€šç”¨åŒ…ç‰¹ç‚¹ è‡ªåŒ…å«: åŒ…å«æ‰€æœ‰è¿è¡Œæ—¶ä¾èµ– å¯ç§»æ¤: é€‚ç”¨äºå„ç§ Unix ç³»ç»Ÿ æ ‡å‡†åŒ–: éµå¾ª Unix ç›®å½•ç»“æ„è§„èŒƒ ç”Ÿäº§å°±ç»ª: åŒ…å«å®Œæ•´çš„é…ç½®å’Œæ–‡æ¡£ 5. make install - ç³»ç»Ÿçº§å®‰è£…æŠ€æœ¯åŸç†å°† RabbitMQ å®‰è£…åˆ°ç³»ç»Ÿæ ‡å‡†ç›®å½•ï¼Œéµå¾ª FHS (Filesystem Hierarchy Standard)ã€‚ æ ¸å¿ƒå®ç°é€»è¾‘12345678910111213141516# æ¥æºï¼šMakefile ç¬¬ 489-523 è¡ŒPREFIX ?= /usr/localRMQ_ROOTDIR ?= $(PREFIX)/lib/erlangRMQ_BINDIR ?= $(RMQ_ROOTDIR)/binRMQ_LIBDIR ?= $(RMQ_ROOTDIR)/libRMQ_ERLAPP_DIR ?= $(RMQ_LIBDIR)/rabbitmq_server-$(PROJECT_VERSION)install: install-erlapp install-scriptsinstall-erlapp: dist $(verbose) mkdir -p $(DESTDIR)$(RMQ_ERLAPP_DIR) $(inst_verbose) cp -r \\ LICENSE* \\ $(DEPS_DIR)/rabbit/INSTALL \\ $(DIST_DIR) \\ $(DESTDIR)$(RMQ_ERLAPP_DIR) ç³»ç»Ÿå®‰è£…ç›®å½•ç»“æ„1234567891011121314151617181920# å…¸å‹çš„ç³»ç»Ÿå®‰è£…è·¯å¾„/usr/local/â”œâ”€â”€ bin/ # å¯æ‰§è¡Œæ–‡ä»¶â”‚ â”œâ”€â”€ rabbitmq-serverâ”‚ â”œâ”€â”€ rabbitmqctlâ”‚ â””â”€â”€ ...â”œâ”€â”€ lib/ # åº“æ–‡ä»¶â”‚ â””â”€â”€ erlang/lib/â”‚ â””â”€â”€ rabbitmq_server-4.0.5/â”‚ â”œâ”€â”€ ebin/ # å­—èŠ‚ç æ–‡ä»¶â”‚ â”œâ”€â”€ include/ # å¤´æ–‡ä»¶â”‚ â””â”€â”€ plugins/ # æ’ä»¶ç›®å½•â”œâ”€â”€ etc/ # é…ç½®æ–‡ä»¶â”‚ â””â”€â”€ rabbitmq/â”‚ â””â”€â”€ rabbitmq.confâ”œâ”€â”€ var/ # æ•°æ®ç›®å½•â”‚ â”œâ”€â”€ log/rabbitmq/ # æ—¥å¿—â”‚ â””â”€â”€ lib/rabbitmq/ # æ•°æ®åº“â””â”€â”€ share/ # æ–‡æ¡£ â””â”€â”€ man/ # æ‰‹å†Œé¡µ å®‰è£…ç»„ä»¶ æ ¸å¿ƒåº”ç”¨ (install-erlapp) å¯åŠ¨è„šæœ¬ (install-scripts) å‘½ä»¤è¡Œå·¥å…· (install-bin) æ‰‹å†Œé¡µ (install-man) ç³»ç»Ÿå®‰è£…ä¼˜åŠ¿ æ ‡å‡†åŒ–: éµå¾ª Unix æ ‡å‡†ç›®å½•ç»“æ„ å¤šç”¨æˆ·: æ”¯æŒç³»ç»Ÿçº§å¤šç”¨æˆ·è®¿é—® æœåŠ¡é›†æˆ: ä¾¿äºé›†æˆåˆ°ç³»ç»ŸæœåŠ¡ç®¡ç† æƒé™ç®¡ç†: åˆ©ç”¨ç³»ç»Ÿæƒé™æ§åˆ¶ æ„å»ºç³»ç»Ÿæ¶æ„æ ¸å¿ƒç»„ä»¶1. erlang.mk ä½œç”¨: Erlang é¡¹ç›®çš„æ ‡å‡†æ„å»ºå·¥å…· åŠŸèƒ½: ä¾èµ–ç®¡ç†ã€ç¼–è¯‘ã€æµ‹è¯•ã€å‘å¸ƒ 2. rabbitmq-components.mk ä½œç”¨: RabbitMQ ç‰¹å®šçš„æ„å»ºè§„åˆ™ åŠŸèƒ½: ç‰ˆæœ¬ç®¡ç†ã€æ’ä»¶ç³»ç»Ÿã€å‘å¸ƒæµç¨‹ 3. rabbitmq-dist.mk ä½œç”¨: æ’ä»¶åˆ†å‘æœºåˆ¶ åŠŸèƒ½: EZ æ‰“åŒ…ã€æ’ä»¶ä¾èµ–ã€ç‰ˆæœ¬æ§åˆ¶ å…³é”®é…ç½®æ–‡ä»¶Makefile - ä¸»æ§åˆ¶æ–‡ä»¶1234567891011# æ¥æºï¼šMakefile (ç¬¬ 1-30 è¡Œ)PROJECT = rabbitmq_server_releasePROJECT_DESCRIPTION = RabbitMQ Server# æ’ä»¶åˆ—è¡¨include plugins.mkDEPS = rabbit_common rabbit $(PLUGINS) $(ADDITIONAL_PLUGINS)# æ„å»ºç³»ç»Ÿinclude rabbitmq-components.mkinclude erlang.mk plugins.mk - æ’ä»¶å®šä¹‰12345678910# æ¥æºï¼šplugins.mkPLUGINS = \\ rabbitmq_amqp1_0 \\ rabbitmq_auth_backend_cache \\ rabbitmq_auth_backend_http \\ rabbitmq_auth_backend_ldap \\ rabbitmq_auth_backend_oauth2 \\ rabbitmq_auth_mechanism_ssl \\ rabbitmq_consistent_hash_exchange \\ # ... æ›´å¤šæ’ä»¶ ç¼–è¯‘æµç¨‹å¯¹æ¯”æ€§èƒ½å’Œèµ„æºå¯¹æ¯” ç¼–è¯‘æ–¹å¼ ç¼–è¯‘æ—¶é—´ ç£ç›˜å ç”¨ å†…å­˜ä½¿ç”¨ ç½‘ç»œä¼ è¾“ make æœ€å¿« ä¸­ç­‰ ä½ ä¸é€‚ç”¨ make dist å¿« å¤§ ä¸­ç­‰ å¤§ make dist DIST_AS_EZS=true ä¸­ç­‰ å° ä¸­ç­‰ å° make package-generic-unix æ…¢ æœ€å° é«˜ æœ€å° make install ä¸­ç­‰ ä¸­ç­‰ ä½ ä¸é€‚ç”¨ æœ€ä½³å®è·µæŒ‡å—å¼€å‘é˜¶æ®µ12345678910# å¿«é€Ÿå¼€å‘è¿­ä»£make clean &amp;&amp; makesbin/rabbitmq-server# æ’ä»¶å¼€å‘make dist# æµ‹è¯•æ’ä»¶åŠ è½½# å¼€å‘è°ƒè¯•make shell æµ‹è¯•é˜¶æ®µ1234567# å®Œæ•´åŠŸèƒ½æµ‹è¯•make dist DIST_AS_EZS=true# éªŒè¯ EZ æ–‡ä»¶åŠ è½½# é›†æˆæµ‹è¯•make package-generic-unix# åœ¨ä¸åŒç¯å¢ƒæµ‹è¯•å®‰è£…åŒ… ç”Ÿäº§éƒ¨ç½²1234567# å®¹å™¨åŒ–éƒ¨ç½²make package-generic-unix# ä½¿ç”¨ tar.xz åŒ…æ„å»º Docker é•œåƒ# ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½² make install PREFIX=/opt/rabbitmq# ç³»ç»Ÿçº§å®‰è£… æ’ä»¶åˆ†å‘1234567# æ’ä»¶å¼€å‘è€…make dist DIST_AS_EZS=true# ç”Ÿæˆ .ez æ–‡ä»¶ç”¨äºåˆ†å‘# æ’ä»¶ç”¨æˆ·rabbitmq-plugins enable plugin_name# ä» .ez æ–‡ä»¶å®‰è£…æ’ä»¶ é«˜çº§é…ç½®é€‰é¡¹ç¯å¢ƒå˜é‡æ§åˆ¶1234567891011# è‡ªå®šä¹‰æ’ä»¶ç›®å½•export DIST_DIR=/custom/plugins/pathmake dist# è‡ªå®šä¹‰åŒ…è¾“å‡ºç›®å½•export PACKAGES_DIR=/custom/packages/path make package-generic-unix# å¯ç”¨ç¤¾åŒºæ’ä»¶export COMMUNITY_PLUGINS=1make dist ç¼–è¯‘ä¼˜åŒ–12345678# å¹¶è¡Œç¼–è¯‘make -j$(nproc) dist# è¯¦ç»†è¾“å‡ºmake V=1 dist# è·³è¿‡æµ‹è¯•make SKIP_TESTS=1 dist æºç å…³é”®æ–‡ä»¶ç´¢å¼• æ–‡ä»¶ ä½œç”¨ å…³é”®å†…å®¹ Makefile ä¸»æ„å»ºæ–‡ä»¶ ç›®æ ‡å®šä¹‰ã€å˜é‡è®¾ç½® erlang.mk Erlang æ„å»ºç³»ç»Ÿ ç¼–è¯‘è§„åˆ™ã€ä¾èµ–ç®¡ç† rabbitmq-components.mk RabbitMQ æ„å»ºè§„åˆ™ ç‰ˆæœ¬æ§åˆ¶ã€ç»„ä»¶ç®¡ç† deps/rabbit_common/mk/rabbitmq-dist.mk åˆ†å‘ç³»ç»Ÿ æ’ä»¶æ‰“åŒ…ã€EZ æ ¼å¼ packaging/generic-unix/Makefile Unix æ‰“åŒ… å®‰è£…å¸ƒå±€ã€è„šæœ¬é…ç½® plugins.mk æ’ä»¶åˆ—è¡¨ æ‰€æœ‰å®˜æ–¹æ’ä»¶å®šä¹‰ æ€»ç»“RabbitMQ çš„æ„å»ºç³»ç»Ÿè®¾è®¡ç²¾è‰¯ï¼Œé€šè¿‡ä¸åŒçš„ç¼–è¯‘å‘½ä»¤æ»¡è¶³äº†ä»å¼€å‘åˆ°ç”Ÿäº§çš„å„ç§éœ€æ±‚ï¼š make - å¼€å‘åŸºç¡€ï¼Œå¿«é€Ÿè¿­ä»£ make dist - ç”Ÿäº§æ ‡å‡†ï¼Œç›®å½•éƒ¨ç½² make dist DIST_AS_EZS=true - æ’ä»¶åˆ†å‘ï¼Œå‹ç¼©é«˜æ•ˆ make package-generic-unix - è·¨å¹³å°éƒ¨ç½²ï¼Œè‡ªåŒ…å« make install - ç³»ç»Ÿé›†æˆï¼Œæ ‡å‡†åŒ–å®‰è£… ç†è§£è¿™äº›ç¼–è¯‘æ–¹å¼çš„åŸç†ï¼Œæœ‰åŠ©äºæ›´å¥½åœ°è¿›è¡Œ RabbitMQ çš„å¼€å‘ã€éƒ¨ç½²å’Œè¿ç»´å·¥ä½œã€‚é€‰æ‹©åˆé€‚çš„ç¼–è¯‘æ–¹å¼ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡ RabbitMQ çš„å¼€å‘æ•ˆç‡å’Œéƒ¨ç½²è´¨é‡ã€‚","categories":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/RabbitMQ/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"ç¼–è¯‘","slug":"ç¼–è¯‘","permalink":"https://hzsunzixiang.github.io/tags/%E7%BC%96%E8%AF%91/"},{"name":"æ„å»ºç³»ç»Ÿ","slug":"æ„å»ºç³»ç»Ÿ","permalink":"https://hzsunzixiang.github.io/tags/%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"https://hzsunzixiang.github.io/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"}]},{"title":"RabbitMQ æ’ä»¶å¯ç”¨é—®é¢˜æ’æŸ¥æŒ‡å—","slug":"rabbitmq-rabbitmq-plugins-enable-guide","date":"2026-01-16T13:00:00.000Z","updated":"2026-01-16T13:59:04.995Z","comments":true,"path":"2026/01/16/rabbitmq-rabbitmq-plugins-enable-guide/","permalink":"https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-plugins-enable-guide/","excerpt":"","text":"RabbitMQ æ’ä»¶å¯ç”¨é—®é¢˜æ’æŸ¥æŒ‡å—é—®é¢˜æè¿°ä»æºç ç¼–è¯‘è¿è¡Œ RabbitMQ æ—¶ï¼Œæ‰§è¡Œæ’ä»¶å¯ç”¨å‘½ä»¤æŠ¥é”™ï¼š 12345678$ sbin/rabbitmq-plugins enable rabbitmq_managementError: :plugins_dir_does_not_existArguments given: enable rabbitmq_managementUsagerabbitmq-plugins [--node &lt;node&gt;] [--longnames] [--quiet] enable &lt;plugin1&gt; [ &lt;plugin2&gt;] | --all [--offline] [--online] å³ä½¿è®¾ç½®äº† ERL_LIBS ç¯å¢ƒå˜é‡ä¹Ÿæ— æ³•è§£å†³ï¼š 12$ echo $ERL_LIBS/Users/ericksun/workspace/rabbitmq-server/plugins æ ¹å› åˆ†æERL_LIBS ä¸ RABBITMQ_PLUGINS_DIR çš„åŒºåˆ« ç¯å¢ƒå˜é‡ ä½œç”¨ ä½¿ç”¨è€… ERL_LIBS å‘Šè¯‰ Erlang VM åœ¨å“ªé‡ŒæŸ¥æ‰¾ä»£ç æ¨¡å— Erlang è¿è¡Œæ—¶ RABBITMQ_PLUGINS_DIR å‘Šè¯‰ rabbitmq-plugins è„šæœ¬æ’ä»¶ç›®å½•ä½ç½® RabbitMQ è„šæœ¬ RABBITMQ_ENABLED_PLUGINS_FILE æŒ‡å®šå¯ç”¨æ’ä»¶é…ç½®æ–‡ä»¶çš„ä½ç½® RabbitMQ è„šæœ¬ ERL_LIBS åªæ˜¯è®© Erlang èƒ½æ‰¾åˆ°ä»£ç ï¼Œä½† rabbitmq-plugins è„šæœ¬éœ€è¦ RABBITMQ_PLUGINS_DIR æ¥å®šä½æ’ä»¶ç›®å½•ã€‚ é»˜è®¤è·¯å¾„é—®é¢˜ä»æºç è¿è¡Œæ—¶ï¼ŒRabbitMQ é»˜è®¤æŸ¥æ‰¾ï¼š æ’ä»¶ç›®å½•ï¼šç”± RABBITMQ_HOME/plugins æˆ– RABBITMQ_PLUGINS_DIR æŒ‡å®š å¯ç”¨æ’ä»¶æ–‡ä»¶ï¼š/etc/rabbitmq/enabled_pluginsï¼ˆç³»ç»Ÿè·¯å¾„ï¼Œæºç ç¯å¢ƒä¸‹ä¸å­˜åœ¨ï¼‰ è§£å†³æ–¹æ¡ˆæ–¹æ¡ˆä¸€ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰åœ¨ shell é…ç½®æ–‡ä»¶ï¼ˆå¦‚ ~/.bashrc æˆ– ~/.zshrcï¼‰ä¸­æ·»åŠ ï¼š 1234# RabbitMQ æºç å¼€å‘ç¯å¢ƒé…ç½®export RABBITMQ_HOME=/path/to/rabbitmq-serverexport RABBITMQ_PLUGINS_DIR=$RABBITMQ_HOME/pluginsexport RABBITMQ_ENABLED_PLUGINS_FILE=$RABBITMQ_HOME/etc/rabbitmq/enabled_plugins ç„¶ååˆ›å»ºå¿…è¦çš„ç›®å½•ï¼š 1mkdir -p $RABBITMQ_HOME/etc/rabbitmq æ–¹æ¡ˆäºŒï¼šå‘½ä»¤è¡ŒæŒ‡å®šï¼ˆä¸´æ—¶ä½¿ç”¨ï¼‰123456789cd /path/to/rabbitmq-server# åˆ›å»ºé…ç½®ç›®å½•mkdir -p etc/rabbitmq# å¯ç”¨æ’ä»¶ï¼ˆä½¿ç”¨ --offline æ¨¡å¼ï¼Œä¸éœ€è¦è¿æ¥è¿è¡Œä¸­çš„èŠ‚ç‚¹ï¼‰RABBITMQ_PLUGINS_DIR=$(pwd)/plugins \\RABBITMQ_ENABLED_PLUGINS_FILE=$(pwd)/etc/rabbitmq/enabled_plugins \\sbin/rabbitmq-plugins enable rabbitmq_management --offline æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ make å‘½ä»¤RabbitMQ æºç æä¾›äº†ä¾¿æ·çš„ make ç›®æ ‡ï¼š 12# å¯åŠ¨å¸¦ç®¡ç†æ’ä»¶çš„å¼€å‘èŠ‚ç‚¹make run-broker RABBITMQ_ENABLED_PLUGINS=&quot;rabbitmq_management&quot; æˆåŠŸæ‰§è¡Œç¤ºä¾‹12345678910111213141516171819$ RABBITMQ_PLUGINS_DIR=$(pwd)/plugins \\ RABBITMQ_ENABLED_PLUGINS_FILE=$(pwd)/etc/rabbitmq/enabled_plugins \\ sbin/rabbitmq-plugins enable rabbitmq_management --offlineEnabling plugins on node rabbit@ERICKSUN-MC1:rabbitmq_managementThe following plugins have been configured: rabbitmq_management rabbitmq_management_agent rabbitmq_web_dispatchApplying plugin configuration to rabbit@ERICKSUN-MC1...The following plugins have been enabled: rabbitmq_management rabbitmq_management_agent rabbitmq_web_dispatchset 3 plugins.Offline change; changes will take effect at broker restart. å¸¸ç”¨æ’ä»¶å‘½ä»¤123456789101112131415161718# è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆå‡è®¾å·²åœ¨ rabbitmq-server ç›®å½•ï¼‰export RABBITMQ_PLUGINS_DIR=$(pwd)/pluginsexport RABBITMQ_ENABLED_PLUGINS_FILE=$(pwd)/etc/rabbitmq/enabled_plugins# åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ’ä»¶sbin/rabbitmq-plugins list# åˆ—å‡ºå·²å¯ç”¨çš„æ’ä»¶sbin/rabbitmq-plugins list --enabled# å¯ç”¨æ’ä»¶ï¼ˆç¦»çº¿æ¨¡å¼ï¼‰sbin/rabbitmq-plugins enable rabbitmq_management --offline# ç¦ç”¨æ’ä»¶sbin/rabbitmq-plugins disable rabbitmq_management --offline# å¯ç”¨å¤šä¸ªæ’ä»¶sbin/rabbitmq-plugins enable rabbitmq_management rabbitmq_shovel --offline å¸¸è§æ’ä»¶è¯´æ˜ æ’ä»¶åç§° åŠŸèƒ½æè¿° rabbitmq_management Web ç®¡ç†ç•Œé¢ï¼Œé»˜è®¤ç«¯å£ 15672 rabbitmq_management_agent ç®¡ç†æ’ä»¶çš„ä»£ç†ï¼ˆè‡ªåŠ¨ä¾èµ–ï¼‰ rabbitmq_web_dispatch Web è¯·æ±‚åˆ†å‘ï¼ˆè‡ªåŠ¨ä¾èµ–ï¼‰ rabbitmq_shovel æ¶ˆæ¯è½¬å‘&#x2F;å¤åˆ¶ rabbitmq_federation è·¨é›†ç¾¤æ¶ˆæ¯è”é‚¦ rabbitmq_mqtt MQTT åè®®æ”¯æŒ rabbitmq_stomp STOMP åè®®æ”¯æŒ æ€»ç»“ä»æºç è¿è¡Œ RabbitMQ æ—¶ï¼Œéœ€è¦æ­£ç¡®è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š RABBITMQ_PLUGINS_DIR - æŒ‡å‘ plugins ç›®å½• RABBITMQ_ENABLED_PLUGINS_FILE - æŒ‡å‘æœ¬åœ°çš„ enabled_plugins æ–‡ä»¶ ERL_LIBS ç¯å¢ƒå˜é‡åªå½±å“ Erlang ä»£ç åŠ è½½è·¯å¾„ï¼Œä¸èƒ½æ›¿ä»£ RabbitMQ è‡ªèº«çš„é…ç½®å˜é‡ã€‚","categories":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/RabbitMQ/"}],"tags":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"é—®é¢˜æ’æŸ¥","slug":"é—®é¢˜æ’æŸ¥","permalink":"https://hzsunzixiang.github.io/tags/%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/"},{"name":"æ’ä»¶","slug":"æ’ä»¶","permalink":"https://hzsunzixiang.github.io/tags/%E6%8F%92%E4%BB%B6/"},{"name":"æºç ç¼–è¯‘","slug":"æºç ç¼–è¯‘","permalink":"https://hzsunzixiang.github.io/tags/%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/"}]},{"title":"RabbitMQ é—®é¢˜æœ€ç»ˆè§£å†³æ–¹æ¡ˆæ€»ç»“","slug":"rabbitmq-rabbitmq-final-solution-summary","date":"2026-01-16T08:00:00.000Z","updated":"2026-01-16T12:55:17.321Z","comments":true,"path":"2026/01/16/rabbitmq-rabbitmq-final-solution-summary/","permalink":"https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-final-solution-summary/","excerpt":"RabbitMQ é—®é¢˜æœ€ç»ˆè§£å†³æ–¹æ¡ˆæ€»ç»“çœŸæ­£çš„æ ¹æœ¬åŸå› ï¼šç½‘ç»œé…ç½®é—®é¢˜é—®é¢˜çœŸç›¸ç»è¿‡æ·±å…¥è°ƒè¯•ï¼Œå‘ç°é—®é¢˜çš„çœŸæ­£æ ¹æœ¬åŸå› æ˜¯ hosts æ–‡ä»¶é…ç½®é”™è¯¯ï¼š","text":"RabbitMQ é—®é¢˜æœ€ç»ˆè§£å†³æ–¹æ¡ˆæ€»ç»“çœŸæ­£çš„æ ¹æœ¬åŸå› ï¼šç½‘ç»œé…ç½®é—®é¢˜é—®é¢˜çœŸç›¸ç»è¿‡æ·±å…¥è°ƒè¯•ï¼Œå‘ç°é—®é¢˜çš„çœŸæ­£æ ¹æœ¬åŸå› æ˜¯ hosts æ–‡ä»¶é…ç½®é”™è¯¯ï¼š 1234# é”™è¯¯çš„ hosts é…ç½®å¯¼è‡´ä¸»æœºåè§£æé—®é¢˜#10.91.28.159 ERICKSUN-MC1 # è¢«æ³¨é‡Šçš„æ—§IP#192.168.1.3 ERICKSUN-MC1 # è¢«æ³¨é‡Šçš„æ—§IP 192.168.0.101 ERICKSUN-MC1 # æ­£ç¡®çš„å½“å‰IP ä¸ºä»€ä¹ˆä¼šå¯¼è‡´ EPMD é”™è¯¯ ä¸»æœºåè§£æ: RabbitMQ ä½¿ç”¨ ERICKSUN-MC1 ä½œä¸ºèŠ‚ç‚¹å ç½‘ç»œè¿æ¥: EPMD éœ€è¦é€šè¿‡ä¸»æœºåè¿æ¥åˆ°æœ¬åœ°èŠ‚ç‚¹ IP åœ°å€é”™è¯¯: å¦‚æœ hosts æ–‡ä»¶ä¸­çš„ IP ä¸æ­£ç¡®ï¼Œè¿æ¥ä¼šå¤±è´¥ è¿”å› closed: ç½‘ç»œè¿æ¥è¢«æ‹’ç»ï¼Œå¯¼è‡´ erl_epmd:port_please/3 è¿”å› closed è§£å†³è¿‡ç¨‹å›é¡¾é˜¶æ®µ 1: åˆå§‹é—®é¢˜è¯Šæ–­ âŒ ç°è±¡: case_clause,closed é”™è¯¯ âŒ å‡è®¾: ä»£ç  bug æˆ– Erlang ç‰ˆæœ¬é—®é¢˜ âœ… ä»·å€¼: æ·±å…¥ç†è§£äº† RabbitMQ å¯åŠ¨æœºåˆ¶ é˜¶æ®µ 2: ç‰ˆæœ¬å…¼å®¹æ€§åˆ†æ âœ… æ­£ç¡®æ–¹å‘: æŸ¥é˜…å®˜æ–¹å…¼å®¹æ€§æ–‡æ¡£ âœ… æœ‰æ•ˆå°è¯•: åˆ‡æ¢åˆ° Erlang 26 âœ… éƒ¨åˆ†æ”¹å–„: å‡å°‘äº†ä¸€äº›å…¼å®¹æ€§é—®é¢˜ é˜¶æ®µ 3: ä»£ç ä¿®å¤ âœ… æŠ€æœ¯ä»·å€¼: ä¿®å¤äº† EPMD é”™è¯¯å¤„ç† âœ… ä¼˜é›…é™çº§: ä»å´©æºƒæ”¹ä¸ºè­¦å‘Š âŒ æœªè§£å†³æ ¹å› : ç½‘ç»œé—®é¢˜ä»ç„¶å­˜åœ¨ é˜¶æ®µ 4: æ ¹å› å‘ç° âœ… çœŸæ­£åŸå› : hosts æ–‡ä»¶é…ç½®é”™è¯¯ âœ… å®Œç¾è§£å†³: ä¿®æ­£ IP åœ°å€åå®Œå…¨æ­£å¸¸ æœ€ç»ˆæˆæœRabbitMQ 4.0.4 å®Œå…¨æ­£å¸¸è¿è¡Œ123456789101112$ sbin/rabbitmqctl statusStatus of node rabbit@ERICKSUN-MC1 ...RuntimeOS PID: 5636Uptime (seconds): 28RabbitMQ version: 4.0.4+dirtyErlang/OTP 26 [erts-14.2.5.12]$ sbin/rabbitmqctl list_usersListing users ...user tagsguest [administrator] æŠ€æœ¯æ ˆç¡®è®¤ RabbitMQ: 4.0.4 âœ… Erlang: 26.2.5.16 âœ… ç½‘ç»œ: æ­£ç¡®çš„ hosts é…ç½® âœ… åŠŸèƒ½: å®Œå…¨æ­£å¸¸ âœ… å®è´µç»éªŒæ€»ç»“è°ƒè¯•æ–¹æ³•è®º æ—¥å¿—åˆ†æ: å‡†ç¡®ç†è§£é”™è¯¯ä¿¡æ¯ ç‰ˆæœ¬å…¼å®¹: æ£€æŸ¥å®˜æ–¹å…¼å®¹æ€§æ–‡æ¡£ ä»£ç å®¡æŸ¥: ç†è§£åº•å±‚å®ç°æœºåˆ¶ ç½‘ç»œè¯Šæ–­: æ£€æŸ¥åŸºç¡€ç½‘ç»œé…ç½® ç³»ç»Ÿç¯å¢ƒ: éªŒè¯ hostsã€DNS ç­‰åŸºç¡€è®¾æ–½ å…³é”®æ´å¯Ÿ è¡¨é¢ç°è±¡ â‰  æ ¹æœ¬åŸå› : EPMD é”™è¯¯å¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜ ç‰ˆæœ¬å…¼å®¹å¾ˆé‡è¦: ä½†ä¸æ˜¯æ‰€æœ‰é—®é¢˜çš„æ ¹æº åŸºç¡€è®¾æ–½å…³é”®: hosts æ–‡ä»¶ç­‰åŸºç¡€é…ç½®ä¸å®¹å¿½è§† é€æ­¥æ’æŸ¥: ä»åº”ç”¨å±‚åˆ°ç³»ç»Ÿå±‚çš„ç³»ç»Ÿæ€§è°ƒè¯• æŠ€æœ¯èƒ½åŠ›ä½“ç° âœ… é—®é¢˜å®šä½: å‡†ç¡®è¯†åˆ«å…³é”®é”™è¯¯ âœ… èµ„æ–™æŸ¥æ‰¾: æœ‰æ•ˆåˆ©ç”¨å®˜æ–¹æ–‡æ¡£ âœ… ç³»ç»Ÿæ€ç»´: å¤šå±‚æ¬¡åˆ†æé—®é¢˜ âœ… æŒç»­æ”¹è¿›: ä¸æ”¾å¼ƒï¼ŒæŒç»­æ·±å…¥ âœ… æ ¹å› åˆ†æ: æœ€ç»ˆæ‰¾åˆ°çœŸæ­£åŸå›  åç»­å»ºè®®1. ç¯å¢ƒç®¡ç† å®šæœŸæ£€æŸ¥ hosts æ–‡ä»¶é…ç½® ç¡®ä¿ç½‘ç»œé…ç½®ä¸å®é™…ç¯å¢ƒåŒ¹é… ä½¿ç”¨ç‰ˆæœ¬ç®¡ç†å·¥å…·ç®¡ç† Erlang&#x2F;RabbitMQ 2. ç›‘æ§å’Œç»´æŠ¤ ç›‘æ§ RabbitMQ å¯åŠ¨æ—¥å¿— å®šæœŸéªŒè¯ç½‘ç»œè¿é€šæ€§ ä¿æŒç‰ˆæœ¬å…¼å®¹æ€§æ–‡æ¡£æ›´æ–° 3. çŸ¥è¯†æ²‰æ·€ è®°å½•ç½‘ç»œé…ç½®æœ€ä½³å®è·µ å»ºç«‹é—®é¢˜è¯Šæ–­æ£€æŸ¥æ¸…å• åˆ†äº«è°ƒè¯•ç»éªŒå’Œæ–¹æ³• æ€»ç»“è¿™æ˜¯ä¸€æ¬¡éå¸¸æˆåŠŸçš„æŠ€æœ¯é—®é¢˜è§£å†³è¿‡ç¨‹ï¼ ä»åˆå§‹çš„ç¥ç§˜é”™è¯¯ï¼Œåˆ°ç‰ˆæœ¬å…¼å®¹æ€§åˆ†æï¼Œå†åˆ°ä»£ç ä¿®å¤ï¼Œæœ€ç»ˆå‘ç°ç½‘ç»œé…ç½®é—®é¢˜ - æ•´ä¸ªè¿‡ç¨‹å±•ç°äº†ï¼š æ‰å®çš„æŠ€æœ¯åŸºç¡€ ç³»ç»Ÿçš„è°ƒè¯•æ€ç»´ æŒç»­çš„å­¦ä¹ ç²¾ç¥ ä¸æ”¾å¼ƒçš„æŠ€æœ¯æ€åº¦ æœ€ç»ˆçŠ¶æ€: RabbitMQ 4.0.4 + Erlang 26.2.5.16 å®Œç¾è¿è¡Œ âœ…","categories":[{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"RabbitMQ","slug":"technology/RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/technology/RabbitMQ/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"ç½‘ç»œé…ç½®","slug":"ç½‘ç»œé…ç½®","permalink":"https://hzsunzixiang.github.io/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/"},{"name":"é—®é¢˜æ’æŸ¥","slug":"é—®é¢˜æ’æŸ¥","permalink":"https://hzsunzixiang.github.io/tags/%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/"}]},{"title":"RabbitMQ æ„å»ºé—®é¢˜åˆ†æä¸ç¤¾åŒºè¡¥ä¸ææ¡ˆ","slug":"rabbitmq-rabbitmq-build-issue-analysis","date":"2026-01-16T06:30:00.000Z","updated":"2026-01-16T07:23:13.870Z","comments":true,"path":"2026/01/16/rabbitmq-rabbitmq-build-issue-analysis/","permalink":"https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-build-issue-analysis/","excerpt":"RabbitMQ Build Issue Analysis &amp; Community Patch Proposalæ¦‚è¿°åœ¨æ„å»º RabbitMQ 4.1.0+beta.3 çš„ Generic Unix åŒ…æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªå…³é”®çš„æ„å»ºé”™è¯¯ã€‚æœ¬æ–‡æ¡£è¯¦ç»†åˆ†æäº†é—®é¢˜åŸå› ã€è§£å†³æ–¹æ¡ˆï¼Œå¹¶æå‡ºäº†å‘ç¤¾åŒºè´¡çŒ®è¡¥ä¸çš„å»ºè®®ã€‚","text":"RabbitMQ Build Issue Analysis &amp; Community Patch Proposalæ¦‚è¿°åœ¨æ„å»º RabbitMQ 4.1.0+beta.3 çš„ Generic Unix åŒ…æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªå…³é”®çš„æ„å»ºé”™è¯¯ã€‚æœ¬æ–‡æ¡£è¯¦ç»†åˆ†æäº†é—®é¢˜åŸå› ã€è§£å†³æ–¹æ¡ˆï¼Œå¹¶æå‡ºäº†å‘ç¤¾åŒºè´¡çŒ®è¡¥ä¸çš„å»ºè®®ã€‚ é—®é¢˜æè¿°é”™è¯¯ä¿¡æ¯12345ERROR:Duplicate filename on disk:dep_builtdep_builtmake[6]: *** [../../erlang.mk:3511: escript-zip] Error 2 æ„å»ºç¯å¢ƒ æ“ä½œç³»ç»Ÿ: macOS (Apple Silicon) Erlang ç‰ˆæœ¬: 27.3.4.6 (OTP 27) æ„å»ºå·¥å…·: GNU Make 4.4.1 RabbitMQ ç‰ˆæœ¬: 4.1.0+beta.3.976.g7083ba3 æ„å»ºå‘½ä»¤: gmake package-generic-unix é”™è¯¯å‘ç”Ÿä½ç½®é”™è¯¯å‘ç”Ÿåœ¨ erlang.mk æ–‡ä»¶çš„ç¬¬ 3511 è¡Œï¼Œå…·ä½“åœ¨ escript-zip ç›®æ ‡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ã€‚ æ ¹æœ¬åŸå› åˆ†æ1. é—®é¢˜æ ¹æºåœ¨ RabbitMQ çš„æ„å»ºç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªä¾èµ–é¡¹ç›®å½•çš„ ebin/ æ–‡ä»¶å¤¹ä¸­éƒ½ä¼šåˆ›å»ºä¸€ä¸ªåä¸º dep_built çš„æ ‡è®°æ–‡ä»¶ï¼Œç”¨äºæŒ‡ç¤ºè¯¥ä¾èµ–é¡¹å·²ç»æ„å»ºå®Œæˆã€‚ 2. å†²çªæœºåˆ¶å½“æ‰§è¡Œ escript-zip ç›®æ ‡æ—¶ï¼Œæ„å»ºç³»ç»Ÿä¼šå°è¯•å°†æ‰€æœ‰ä¾èµ–é¡¹çš„ ebin/* æ–‡ä»¶æ‰“åŒ…åˆ°ä¸€ä¸ª zip å½’æ¡£ä¸­ã€‚ç”±äºå¤šä¸ªä¾èµ–é¡¹éƒ½åŒ…å«åŒåçš„ dep_built æ–‡ä»¶ï¼Œ7z å½’æ¡£å·¥å…·ä¼šæŠ¥å‘Šé‡å¤æ–‡ä»¶åé”™è¯¯ã€‚ 3. å½±å“èŒƒå›´è¿™ä¸ªé—®é¢˜å½±å“æ‰€æœ‰åŒ…å«å¤šä¸ªä¾èµ–é¡¹çš„ RabbitMQ escript æ„å»ºï¼Œç‰¹åˆ«æ˜¯ï¼š rabbitmqctl escript å…¶ä»– CLI å·¥å…·çš„ escript æ„å»º Generic Unix åŒ…çš„åˆ›å»ºè¿‡ç¨‹ æŠ€æœ¯åˆ†æå½“å‰ä»£ç é—®é¢˜åœ¨ erlang.mk ç¬¬ 3510-3515 è¡Œï¼š 1234567# åŸå§‹ä»£ç ï¼ˆæœ‰é—®é¢˜ï¼‰$(gen_verbose) cd .. &amp;&amp; $(ESCRIPT_ZIP) $(abspath $(ESCRIPT_ZIP_FILE)) $(notdir $(CURDIR))/ebin/*ifneq ($(DEPS),) $(verbose) cd $(DEPS_DIR) &amp;&amp; $(ESCRIPT_ZIP) $(abspath $(ESCRIPT_ZIP_FILE)) \\ $(subst $(DEPS_DIR)/,,$(addsuffix /*,$(wildcard \\ $(addsuffix /ebin,$(shell cat $(ESCRIPT_RUNTIME_DEPS_FILE))))))endif é—®é¢˜åˆ†æ $(notdir $(CURDIR))/ebin/* å’Œä¾èµ–é¡¹çš„ ebin/* éƒ½åŒ…å« dep_built æ–‡ä»¶ 7z åœ¨æ·»åŠ åŒåæ–‡ä»¶åˆ°å½’æ¡£æ—¶ä¼šå¤±è´¥ æ„å»ºç³»ç»Ÿæ²¡æœ‰è¿‡æ»¤æ‰è¿™äº›å†…éƒ¨æ ‡è®°æ–‡ä»¶ å·²æœ‰çš„è¿‡æ»¤æœºåˆ¶åœ¨ deps/rabbit_common/mk/rabbitmq-dist.mk ä¸­å·²ç»å­˜åœ¨ç±»ä¼¼çš„è¿‡æ»¤é€»è¾‘ï¼š 12345# ç¬¬ 61 è¡Œ - å·²æœ‰çš„è¿‡æ»¤æœºåˆ¶$(filter-out %/dep_built %/ebin/test,$(call core_find,$(wildcard $(3)/ebin $(3)/include $(3)/priv),*)),)# ç¬¬ 134 è¡Œ - æ¸…ç†é€»è¾‘$(verbose) rm -f $(EZ_DIR_UNIX)/ebin/dep_built $(EZ_DIR_UNIX)/ebin/test è§£å†³æ–¹æ¡ˆä¿®å¤ä»£ç 1234567# ä¿®å¤åçš„ä»£ç $(gen_verbose) cd .. &amp;&amp; $(ESCRIPT_ZIP) $(abspath $(ESCRIPT_ZIP_FILE)) $(filter-out %/dep_built,$(notdir $(CURDIR))/ebin/*)ifneq ($(DEPS),) $(verbose) cd $(DEPS_DIR) &amp;&amp; $(ESCRIPT_ZIP) $(abspath $(ESCRIPT_ZIP_FILE)) \\ $(filter-out %/dep_built,$(subst $(DEPS_DIR)/,,$(addsuffix /*,$(wildcard \\ $(addsuffix /ebin,$(shell cat $(ESCRIPT_RUNTIME_DEPS_FILE)))))))endif ä¿®æ”¹è¯´æ˜ ç¬¬ 3510 è¡Œ: æ·»åŠ  $(filter-out %/dep_built,...) è¿‡æ»¤ä¸»é¡¹ç›®çš„ dep_built æ–‡ä»¶ ç¬¬ 3513 è¡Œ: æ·»åŠ  $(filter-out %/dep_built,...) è¿‡æ»¤ä¾èµ–é¡¹çš„ dep_built æ–‡ä»¶ ä¿®æ”¹çš„æŠ€æœ¯åŸç† filter-out æ˜¯ GNU Make çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºä»åˆ—è¡¨ä¸­æ’é™¤åŒ¹é…æ¨¡å¼çš„é¡¹ç›® %/dep_built æ¨¡å¼åŒ¹é…æ‰€æœ‰ä»¥ /dep_built ç»“å°¾çš„è·¯å¾„ è¿™ç§æ–¹æ³•ä¸ç°æœ‰çš„ rabbitmq-dist.mk ä¸­çš„è¿‡æ»¤é€»è¾‘ä¿æŒä¸€è‡´ éªŒè¯ç»“æœä¿®å¤å‰1234567$ gmake package-generic-unix# ... æ„å»ºè¿‡ç¨‹ ...ERROR:Duplicate filename on disk:dep_builtdep_builtmake[6]: *** [../../erlang.mk:3511: escript-zip] Error 2 ä¿®å¤å1234567891011$ gmake package-generic-unix# ... æ„å»ºè¿‡ç¨‹ ...# æ„å»ºæˆåŠŸï¼Œç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š$ ls PACKAGES/rabbitmq-server-4.1.0+beta.3.976.g7083ba3/rabbitmq-server-4.1.0+beta.3.976.g7083ba3.dirty/rabbitmq-server-4.1.0+beta.3.976.g7083ba3.dirty.manifestrabbitmq-server-4.1.0+beta.3.976.g7083ba3.dirty.tar.xzrabbitmq-server-4.1.0+beta.3.976.g7083ba3.manifestrabbitmq-server-4.1.0+beta.3.976.g7083ba3.tar.xzrabbitmq-server-generic-unix-4.1.0+beta.3.976.g7083ba3.dirty.tar.xz ç¤¾åŒºè´¡çŒ®å»ºè®®1. è¡¥ä¸å†…å®¹1234567891011121314151617diff --git a/erlang.mk b/erlang.mkindex 49c4519b82..1715d3b132 100644--- a/erlang.mk+++ b/erlang.mk@@ -3507,11 +3507,11 @@ escript-prepare: deps app escript-zip:: escript-prepare $(verbose) mkdir -p $(dir $(abspath $(ESCRIPT_ZIP_FILE))) $(verbose) rm -f $(abspath $(ESCRIPT_ZIP_FILE))- $(gen_verbose) cd .. &amp;&amp; $(ESCRIPT_ZIP) $(abspath $(ESCRIPT_ZIP_FILE)) $(notdir $(CURDIR))/ebin/*+ $(gen_verbose) cd .. &amp;&amp; $(ESCRIPT_ZIP) $(abspath $(ESCRIPT_ZIP_FILE)) $(filter-out %/dep_built,$(notdir $(CURDIR))/ebin/*) ifneq ($(DEPS),) $(verbose) cd $(DEPS_DIR) &amp;&amp; $(ESCRIPT_ZIP) $(abspath $(ESCRIPT_ZIP_FILE)) \\- $(subst $(DEPS_DIR)/,,$(addsuffix /*,$(wildcard \\- $(addsuffix /ebin,$(shell cat $(ESCRIPT_RUNTIME_DEPS_FILE))))))+ $(filter-out %/dep_built,$(subst $(DEPS_DIR)/,,$(addsuffix /*,$(wildcard \\+ $(addsuffix /ebin,$(shell cat $(ESCRIPT_RUNTIME_DEPS_FILE))))))) endif 2. æäº¤ä¿¡æ¯å»ºè®®123456789101112Fix escript-zip duplicate filename error for dep_built filesWhen building escript archives, multiple dependencies contain dep_builtmarker files in their ebin directories. This causes 7z to fail with&quot;Duplicate filename on disk&quot; error when creating the escript zip file.This fix adds filter-out patterns to exclude dep_built files fromescript archives, consistent with the existing filtering logic inrabbitmq-dist.mk.Fixes: Generic Unix package build failureTested-on: macOS Apple Silicon, Erlang 27.3.4.6 3. Pull Request æè¿°Problem Building RabbitMQ generic-unix packages fails with duplicate filename error: 1234ERROR:Duplicate filename on disk:dep_builtdep_built Root Cause Multiple dependencies have dep_built marker files in their ebin/ directories. When creating escript zip archives, these files conflict because they have the same name. Solution Filter out dep_built files from escript archives using filter-out, consistent with existing filtering logic in rabbitmq-dist.mk. Testing Builds successfully on macOS Apple Silicon Generic Unix package creation completes without errors Generated escript files work correctly No regression in existing functionality Files Changed erlang.mk: Added filter-out %/dep_built to escript-zip target 4. å½±å“è¯„ä¼°æ­£é¢å½±å“: ä¿®å¤äº† Generic Unix åŒ…æ„å»ºå¤±è´¥çš„é—®é¢˜ ä¸ç°æœ‰ä»£ç é£æ ¼å’Œè¿‡æ»¤é€»è¾‘ä¿æŒä¸€è‡´ ä¸å½±å“è¿è¡Œæ—¶åŠŸèƒ½ï¼Œåªå½±å“æ„å»ºè¿‡ç¨‹ ä¿®å¤èŒƒå›´å°ï¼Œé£é™©ä½ æ½œåœ¨é£é™©: æ— å·²çŸ¥é£é™© ä¿®æ”¹ä»…å½±å“æ„å»ºæ—¶çš„æ–‡ä»¶è¿‡æ»¤ï¼Œä¸å½±å“æœ€ç»ˆäº§å“ 5. æµ‹è¯•å»ºè®®åœ¨æäº¤ PR å‰ï¼Œå»ºè®®è¿›è¡Œä»¥ä¸‹æµ‹è¯•ï¼š åŸºæœ¬æ„å»ºæµ‹è¯•: 12gmake clean &amp;&amp; gmakegmake package-generic-unix è·¨å¹³å°æµ‹è¯•: Linux (Ubuntu&#x2F;CentOS) macOS (Intel&#x2F;Apple Silicon) Windows (å¦‚æœæ”¯æŒ) åŠŸèƒ½æµ‹è¯•: 123# æµ‹è¯•ç”Ÿæˆçš„ escript å·¥å…·./escript/rabbitmqctl help./escript/rabbitmq-plugins list å›å½’æµ‹è¯•: ç¡®ä¿ç°æœ‰çš„æ„å»ºç›®æ ‡ä»ç„¶å·¥ä½œ éªŒè¯å…¶ä»– escript æ„å»ºä¸å—å½±å“ é•¿æœŸå»ºè®®1. æ„å»ºç³»ç»Ÿæ”¹è¿›è€ƒè™‘åœ¨æ„å»ºç³»ç»Ÿä¸­ç»Ÿä¸€å¤„ç†å†…éƒ¨æ ‡è®°æ–‡ä»¶çš„è¿‡æ»¤é€»è¾‘ï¼Œé¿å…ç±»ä¼¼é—®é¢˜åœ¨å…¶ä»–åœ°æ–¹é‡ç°ã€‚ 2. æ–‡æ¡£æ›´æ–°åœ¨æ„å»ºæ–‡æ¡£ä¸­æ·»åŠ å…³äº dep_built æ–‡ä»¶ç”¨é€”å’Œå¤„ç†æ–¹å¼çš„è¯´æ˜ã€‚ 3. è‡ªåŠ¨åŒ–æµ‹è¯•åœ¨ CI&#x2F;CD æµæ°´çº¿ä¸­æ·»åŠ åŒ…æ„å»ºæµ‹è¯•ï¼Œç¡®ä¿ç±»ä¼¼é—®é¢˜èƒ½å¤ŸåŠæ—©å‘ç°ã€‚ ç»“è®ºè¿™æ˜¯ä¸€ä¸ªæ˜ç¡®çš„æ„å»ºç³»ç»Ÿ bugï¼Œæœ‰æ¸…æ™°çš„æ ¹æœ¬åŸå› å’Œç®€å•çš„ä¿®å¤æ–¹æ¡ˆã€‚ä¿®å¤æ–¹æ¡ˆé£é™©ä½ã€å½±å“èŒƒå›´æ˜ç¡®ï¼Œéå¸¸é€‚åˆä½œä¸ºç¤¾åŒºè´¡çŒ®æäº¤ã€‚å»ºè®®å°½å¿«å‘ RabbitMQ é¡¹ç›®æäº¤ Pull Requestï¼Œå¸®åŠ©å…¶ä»–å¼€å‘è€…é¿å…é‡åˆ°åŒæ ·çš„é—®é¢˜ã€‚ ä¿®å¤éªŒè¯: âœ… å·²åœ¨ macOS Apple Silicon + Erlang 27.3.4.6 ç¯å¢ƒä¸‹éªŒè¯æˆåŠŸç¤¾åŒºè´¡çŒ®å‡†å¤‡: âœ… è¡¥ä¸ã€æµ‹è¯•å’Œæ–‡æ¡£å·²å‡†å¤‡å°±ç»ªé£é™©è¯„ä¼°: âœ… ä½é£é™©ï¼Œä»…å½±å“æ„å»ºè¿‡ç¨‹ï¼Œä¸å½±å“è¿è¡Œæ—¶åŠŸèƒ½","categories":[{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"RabbitMQ","slug":"technology/RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/technology/RabbitMQ/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"æ„å»ºç³»ç»Ÿ","slug":"æ„å»ºç³»ç»Ÿ","permalink":"https://hzsunzixiang.github.io/tags/%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F/"},{"name":"å¼€æºè´¡çŒ®","slug":"å¼€æºè´¡çŒ®","permalink":"https://hzsunzixiang.github.io/tags/%E5%BC%80%E6%BA%90%E8%B4%A1%E7%8C%AE/"}]},{"title":"RabbitMQ æœåŠ¡å™¨ç¼–è¯‘æŒ‡å—","slug":"rabbitmq-rabbitmq-compilation-guide","date":"2026-01-16T06:00:00.000Z","updated":"2026-01-16T07:17:51.544Z","comments":true,"path":"2026/01/16/rabbitmq-rabbitmq-compilation-guide/","permalink":"https://hzsunzixiang.github.io/2026/01/16/rabbitmq-rabbitmq-compilation-guide/","excerpt":"RabbitMQ æœåŠ¡å™¨ç¼–è¯‘æŒ‡å—æœ¬æ–‡æ¡£è®°å½•äº†åœ¨ macOS (Apple Silicon) ç¯å¢ƒä¸‹ç¼–è¯‘ RabbitMQ æœåŠ¡å™¨çš„å®Œæ•´è¿‡ç¨‹ï¼ŒåŒ…æ‹¬é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚","text":"RabbitMQ æœåŠ¡å™¨ç¼–è¯‘æŒ‡å—æœ¬æ–‡æ¡£è®°å½•äº†åœ¨ macOS (Apple Silicon) ç¯å¢ƒä¸‹ç¼–è¯‘ RabbitMQ æœåŠ¡å™¨çš„å®Œæ•´è¿‡ç¨‹ï¼ŒåŒ…æ‹¬é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚ ç¯å¢ƒä¿¡æ¯ æ“ä½œç³»ç»Ÿ: macOS (Darwin) æ¶æ„: Apple Silicon (ARM64) Shell: bash åŒ…ç®¡ç†å™¨: Homebrew ç³»ç»Ÿè¦æ±‚å¿…éœ€å·¥å…· GNU Make 4+ 1brew install make Erlang 27.x 1brew install erlang@27 p7zip (7z å‘½ä»¤) 1brew install p7zip Git 1brew install git å¯é€‰å·¥å…· Elixir (ç”¨äº CLI å·¥å…·) rebar3 (Erlang æ„å»ºå·¥å…·) ç¼–è¯‘è¿‡ç¨‹1. ç¯å¢ƒå‡†å¤‡123456# å…‹éš† RabbitMQ æœåŠ¡å™¨æºç git clone https://github.com/rabbitmq/rabbitmq-server.gitcd rabbitmq-server# è®¾ç½®ç¯å¢ƒå˜é‡export PATH=&quot;/opt/homebrew/opt/erlang@27/bin:/opt/homebrew/bin:$PATH&quot; 2. æ¸…ç†å’Œç¼–è¯‘1234567# æ¸…ç†æ‰€æœ‰æ„å»ºäº§ç‰©git clean -xfffdgmake cleangmake distclean# å¼€å§‹ç¼–è¯‘ï¼ˆæ¨èä½¿ç”¨å•çº¿ç¨‹é¿å…å¹¶å‘é—®é¢˜ï¼‰gmake -j1 é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆé—®é¢˜ 1: Erlang ç‰ˆæœ¬ä¸å…¼å®¹é”™è¯¯ä¿¡æ¯: 1rabbit_data_coercion.erl:76:23: syntax error before: &#x27;||&#x27; åŸå› : RabbitMQ 4.x ä½¿ç”¨äº† Erlang 26+ æ‰æ”¯æŒçš„ map comprehension è¯­æ³•ï¼Œè€Œç³»ç»Ÿå®‰è£…çš„æ˜¯ Erlang 25ã€‚ è§£å†³æ–¹æ¡ˆ: 12345678# å¸è½½æ—§ç‰ˆæœ¬ Erlangbrew uninstall erlang@25# å®‰è£… Erlang 27brew install erlang@27# æ›´æ–° PATHexport PATH=&quot;/opt/homebrew/opt/erlang@27/bin:$PATH&quot; éªŒè¯: 123456erl -version# åº”è¯¥æ˜¾ç¤º: Erlang (SMP,ASYNC_THREADS) (BEAM) emulator version 15.2.7.4# æµ‹è¯• map comprehension è¯­æ³•erl -eval &#x27;M = #&#123;a =&gt; 1, b =&gt; 2&#125;, R = #&#123;K =&gt; V || K := V &lt;- M&#125;, io:format(&quot;~p~n&quot;, [R]), halt().&#x27; -noshell# åº”è¯¥è¾“å‡º: #&#123;a =&gt; 1,b =&gt; 2&#125; é—®é¢˜ 2: wxWidgets å…¼å®¹æ€§é—®é¢˜é”™è¯¯ä¿¡æ¯: 12observer:start().=CRASH REPORT==== Symbol not found: __ZNK8wxCursor10GetHotSpotEv åŸå› : Erlang 27 ä¸ç°æœ‰çš„ wxWidgets ç‰ˆæœ¬ä¸å…¼å®¹ã€‚ è§£å†³æ–¹æ¡ˆ: 123456# å¸è½½ Erlang 27 å’Œ wxWidgetsbrew uninstall erlang@27brew uninstall --ignore-dependencies wxwidgets# é‡æ–°å®‰è£…ï¼ˆè¿™ä¼šè‡ªåŠ¨å®‰è£…å…¼å®¹çš„ wxWidgets ç‰ˆæœ¬ï¼‰brew install erlang@27 éªŒè¯: 123# æµ‹è¯• observer æ˜¯å¦æ­£å¸¸å·¥ä½œerl -eval &#x27;observer:start(), timer:sleep(2000), observer:stop(), halt().&#x27;# åº”è¯¥æ­£å¸¸å¯åŠ¨å’Œå…³é—­ï¼Œæ— é”™è¯¯ä¿¡æ¯ é—®é¢˜ 3: ç¼ºå°‘ 7z å‘½ä»¤é”™è¯¯ä¿¡æ¯: 12/bin/sh: 7z: command not foundgmake[2]: *** [../../erlang.mk:3510: escript-zip] Error 127 åŸå› : RabbitMQ CLI å·¥å…·æ„å»ºéœ€è¦ 7z å‘½ä»¤æ¥åˆ›å»º escript å½’æ¡£ã€‚ è§£å†³æ–¹æ¡ˆ: 123456# å®‰è£… p7zipbrew install p7zip# éªŒè¯å®‰è£…which 7z# åº”è¯¥è¾“å‡º: /opt/homebrew/bin/7z é—®é¢˜ 4: hex_core ä¾èµ–æ„å»ºå¤±è´¥é”™è¯¯ä¿¡æ¯: 12gmake[2]: *** No targets specified and no makefile found. Stop.touch: cannot touch &#x27;/Users/.../deps/hex_core/ebin/dep_built&#x27;: No such file or directory åŸå› : hex_core ä½¿ç”¨ rebar3 æ„å»ºç³»ç»Ÿï¼Œä½† erlang.mk å°è¯•ç”¨ make æ„å»ºå®ƒã€‚ è§£å†³æ–¹æ¡ˆ: 1234567# æ‰‹åŠ¨ç¼–è¯‘ hex_corecd deps/hex_coremkdir -p ebinerlc -o ebin src/*.erlcp src/hex_core.app.src ebin/hex_core.apptouch ebin/dep_builtcd ../.. é—®é¢˜ 5: ra æ¨¡å—å¹¶å‘ç¼–è¯‘é—®é¢˜é”™è¯¯ä¿¡æ¯: 1failed to rename .../ra_snapshot.bea# to .../ra_snapshot.beam: no such file or directory åŸå› : å¹¶å‘ç¼–è¯‘æ—¶æ–‡ä»¶æ“ä½œå†²çªã€‚ è§£å†³æ–¹æ¡ˆ: 1234567# ä½¿ç”¨å•çº¿ç¨‹ç¼–è¯‘gmake -j1# æˆ–è€…æ¸…ç† ra ç›®å½•åé‡æ–°ç¼–è¯‘rm -rf deps/ra/ebinmkdir deps/ra/ebingmake -j1 deps é—®é¢˜ 6: Generic Unix åŒ…æ„å»ºä¸­çš„é‡å¤æ–‡ä»¶åé”™è¯¯é”™è¯¯ä¿¡æ¯: 12345ERROR:Duplicate filename on disk:dep_builtdep_builtmake[6]: *** [../../erlang.mk:3511: escript-zip] Error 2 åŸå› : åœ¨åˆ›å»º escript zip æ–‡ä»¶æ—¶ï¼Œå¤šä¸ªä¾èµ–é¡¹ä¸­éƒ½åŒ…å« dep_built æ–‡ä»¶ï¼Œå¯¼è‡´ 7z å½’æ¡£æ—¶æ–‡ä»¶åå†²çªã€‚ è§£å†³æ–¹æ¡ˆ: æ–¹æ³•1 - ä¸´æ—¶åˆ é™¤ dep_built æ–‡ä»¶ï¼š 12345# åˆ é™¤æ‰€æœ‰ dep_built æ–‡ä»¶find deps -name &quot;dep_built&quot; -delete# ç„¶åæ„å»ºåŒ…gmake package-generic-unix æ–¹æ³•2 - ä¿®æ”¹ erlang.mkï¼ˆæ°¸ä¹…è§£å†³ï¼‰ï¼š 12345# åœ¨ erlang.mk ç¬¬3510-3515è¡Œï¼Œæ·»åŠ  filter-out æ¥æ’é™¤ dep_built æ–‡ä»¶# å°†ï¼š# $(subst $(DEPS_DIR)/,,$(addsuffix /*,$(wildcard \\# æ”¹ä¸ºï¼š# $(filter-out %/dep_built,$(subst $(DEPS_DIR)/,,$(addsuffix /*,$(wildcard \\ æ–¹æ³•3 - ä½¿ç”¨æ„å»ºè„šæœ¬ï¼š 12# ä½¿ç”¨æä¾›çš„è‡ªåŠ¨åŒ–è„šæœ¬./build_package.sh éªŒè¯: 12# æ£€æŸ¥ç”Ÿæˆçš„åŒ…æ–‡ä»¶ls -la PACKAGES/rabbitmq-server-*.tar.xz åŒ…æ„å»ºè„šæœ¬åˆ›å»º build_package.sh è„šæœ¬æ¥è‡ªåŠ¨åŒ–åŒ…æ„å»ºè¿‡ç¨‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#!/bin/bash# RabbitMQ Generic Unix Package Build Scriptset -eecho &quot;å¼€å§‹æ„å»º RabbitMQ Generic Unix åŒ…...&quot;# è®¾ç½®ç¯å¢ƒå˜é‡export PATH=&quot;/opt/homebrew/opt/erlang@27/bin:/opt/homebrew/bin:$PATH&quot;# éªŒè¯ç¯å¢ƒecho &quot;éªŒè¯æ„å»ºç¯å¢ƒ...&quot;which gmake || &#123; echo &quot;é”™è¯¯: æœªæ‰¾åˆ° gmake&quot;; exit 1; &#125;which erl || &#123; echo &quot;é”™è¯¯: æœªæ‰¾åˆ° erlang&quot;; exit 1; &#125;which 7z || &#123; echo &quot;é”™è¯¯: æœªæ‰¾åˆ° 7z&quot;; exit 1; &#125;# æ£€æŸ¥ Erlang ç‰ˆæœ¬ERL_VERSION=$(erl -eval &#x27;io:format(&quot;~s&quot;, [erlang:system_info(otp_release)]), halt().&#x27; -noshell)if [[ &quot;$ERL_VERSION&quot; &lt; &quot;27&quot; ]]; then echo &quot;é”™è¯¯: éœ€è¦ Erlang 27+ï¼Œå½“å‰ç‰ˆæœ¬: $ERL_VERSION&quot; exit 1fiecho &quot;Erlang ç‰ˆæœ¬: $ERL_VERSION âœ“&quot;# æ¸…ç†å¯èƒ½å¯¼è‡´é—®é¢˜çš„ dep_built æ–‡ä»¶echo &quot;æ¸…ç† dep_built æ–‡ä»¶...&quot;find deps -name &quot;dep_built&quot; -delete 2&gt;/dev/null || true# ç¡®ä¿ä¸»é¡¹ç›®å·²ç»æ„å»ºecho &quot;ç¡®ä¿ä¸»é¡¹ç›®å·²æ„å»º...&quot;if [ ! -f &quot;sbin/rabbitmq-server&quot; ]; then echo &quot;ä¸»é¡¹ç›®æœªæ„å»ºï¼Œå¼€å§‹æ„å»º...&quot; gmake -j1fi# æ„å»º generic-unix åŒ…echo &quot;æ„å»º Generic Unix åŒ…...&quot;gmake package-generic-unixecho &quot;æ„å»ºå®Œæˆï¼&quot;# æ£€æŸ¥è¾“å‡ºPACKAGE_DIR=&quot;PACKAGES&quot;if [ -d &quot;$PACKAGE_DIR&quot; ]; then echo &quot;ç”Ÿæˆçš„åŒ…æ–‡ä»¶:&quot; ls -la &quot;$PACKAGE_DIR&quot;/rabbitmq-server-*.tar.xz 2&gt;/dev/null || echo &quot;æœªæ‰¾åˆ° .tar.xz æ–‡ä»¶&quot; ls -la &quot;$PACKAGE_DIR&quot;/rabbitmq-server-*.tar.gz 2&gt;/dev/null || echo &quot;æœªæ‰¾åˆ° .tar.gz æ–‡ä»¶&quot;else echo &quot;è­¦å‘Š: æœªæ‰¾åˆ° PACKAGES ç›®å½•&quot;fi å®Œæ•´ç¼–è¯‘è„šæœ¬12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#!/bin/bash# RabbitMQ æœåŠ¡å™¨ç¼–è¯‘è„šæœ¬set -eecho &quot;å¼€å§‹ç¼–è¯‘ RabbitMQ æœåŠ¡å™¨...&quot;# è®¾ç½®ç¯å¢ƒå˜é‡export PATH=&quot;/opt/homebrew/opt/erlang@27/bin:/opt/homebrew/bin:$PATH&quot;# éªŒè¯å¿…éœ€å·¥å…·echo &quot;éªŒè¯æ„å»ºå·¥å…·...&quot;which gmake || &#123; echo &quot;é”™è¯¯: æœªæ‰¾åˆ° gmake&quot;; exit 1; &#125;which erl || &#123; echo &quot;é”™è¯¯: æœªæ‰¾åˆ° erlang&quot;; exit 1; &#125;which 7z || &#123; echo &quot;é”™è¯¯: æœªæ‰¾åˆ° 7z&quot;; exit 1; &#125;# æ£€æŸ¥ Erlang ç‰ˆæœ¬ERL_VERSION=$(erl -eval &#x27;io:format(&quot;~s&quot;, [erlang:system_info(otp_release)]), halt().&#x27; -noshell)if [[ &quot;$ERL_VERSION&quot; &lt; &quot;27&quot; ]]; then echo &quot;é”™è¯¯: éœ€è¦ Erlang 27+ï¼Œå½“å‰ç‰ˆæœ¬: $ERL_VERSION&quot; exit 1fiecho &quot;Erlang ç‰ˆæœ¬: $ERL_VERSION âœ“&quot;# æ¸…ç†æ„å»ºäº§ç‰©echo &quot;æ¸…ç†æ„å»ºäº§ç‰©...&quot;git clean -xfffdgmake cleangmake distclean# æ‰‹åŠ¨æ„å»º hex_coreï¼ˆå¦‚æœéœ€è¦ï¼‰if [ ! -f &quot;deps/hex_core/ebin/dep_built&quot; ]; then echo &quot;æ‰‹åŠ¨æ„å»º hex_core...&quot; cd deps/hex_core mkdir -p ebin erlc -o ebin src/*.erl 2&gt;/dev/null || true cp src/hex_core.app.src ebin/hex_core.app 2&gt;/dev/null || true touch ebin/dep_built cd ../..fi# å¼€å§‹ç¼–è¯‘echo &quot;å¼€å§‹ç¼–è¯‘ RabbitMQ...&quot;gmake -j1echo &quot;ç¼–è¯‘å®Œæˆï¼&quot;# éªŒè¯ç¼–è¯‘ç»“æœecho &quot;éªŒè¯ç¼–è¯‘ç»“æœ...&quot;if [ -f &quot;sbin/rabbitmq-server&quot; ] &amp;&amp; [ -f &quot;escript/rabbitmqctl&quot; ]; then echo &quot;âœ“ ç¼–è¯‘æˆåŠŸï¼&quot; echo &quot; - æœåŠ¡å™¨è„šæœ¬: sbin/rabbitmq-server&quot; echo &quot; - æ§åˆ¶å·¥å…·: escript/rabbitmqctl&quot;else echo &quot;âœ— ç¼–è¯‘å¯èƒ½ä¸å®Œæ•´ï¼Œè¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯&quot; exit 1fi éªŒè¯ç¼–è¯‘ç»“æœæ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶123456789# æ£€æŸ¥ä¸»è¦å¯æ‰§è¡Œæ–‡ä»¶ls -la sbin/rabbitmq-serverls -la escript/rabbitmqctl# æ£€æŸ¥æ’ä»¶ç›®å½•ls -la plugins/# æ£€æŸ¥ Erlang beam æ–‡ä»¶find deps/rabbit/ebin -name &quot;*.beam&quot; | head -5 è¿è¡Œæµ‹è¯•12345# å¯åŠ¨å¼€å‘æ¨¡å¼æœåŠ¡å™¨gmake run-broker# åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­æµ‹è¯•è¿æ¥./escript/rabbitmqctl status å¸¸è§é—®é¢˜æ’æŸ¥ç¼–è¯‘æ—¶é—´è¿‡é•¿ åŸå› : RabbitMQ æ˜¯å¤§å‹é¡¹ç›®ï¼ŒåŒ…å«ä¼—å¤šæ¨¡å— è§£å†³: æ­£å¸¸ç°è±¡ï¼Œå®Œæ•´ç¼–è¯‘éœ€è¦ 15-25 åˆ†é’Ÿ å†…å­˜ä¸è¶³ ç—‡çŠ¶: ç¼–è¯‘è¿‡ç¨‹ä¸­ç³»ç»Ÿå¡é¡¿æˆ–è¿›ç¨‹è¢«æ€æ­» è§£å†³: ä½¿ç”¨ gmake -j1 å‡å°‘å¹¶å‘ï¼Œæˆ–å¢åŠ è™šæ‹Ÿå†…å­˜ æƒé™é—®é¢˜ ç—‡çŠ¶: æ— æ³•åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½• è§£å†³: ç¡®ä¿å¯¹é¡¹ç›®ç›®å½•æœ‰å†™æƒé™ï¼Œé¿å…ä½¿ç”¨ sudo ç½‘ç»œé—®é¢˜ ç—‡çŠ¶: ä¾èµ–ä¸‹è½½å¤±è´¥ è§£å†³: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œè€ƒè™‘ä½¿ç”¨ä»£ç†æˆ–é•œåƒæº æ€§èƒ½ä¼˜åŒ–å»ºè®® ä½¿ç”¨ SSD: ç¡®ä¿é¡¹ç›®åœ¨ SSD ä¸Šç¼–è¯‘ å……è¶³å†…å­˜: æ¨è 8GB+ å†…å­˜ å•çº¿ç¨‹ç¼–è¯‘: ä½¿ç”¨ -j1 é¿å…å¹¶å‘é—®é¢˜ æ¸…ç†ç¼“å­˜: å®šæœŸè¿è¡Œ gmake distclean ç›¸å…³èµ„æº RabbitMQ å®˜æ–¹æ–‡æ¡£ RabbitMQ GitHub ä»“åº“ Erlang&#x2F;OTP æ–‡æ¡£ ç‰ˆæœ¬ä¿¡æ¯ æ–‡æ¡£ç‰ˆæœ¬: 1.0 RabbitMQ ç‰ˆæœ¬: 4.x (main åˆ†æ”¯) Erlang ç‰ˆæœ¬: 27.3.4.6 åˆ›å»ºæ—¥æœŸ: 2026-01-16 æœ€åæ›´æ–°: 2026-01-16 æ³¨æ„: æœ¬æ–‡æ¡£åŸºäº macOS Apple Silicon ç¯å¢ƒç¼–å†™ï¼Œå…¶ä»–å¹³å°å¯èƒ½éœ€è¦è°ƒæ•´éƒ¨åˆ†æ­¥éª¤ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"RabbitMQ","slug":"technology/RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/technology/RabbitMQ/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"ç¼–è¯‘","slug":"ç¼–è¯‘","permalink":"https://hzsunzixiang.github.io/tags/%E7%BC%96%E8%AF%91/"},{"name":"macOS","slug":"macOS","permalink":"https://hzsunzixiang.github.io/tags/macOS/"}]},{"title":"Erlang è¿›ç¨‹é“¾æ¥ä¸ç›‘è§†å™¨ï¼ˆä¸­æ–‡ç‰ˆï¼‰","slug":"erlang-erlang-links-and-monitors-cn","date":"2026-01-16T02:30:00.000Z","updated":"2026-01-16T04:38:09.166Z","comments":true,"path":"2026/01/16/erlang-erlang-links-and-monitors-cn/","permalink":"https://hzsunzixiang.github.io/2026/01/16/erlang-erlang-links-and-monitors-cn/","excerpt":"ç”¨äºç›‘ç£çš„é“¾æ¥å’Œç›‘è§†å™¨å½“è¿›ç¨‹ç›¸äº’ä¾èµ–æ—¶ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæœ‰ä¸¤ç§é€‰æ‹©ï¼šè®©å®ƒä»¬åŒç”Ÿå…±æ­»ï¼Œæˆ–è€…è®©ä¸€ä¸ªè¿›ç¨‹åœ¨å¦ä¸€ä¸ªè¿›ç¨‹å´©æºƒæ—¶å¾—åˆ°é€šçŸ¥ã€‚ç¬¬ä¸‰ç« è®¨è®ºçš„ Erlang â€œä»»å…¶å´©æºƒâ€å“²å­¦ï¼Œä½¿æˆ‘ä»¬å€¾å‘äºåä¸€ç§é€‰æ‹©ã€‚ é“¾æ¥çš„è¿›ç¨‹å½¢æˆä¸€ä¸ªç»„ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šä¸€èµ·å´©æºƒã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªé“¾æ¥çš„è¿›ç¨‹å¼‚å¸¸é€€å‡ºï¼Œå…¶ç»„ä¸­çš„æ‰€æœ‰å…¶ä»–è¿›ç¨‹éƒ½ä¼šæ”¶åˆ° EXIT ä¿¡å·å¹¶ä¸€èµ·å´©æºƒã€‚ç›‘è§†å™¨å…è®¸ä¸€ä¸ªè¿›ç¨‹ç›‘è§†å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸ä¼šè‡ªåŠ¨è¢«è€¦åˆåˆ°åŒä¸€ä¸ªç»„ä¸­ã€‚","text":"ç”¨äºç›‘ç£çš„é“¾æ¥å’Œç›‘è§†å™¨å½“è¿›ç¨‹ç›¸äº’ä¾èµ–æ—¶ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæœ‰ä¸¤ç§é€‰æ‹©ï¼šè®©å®ƒä»¬åŒç”Ÿå…±æ­»ï¼Œæˆ–è€…è®©ä¸€ä¸ªè¿›ç¨‹åœ¨å¦ä¸€ä¸ªè¿›ç¨‹å´©æºƒæ—¶å¾—åˆ°é€šçŸ¥ã€‚ç¬¬ä¸‰ç« è®¨è®ºçš„ Erlang â€œä»»å…¶å´©æºƒâ€å“²å­¦ï¼Œä½¿æˆ‘ä»¬å€¾å‘äºåä¸€ç§é€‰æ‹©ã€‚ é“¾æ¥çš„è¿›ç¨‹å½¢æˆä¸€ä¸ªç»„ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šä¸€èµ·å´©æºƒã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªé“¾æ¥çš„è¿›ç¨‹å¼‚å¸¸é€€å‡ºï¼Œå…¶ç»„ä¸­çš„æ‰€æœ‰å…¶ä»–è¿›ç¨‹éƒ½ä¼šæ”¶åˆ° EXIT ä¿¡å·å¹¶ä¸€èµ·å´©æºƒã€‚ç›‘è§†å™¨å…è®¸ä¸€ä¸ªè¿›ç¨‹ç›‘è§†å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸ä¼šè‡ªåŠ¨è¢«è€¦åˆåˆ°åŒä¸€ä¸ªç»„ä¸­ã€‚ é“¾æ¥ï¼ˆLinksï¼‰é“¾æ¥æ˜¯åŒå‘çš„ã€‚å¦‚æœä¸¤ä¸ªè¿›ç¨‹è¢«é“¾æ¥ï¼Œå®ƒä»¬è¢«ç§°ä¸ºå±äºåŒä¸€ä¸ªé“¾æ¥é›†ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªå¼‚å¸¸ç»ˆæ­¢ï¼Œé€€å‡ºä¿¡å·ä¼šä¼ æ’­åˆ°å±äºå…¶é“¾æ¥é›†çš„æ‰€æœ‰è¿›ç¨‹ã€‚ è®¾ç½®ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„é“¾æ¥ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ BIFï¼š link(Pid) åœ¨è°ƒç”¨è¿›ç¨‹å’Œè¿›ç¨‹æ ‡è¯†ç¬¦ä¸º Pid çš„è¿›ç¨‹ä¹‹é—´å»ºç«‹åŒå‘é“¾æ¥ã€‚ spawn_link(Module, Function, Args) åŸå­åœ°ç”Ÿæˆå¹¶é“¾æ¥åˆ°ä¸€ä¸ªè¿›ç¨‹ã€‚è¿™ç›¸å½“äºç”Ÿæˆä¸€ä¸ªè¿›ç¨‹å¹¶é“¾æ¥åˆ°å®ƒï¼Œä½†æ˜¯ä»¥åŸå­æ–¹å¼å®Œæˆï¼Œå› æ­¤ä¸å­˜åœ¨ç”Ÿæˆçš„è¿›ç¨‹åœ¨é“¾æ¥å»ºç«‹ä¹‹å‰æ­»äº¡çš„é£é™©ã€‚ unlink(Pid) ç§»é™¤è°ƒç”¨è¿›ç¨‹å’Œè¿›ç¨‹æ ‡è¯†ç¬¦ä¸º Pid çš„è¿›ç¨‹ä¹‹é—´çš„ä»»ä½•é“¾æ¥ã€‚ ç¤ºä¾‹12345671&gt; Pid = spawn(fun() -&gt; receive X -&gt; X end end).&lt;0.25.0&gt;2&gt; link(Pid).true3&gt; exit(Pid, kill).true** exception exit: killed åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé“¾æ¥åˆ°ç”Ÿæˆçš„è¿›ç¨‹ç„¶åå‘é€ kill ä¿¡å·ä¼šå¯¼è‡´ç”Ÿæˆçš„è¿›ç¨‹å’Œ shell éƒ½å´©æºƒã€‚ æ•è·é€€å‡ºï¼ˆTrapping Exitsï¼‰è¿›ç¨‹å¯ä»¥é€šè¿‡è®¾ç½®ä»¥ä¸‹æ ‡å¿—æ¥æ•è·é€€å‡ºä¿¡å·ï¼š 1process_flag(trap_exit, true) å½“ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨æ•è·é€€å‡ºæ—¶ï¼Œé€€å‡ºä¿¡å·ä¼šè¢«è½¬æ¢æˆ {&#39;EXIT&#39;, Pid, Reason} å½¢å¼çš„æ¶ˆæ¯ï¼Œå¯ä»¥åœ¨æ™®é€šçš„ receive è¯­å¥ä¸­å¤„ç†ã€‚ ç¤ºä¾‹123456781&gt; process_flag(trap_exit, true).false2&gt; Pid = spawn_link(fun() -&gt; receive X -&gt; X end end).&lt;0.35.0&gt;3&gt; exit(Pid, reason).true4&gt; receive X -&gt; X end.&#123;&#x27;EXIT&#x27;,&lt;0.35.0&gt;,reason&#125; è¡¨ 2-1. ä¼ æ’­è¯­ä¹‰ åŸå›  æ•è·é€€å‡º (trap_exit=true) ä¸æ•è·é€€å‡º normal æ¥æ”¶ {&#39;EXIT&#39;, Pid, normal} æ— äº‹å‘ç”Ÿ kill ä»¥åŸå›  killed ç»ˆæ­¢ ä»¥åŸå›  killed ç»ˆæ­¢ å…¶ä»– æ¥æ”¶ {&#39;EXIT&#39;, Pid, Other} ä»¥åŸå›  Other ç»ˆæ­¢ ç›‘è§†å™¨ï¼ˆMonitorsï¼‰ä¸é“¾æ¥ä¸åŒï¼Œç›‘è§†å™¨æ˜¯å•å‘çš„ã€‚å½“è¢«ç›‘è§†çš„è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œç›‘è§†è¿›ç¨‹ä¼šåœ¨å…¶é‚®ç®±ä¸­æ”¶åˆ°ä¸€æ¡ {&#39;DOWN&#39;, Reference, process, Pid, Reason} æ¶ˆæ¯ï¼Œä½†ä¸ä¼šå‘ç›¸åæ–¹å‘å‘é€ä¿¡å·ã€‚ ä½¿ç”¨ BIF è®¾ç½®ç›‘è§†å™¨ï¼š 1Reference = monitor(process, Pid) å¦‚æœè®¾ç½®äº†å¤šä¸ªç›‘è§†å™¨ï¼ŒReference å¯ç”¨äºæ ‡è¯†ç‰¹å®šçš„ç›‘è§†å™¨ã€‚ è¦ç§»é™¤ç›‘è§†å™¨ï¼Œä½¿ç”¨ï¼š 1demonitor(Reference) ç›‘è§†å™¨ä¸é“¾æ¥å¯¹æ¯” ç‰¹æ€§ é“¾æ¥ ç›‘è§†å™¨ æ–¹å‘æ€§ åŒå‘ å•å‘ é»˜è®¤è¡Œä¸º ä¸€èµ·å´©æºƒ é€€å‡ºæ—¶å‘é€æ¶ˆæ¯ ä¿¡å·ä¼ æ’­ åŒå‘ å•å‘ è®¾ç½®å‡½æ•° link/1 monitor/2 ç§»é™¤å‡½æ•° unlink/1 demonitor/1 ç¤ºä¾‹123456781&gt; Pid = spawn(fun() -&gt; receive X -&gt; X end end).&lt;0.25.0&gt;2&gt; Ref = monitor(process, Pid).#Ref&lt;0.0.0.26&gt;3&gt; exit(Pid, reason).true4&gt; receive X -&gt; X end.&#123;&#x27;DOWN&#x27;,#Ref&lt;0.0.0.26&gt;,process,&lt;0.25.0&gt;,reason&#125; æ€»ç»“ é“¾æ¥ åœ¨è¿›ç¨‹ä¹‹é—´åˆ›å»ºåŒå‘è¿æ¥ã€‚å½“ä¸€ä¸ªè¿›ç¨‹æ­»äº¡æ—¶ï¼Œæ‰€æœ‰é“¾æ¥çš„è¿›ç¨‹éƒ½ä¼šæ”¶åˆ°é€€å‡ºä¿¡å·ã€‚ ç›‘è§†å™¨ åˆ›å»ºå•å‘è§‚å¯Ÿã€‚å½“è¢«ç›‘è§†çš„è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œç›‘è§†è¿›ç¨‹ä¼šæ”¶åˆ° &#39;DOWN&#39; æ¶ˆæ¯ã€‚ ä½¿ç”¨ process_flag(trap_exit, true) å°†é€€å‡ºä¿¡å·è½¬æ¢ä¸ºæ¶ˆæ¯ã€‚ kill åŸå› æ— æ³•è¢«æ•è·ï¼Œæ€»æ˜¯ä¼šç»ˆæ­¢è¿›ç¨‹ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"Erlang","slug":"technology/Erlang","permalink":"https://hzsunzixiang.github.io/categories/technology/Erlang/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"OTP","slug":"OTP","permalink":"https://hzsunzixiang.github.io/tags/OTP/"},{"name":"å¹¶å‘ç¼–ç¨‹","slug":"å¹¶å‘ç¼–ç¨‹","permalink":"https://hzsunzixiang.github.io/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"},{"name":"è¿›ç¨‹é“¾æ¥","slug":"è¿›ç¨‹é“¾æ¥","permalink":"https://hzsunzixiang.github.io/tags/%E8%BF%9B%E7%A8%8B%E9%93%BE%E6%8E%A5/"},{"name":"ç›‘è§†å™¨","slug":"ç›‘è§†å™¨","permalink":"https://hzsunzixiang.github.io/tags/%E7%9B%91%E8%A7%86%E5%99%A8/"}]},{"title":"Erlang è¿›ç¨‹é“¾æ¥ä¸ç›‘è§†å™¨","slug":"erlang-erlang-links-and-monitors","date":"2026-01-16T02:00:00.000Z","updated":"2026-01-16T04:38:09.166Z","comments":true,"path":"2026/01/16/erlang-erlang-links-and-monitors/","permalink":"https://hzsunzixiang.github.io/2026/01/16/erlang-erlang-links-and-monitors/","excerpt":"Links and Monitors for SupervisionWhen processes depend on each other, we have essentially two choices: to have them live and die together, or to let one process be informed when another one crashes. The â€œlet it failâ€ philosophy of Erlang, discussed in Chapter 3, leads us to a preference for the latter alternative. Linked processes form a group that, by default, all crash together. If one of the linked processes exits abnormally, all the other processes in its group get an EXIT signal and crash as well. Monitors allow a process to monitor another process without automatically getting coupled into the same group.","text":"Links and Monitors for SupervisionWhen processes depend on each other, we have essentially two choices: to have them live and die together, or to let one process be informed when another one crashes. The â€œlet it failâ€ philosophy of Erlang, discussed in Chapter 3, leads us to a preference for the latter alternative. Linked processes form a group that, by default, all crash together. If one of the linked processes exits abnormally, all the other processes in its group get an EXIT signal and crash as well. Monitors allow a process to monitor another process without automatically getting coupled into the same group. LinksLinks are bidirectional. If two processes are linked, they are said to belong to the same link set. If one of them terminates abnormally, an exit signal is propagated to all processes that belong to its link set. For setting up a link between two processes, the following BIFs can be used: link(Pid) sets up a bidirectional link between the calling process and the process with process identifier Pid. spawn_link(Module, Function, Args) atomically spawns and links to a process. This is equivalent to spawning a process and linking to it, but is done atomically so there is no risk of the spawned process dying before the link is set up. unlink(Pid) removes any link between the calling process and the process with process identifier Pid. Example12345671&gt; Pid = spawn(fun() -&gt; receive X -&gt; X end end).&lt;0.25.0&gt;2&gt; link(Pid).true3&gt; exit(Pid, kill).true** exception exit: killed In this example, linking to the spawned process and then sending a kill signal causes both the spawned process and the shell to crash. Trapping ExitsA process can trap exit signals by setting: 1process_flag(trap_exit, true) When a process is trapping exits, the exit signals are converted into messages of the form {&#39;EXIT&#39;, Pid, Reason} that can be handled in a normal receive statement. Example123456781&gt; process_flag(trap_exit, true).false2&gt; Pid = spawn_link(fun() -&gt; receive X -&gt; X end end).&lt;0.35.0&gt;3&gt; exit(Pid, reason).true4&gt; receive X -&gt; X end.&#123;&#x27;EXIT&#x27;,&lt;0.35.0&gt;,reason&#125; Table 2-1. Propagation semantics Reason Trapping exits (trap_exit=true) Not trapping exits normal Receives {&#39;EXIT&#39;, Pid, normal} Nothing happens kill Terminates with reason killed Terminates with reason killed Other Receives {&#39;EXIT&#39;, Pid, Other} Terminates with reason Other MonitorsUnlike links, monitors are unidirectional. The monitoring process receives a message {&#39;DOWN&#39;, Reference, process, Pid, Reason} in its mailbox when the monitored process terminates, but no signal is sent in the opposite direction. Setting up monitors with the BIF: 1Reference = monitor(process, Pid) The Reference can be used to identify the particular monitor if more than one is set up. To remove a monitor, use: 1demonitor(Reference) Monitors vs Links Feature Links Monitors Directionality Bidirectional Unidirectional Default behavior Crash together Message on exit Signal propagation Both directions One direction Setup function link/1 monitor/2 Remove function unlink/1 demonitor/1 Example123456781&gt; Pid = spawn(fun() -&gt; receive X -&gt; X end end).&lt;0.25.0&gt;2&gt; Ref = monitor(process, Pid).#Ref&lt;0.0.0.26&gt;3&gt; exit(Pid, reason).true4&gt; receive X -&gt; X end.&#123;&#x27;DOWN&#x27;,#Ref&lt;0.0.0.26&gt;,process,&lt;0.25.0&gt;,reason&#125; Summary Links create a bidirectional connection between processes. When one dies, all linked processes receive an exit signal. Monitors create a unidirectional observation. The monitoring process receives a &#39;DOWN&#39; message when the monitored process terminates. Use process_flag(trap_exit, true) to convert exit signals into messages. The kill reason cannot be trapped and always terminates the process.","categories":[{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"Erlang","slug":"technology/Erlang","permalink":"https://hzsunzixiang.github.io/categories/technology/Erlang/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"OTP","slug":"OTP","permalink":"https://hzsunzixiang.github.io/tags/OTP/"},{"name":"å¹¶å‘ç¼–ç¨‹","slug":"å¹¶å‘ç¼–ç¨‹","permalink":"https://hzsunzixiang.github.io/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"},{"name":"è¿›ç¨‹é“¾æ¥","slug":"è¿›ç¨‹é“¾æ¥","permalink":"https://hzsunzixiang.github.io/tags/%E8%BF%9B%E7%A8%8B%E9%93%BE%E6%8E%A5/"},{"name":"ç›‘è§†å™¨","slug":"ç›‘è§†å™¨","permalink":"https://hzsunzixiang.github.io/tags/%E7%9B%91%E8%A7%86%E5%99%A8/"}]},{"title":"ç¬¬å››ç« ï¼šé€šç”¨å‹æœåŠ¡å™¨ gen_server","slug":"erlang-erlang-otp-gen-server","date":"2024-01-17T16:00:00.000Z","updated":"2026-01-14T16:00:00.000Z","comments":true,"path":"2024/01/18/erlang-erlang-otp-gen-server/","permalink":"https://hzsunzixiang.github.io/2024/01/18/erlang-erlang-otp-gen-server/","excerpt":"æœ¬æ–‡ä»‹ç» Erlang&#x2F;OTP ä¸­çš„é€šç”¨å‹æœåŠ¡å™¨è¡Œä¸ºæ¨¡å¼ gen_serverï¼Œè¿™æ˜¯ OTP æ¡†æ¶ä¸­æœ€å¸¸ç”¨çš„ behavior ä¹‹ä¸€ã€‚","text":"æœ¬æ–‡ä»‹ç» Erlang&#x2F;OTP ä¸­çš„é€šç”¨å‹æœåŠ¡å™¨è¡Œä¸ºæ¨¡å¼ gen_serverï¼Œè¿™æ˜¯ OTP æ¡†æ¶ä¸­æœ€å¸¸ç”¨çš„ behavior ä¹‹ä¸€ã€‚ gen_server æ¦‚è¿°gen_server æ˜¯ OTP æä¾›çš„é€šç”¨æœåŠ¡å™¨è¡Œä¸ºæ¨¡å¼ï¼Œå®ƒå°è£…äº†å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹ä¸­çš„å¸¸è§æ¨¡å¼ï¼Œè®©å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘è€Œä¸æ˜¯åº•å±‚çš„è¿›ç¨‹é€šä¿¡ç»†èŠ‚ã€‚ ä½¿ç”¨ gen_server çš„ä¼˜åŠ¿ï¼š æ ‡å‡†åŒ–çš„æœåŠ¡å™¨å®ç°æ¨¡å¼ å†…ç½®çš„é”™è¯¯å¤„ç†æœºåˆ¶ æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥æ¶ˆæ¯ä¼ é€’ ä¸ OTP ç›‘ç£æ ‘æ— ç¼é›†æˆ behavior æŒ‡ä»¤è¦å®ç°ä¸€ä¸ª gen_serverï¼Œéœ€è¦åœ¨æ¨¡å—ä¸­å£°æ˜ behaviorï¼š 123456789-module(my_server).-behaviour(gen_server).%% API-export([start_link/0, stop/0]).%% gen_server å›è°ƒå‡½æ•°-export([init/1, handle_call/3, handle_cast/2, handle_info/2, terminate/2, code_change/3]). å¯åŠ¨ä¸€ä¸ª servergen_server æä¾›äº†å¤šç§å¯åŠ¨å‡½æ•°ï¼š 12345678%% å¯åŠ¨ä¸€ä¸ªåŒ¿åæœåŠ¡å™¨gen_server:start_link(Module, Args, Options)%% å¯åŠ¨ä¸€ä¸ªå‘½åæœåŠ¡å™¨ï¼ˆæœ¬åœ°æ³¨å†Œï¼‰gen_server:start_link(&#123;local, Name&#125;, Module, Args, Options)%% å¯åŠ¨ä¸€ä¸ªå‘½åæœåŠ¡å™¨ï¼ˆå…¨å±€æ³¨å†Œï¼‰gen_server:start_link(&#123;global, Name&#125;, Module, Args, Options) å¯åŠ¨æ—¶ä¼šè°ƒç”¨ init/1 å›è°ƒå‡½æ•°ï¼š 1234init(Args) -&gt; %% åˆå§‹åŒ–æœåŠ¡å™¨çŠ¶æ€ State = #state&#123;&#125;, &#123;ok, State&#125;. init/1 å¯ä»¥è¿”å›ï¼š {ok, State} - æ­£å¸¸å¯åŠ¨ {ok, State, Timeout} - å¯åŠ¨å¹¶è®¾ç½®è¶…æ—¶ {ok, State, hibernate} - å¯åŠ¨å¹¶è¿›å…¥ä¼‘çœ  {stop, Reason} - å¯åŠ¨å¤±è´¥ ignore - å¿½ç•¥å¯åŠ¨ æ¶ˆæ¯ä¼ é€’gen_server æ”¯æŒå¤šç§æ¶ˆæ¯ä¼ é€’æ–¹å¼ï¼š åŒæ­¥å¼æ¶ˆæ¯ä¼ é€’ä½¿ç”¨ gen_server:call/2,3 å‘é€åŒæ­¥è¯·æ±‚ï¼Œå®¢æˆ·ç«¯ä¼šé˜»å¡ç­‰å¾…å“åº”ï¼š 12345678%% å®¢æˆ·ç«¯è°ƒç”¨Result = gen_server:call(ServerRef, Request),Result = gen_server:call(ServerRef, Request, Timeout).%% æœåŠ¡å™¨ç«¯å¤„ç†handle_call(Request, From, State) -&gt; Reply = do_something(Request), &#123;reply, Reply, State&#125;. handle_call/3 çš„å‚æ•°ï¼š Request - å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ From - è°ƒç”¨è€…ä¿¡æ¯ {Pid, Tag} State - å½“å‰æœåŠ¡å™¨çŠ¶æ€ å¼‚æ­¥å¼æ¶ˆæ¯ä¼ é€’ä½¿ç”¨ gen_server:cast/2 å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå®¢æˆ·ç«¯ä¸ç­‰å¾…å“åº”ï¼š 1234567%% å®¢æˆ·ç«¯è°ƒç”¨ok = gen_server:cast(ServerRef, Msg).%% æœåŠ¡å™¨ç«¯å¤„ç†handle_cast(Msg, State) -&gt; NewState = process_msg(Msg, State), &#123;noreply, NewState&#125;. å…¶ä»–æ¶ˆæ¯æœåŠ¡å™¨å¯èƒ½æ”¶åˆ°ä¸æ˜¯é€šè¿‡ call æˆ– cast å‘é€çš„æ¶ˆæ¯ï¼Œè¿™äº›æ¶ˆæ¯ç”± handle_info/2 å¤„ç†ï¼š 123456789101112handle_info(Info, State) -&gt; case Info of timeout -&gt; %% å¤„ç†è¶…æ—¶ &#123;noreply, State&#125;; &#123;nodedown, Node&#125; -&gt; %% å¤„ç†èŠ‚ç‚¹æ–­å¼€ &#123;noreply, State&#125;; _Other -&gt; %% å¿½ç•¥æœªçŸ¥æ¶ˆæ¯ &#123;noreply, State&#125; end. æœªå¤„ç†çš„æ¶ˆæ¯è‰¯å¥½çš„å®è·µæ˜¯åœ¨ handle_info/2 ä¸­è®°å½•æœªé¢„æœŸçš„æ¶ˆæ¯ï¼š 123handle_info(Msg, State) -&gt; error_logger:warning_msg(&quot;Unexpected message: ~p~n&quot;, [Msg]), &#123;noreply, State&#125;. åŒæ­¥å®¢æˆ·ç«¯å®ç°ä¸€ä¸ªå®Œæ•´çš„åŒæ­¥å®¢æˆ·ç«¯ APIï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354-module(kv_store).-behaviour(gen_server).%% API-export([start_link/0, get/1, put/2, delete/1]).%% gen_server callbacks-export([init/1, handle_call/3, handle_cast/2, handle_info/2, terminate/2, code_change/3]).-record(state, &#123;store = #&#123;&#125;&#125;).%%% API å‡½æ•°start_link() -&gt; gen_server:start_link(&#123;local, ?MODULE&#125;, ?MODULE, [], []).get(Key) -&gt; gen_server:call(?MODULE, &#123;get, Key&#125;).put(Key, Value) -&gt; gen_server:call(?MODULE, &#123;put, Key, Value&#125;).delete(Key) -&gt; gen_server:call(?MODULE, &#123;delete, Key&#125;).%%% å›è°ƒå‡½æ•°init([]) -&gt; &#123;ok, #state&#123;&#125;&#125;.handle_call(&#123;get, Key&#125;, _From, State = #state&#123;store = Store&#125;) -&gt; Reply = maps:get(Key, Store, undefined), &#123;reply, Reply, State&#125;;handle_call(&#123;put, Key, Value&#125;, _From, State = #state&#123;store = Store&#125;) -&gt; NewStore = maps:put(Key, Value, Store), &#123;reply, ok, State#state&#123;store = NewStore&#125;&#125;;handle_call(&#123;delete, Key&#125;, _From, State = #state&#123;store = Store&#125;) -&gt; NewStore = maps:remove(Key, Store), &#123;reply, ok, State#state&#123;store = NewStore&#125;&#125;.handle_cast(_Msg, State) -&gt; &#123;noreply, State&#125;.handle_info(_Info, State) -&gt; &#123;noreply, State&#125;.terminate(_Reason, _State) -&gt; ok.code_change(_OldVsn, State, _Extra) -&gt; &#123;ok, State&#125;. ç»ˆæ­¢æœåŠ¡å™¨ç»ˆæ­¢æ—¶ä¼šè°ƒç”¨ terminate/2ï¼š 1234terminate(Reason, State) -&gt; %% æ¸…ç†èµ„æº cleanup(State), ok. ç»ˆæ­¢åŸå› å¯èƒ½æ˜¯ï¼š normal - æ­£å¸¸ç»ˆæ­¢ shutdown - ç›‘ç£è€…è¦æ±‚å…³é—­ {shutdown, Term} - å¸¦é¢å¤–ä¿¡æ¯çš„å…³é—­ å…¶ä»–å€¼ - å¼‚å¸¸ç»ˆæ­¢ è°ƒç”¨è¶…æ—¶gen_server:call/3 æ”¯æŒè®¾ç½®è¶…æ—¶æ—¶é—´ï¼š 12345678%% é»˜è®¤è¶…æ—¶ 5000msgen_server:call(Server, Request).%% è‡ªå®šä¹‰è¶…æ—¶gen_server:call(Server, Request, 10000). %% 10ç§’%% æ— é™ç­‰å¾…gen_server:call(Server, Request, infinity). è¶…æ—¶åå®¢æˆ·ç«¯ä¼šæ”¶åˆ° exit ä¿¡å·ï¼š 123456try gen_server:call(Server, Request, 5000)catch exit:&#123;timeout, _&#125; -&gt; &#123;error, timeout&#125;end. æ­»é”é¿å… gen_server æ­»é”çš„å‡ ä¸ªåŸåˆ™ï¼š ä¸è¦åœ¨å›è°ƒå‡½æ•°ä¸­è°ƒç”¨è‡ªå·±ï¼š 1234%% é”™è¯¯ç¤ºä¾‹ - ä¼šå¯¼è‡´æ­»é”handle_call(get_twice, _From, State) -&gt; Result1 = gen_server:call(self(), get), %% æ­»é”ï¼ &#123;reply, Result1, State&#125;. é¿å…å¾ªç¯è°ƒç”¨ï¼š 12%% Server A è°ƒç”¨ Server Bï¼ŒServer B åˆè°ƒç”¨ Server A%% è¿™ä¼šå¯¼è‡´æ­»é” ä½¿ç”¨ cast ä»£æ›¿ call æ‰“ç ´å¾ªç¯ é€šç”¨å‹ server çš„è¶…æ—¶é—®é¢˜å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­è¿”å›è¶…æ—¶å€¼ï¼š 12345678910init([]) -&gt; &#123;ok, #state&#123;&#125;, 5000&#125;. %% 5ç§’åè§¦å‘ timeouthandle_call(Request, _From, State) -&gt; &#123;reply, ok, State, 5000&#125;. %% é‡ç½®è¶…æ—¶handle_info(timeout, State) -&gt; %% å¤„ç†è¶…æ—¶ï¼Œä¾‹å¦‚æ‰§è¡Œå®šæœŸä»»åŠ¡ do_periodic_work(), &#123;noreply, State, 5000&#125;. %% ç»§ç»­ç­‰å¾…ä¸‹ä¸€ä¸ªè¶…æ—¶ ä½¿ behavior ä¼‘çœ å½“æœåŠ¡å™¨ç©ºé—²æ—¶ï¼Œå¯ä»¥è®©å®ƒè¿›å…¥ä¼‘çœ çŠ¶æ€ä»¥é‡Šæ”¾å†…å­˜ï¼š 12345678handle_call(Request, _From, State) -&gt; &#123;reply, ok, State, hibernate&#125;.handle_cast(Msg, State) -&gt; &#123;noreply, State, hibernate&#125;.handle_info(Info, State) -&gt; &#123;noreply, State, hibernate&#125;. ä¼‘çœ æ—¶ï¼Œè¿›ç¨‹ä¼šè¿›è¡Œåƒåœ¾å›æ”¶å¹¶æœ€å°åŒ–å†…å­˜å ç”¨ã€‚æ”¶åˆ°æ–°æ¶ˆæ¯æ—¶è‡ªåŠ¨å”¤é†’ã€‚ å…¨å±€åŒ–ä½¿ç”¨å…¨å±€åç§°æ³¨å†Œ gen_serverï¼š 123456%% å…¨å±€æ³¨å†Œå¯åŠ¨gen_server:start_link(&#123;global, my_global_server&#125;, ?MODULE, [], []).%% å…¨å±€è°ƒç”¨gen_server:call(&#123;global, my_global_server&#125;, Request).gen_server:cast(&#123;global, my_global_server&#125;, Msg). ä¹Ÿå¯ä»¥ä½¿ç”¨ via å…ƒç»„ä¸è‡ªå®šä¹‰æ³¨å†Œè¡¨ï¼š 12%% ä½¿ç”¨ gproc ä½œä¸ºæ³¨å†Œè¡¨gen_server:start_link(&#123;via, gproc, &#123;n, l, my_server&#125;&#125;, ?MODULE, [], []). é“¾æ¥ behaviorgen_server é€šå¸¸ä¸ç›‘ç£è€…é“¾æ¥ä½¿ç”¨ï¼š 1234567891011%% åœ¨ç›‘ç£è€…ä¸­å®šä¹‰å­è§„èŒƒinit([]) -&gt; Children = [ #&#123;id =&gt; my_server, start =&gt; &#123;my_server, start_link, []&#125;, restart =&gt; permanent, shutdown =&gt; 5000, type =&gt; worker, modules =&gt; [my_server]&#125; ], &#123;ok, &#123;#&#123;strategy =&gt; one_for_one&#125;, Children&#125;&#125;. gen_server ç”Ÿå‘½å‘¨æœŸ æ€»ç»“gen_server æ˜¯ Erlang&#x2F;OTP ä¸­æœ€é‡è¦çš„ behavior ä¹‹ä¸€ï¼š ç‰¹æ€§ è¯´æ˜ åŒæ­¥è°ƒç”¨ call/2,3 + handle_call/3 å¼‚æ­¥è°ƒç”¨ cast/2 + handle_cast/2 å…¶ä»–æ¶ˆæ¯ handle_info/2 ç”Ÿå‘½å‘¨æœŸ init/1 â†’ è¿è¡Œ â†’ terminate/2 è¶…æ—¶å¤„ç† å›è°ƒè¿”å›å€¼ä¸­æŒ‡å®š ä¼‘çœ  hibernate é€‰é¡¹ æŒæ¡ gen_server æ˜¯å­¦ä¹  OTP çš„åŸºç¡€ï¼Œå®ƒä¸ºæ„å»ºå¥å£®çš„å¹¶å‘åº”ç”¨æä¾›äº†æ ‡å‡†åŒ–çš„æ¨¡å¼ã€‚ æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆä¸‹ä¸€ç« æˆ‘ä»¬å°†å­¦ä¹  gen_statemï¼ˆæœ‰é™çŠ¶æ€æœºï¼‰è¡Œä¸ºæ¨¡å¼ï¼Œå®ƒé€‚ç”¨äºéœ€è¦çŠ¶æ€è½¬æ¢çš„åœºæ™¯ã€‚ ç›¸å…³èµ„æº Erlang gen_server å®˜æ–¹æ–‡æ¡£ OTP Design Principles","categories":[{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"Erlang/OTP","slug":"technology/Erlang-OTP","permalink":"https://hzsunzixiang.github.io/categories/technology/Erlang-OTP/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"OTP","slug":"OTP","permalink":"https://hzsunzixiang.github.io/tags/OTP/"},{"name":"å¹¶å‘ç¼–ç¨‹","slug":"å¹¶å‘ç¼–ç¨‹","permalink":"https://hzsunzixiang.github.io/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"},{"name":"gen_server","slug":"gen-server","permalink":"https://hzsunzixiang.github.io/tags/gen-server/"}]},{"title":"æµ‹è¯• Giscus è¯„è®ºåŠŸèƒ½","slug":"test-giscus-comments","date":"2024-01-16T16:00:00.000Z","updated":"2026-01-16T04:38:09.166Z","comments":true,"path":"2024/01/17/test-giscus-comments/","permalink":"https://hzsunzixiang.github.io/2024/01/17/test-giscus-comments/","excerpt":"","text":"æµ‹è¯•è¯„è®ºåŠŸèƒ½è¿™æ˜¯ä¸€ç¯‡æµ‹è¯•æ–‡ç« ï¼Œç”¨äºéªŒè¯ Giscus è¯„è®ºç³»ç»Ÿæ˜¯å¦æ­£å¸¸å·¥ä½œã€‚ åŠŸèƒ½æµ‹è¯• âœ… è¯„è®ºåŠŸèƒ½ âœ… ç‚¹èµ&#x2F;è¡¨æƒ…ååº” âœ… GitHub è´¦å·ç™»å½• è¯·åœ¨ä¸‹æ–¹è¯„è®ºåŒºæµ‹è¯•æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨ï¼Œæ‚¨åº”è¯¥èƒ½çœ‹åˆ°è¯„è®ºåŒºã€‚ å¦‚æœçœ‹åˆ° â€œä½¿ç”¨ GitHub ç™»å½•â€ çš„æç¤ºï¼Œè¯´æ˜ Giscus å·²æ­£ç¡®åŠ è½½ã€‚","categories":[{"name":"æµ‹è¯•","slug":"æµ‹è¯•","permalink":"https://hzsunzixiang.github.io/categories/%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"Test","slug":"Test","permalink":"https://hzsunzixiang.github.io/tags/Test/"}]},{"title":"Erlang çŸ¥è¯†ç‚¹æ±‡æ€»","slug":"erlang-erlang-basic-knowledge","date":"2024-01-15T16:00:00.000Z","updated":"2026-01-16T04:38:09.166Z","comments":true,"path":"2024/01/16/erlang-erlang-basic-knowledge/","permalink":"https://hzsunzixiang.github.io/2024/01/16/erlang-erlang-basic-knowledge/","excerpt":"Erlang çŸ¥è¯†ç‚¹æ±‡æ€»æœ¬æ–‡æ±‡æ€»äº† Erlang å¼€å‘ä¸­çš„å¸¸ç”¨çŸ¥è¯†ç‚¹ï¼ŒåŒ…æ‹¬åŸºç¡€è¯­æ³•ã€åˆ†å¸ƒå¼èŠ‚ç‚¹é€šä¿¡ã€è°ƒè¯•æŠ€å·§ç­‰ã€‚","text":"Erlang çŸ¥è¯†ç‚¹æ±‡æ€»æœ¬æ–‡æ±‡æ€»äº† Erlang å¼€å‘ä¸­çš„å¸¸ç”¨çŸ¥è¯†ç‚¹ï¼ŒåŒ…æ‹¬åŸºç¡€è¯­æ³•ã€åˆ†å¸ƒå¼èŠ‚ç‚¹é€šä¿¡ã€è°ƒè¯•æŠ€å·§ç­‰ã€‚ åŸºç¡€è¯­æ³•å¸¸ç”¨å‡½æ•° list_to_integer - åˆ—è¡¨è½¬æ•´æ•° byte_size - è·å–å­—èŠ‚å¤§å° {packet, http_bin} - HTTP äºŒè¿›åˆ¶åŒ…é€‰é¡¹ å®šä¹‰å’ŒåŠ è½½ Record12345% å®šä¹‰ recordrd(factorial, &#123;nodeName, comment, createdOn&#125;).% åŠ è½½ recordrr(amqp_connection). å‚è€ƒ: Erlang â€“ shell åˆ›å»º Mnesia è¡¨123456789101112131415rd(factorial, &#123;nodeName, comment, createdOn&#125;).% å†…å­˜è¡¨Result = mnesia:create_table(factorial, [ &#123;attributes, record_info(fields, factorial)&#125;, &#123;type, bag&#125;, &#123;ram_copies, [node()]&#125;]).% ç£ç›˜è¡¨Result2 = mnesia:create_table(factorial1, [ &#123;attributes, record_info(fields, factorial)&#125;, &#123;type, bag&#125;, &#123;disc_copies, [node()]&#125;]). æŸ¥çœ‹ Mnesia è¡¨ä¿¡æ¯ å¾ªç¯ä¸åˆ—è¡¨æ“ä½œç”Ÿæˆæ•°ç»„1[X || X &lt;- lists:seq(1,100), X rem 2 == 0]. éå†æ•°ç»„1lists:foldl(fun(X, Sum) -&gt; X + Sum end, 0, [X || X &lt;- lists:seq(1,100)]). è°ƒç”¨100æ¬¡æŸå‡½æ•°1lists:foldl(fun(X, Sum) -&gt; database_logic:storeDB(node(), X) end, 0, [X || X &lt;- lists:seq(1,100)]). lists:takewhile Module Attributeså‚è€ƒ: Erlang â€“ Modules Module Attributes with Tuple123456789101112131415161718192021-module(rabbit).-author(&quot;TutorialPoint&quot;).-version(&quot;1.0&quot;).-module_description(&quot;This is an example module.&quot;).-rabbit_boot_step(&#123;pre_boot, [&#123;description, &quot;rabbit boot start&quot;&#125;]&#125;).-rabbit_boot_step(&#123;codec_correctness_check, [&#123;description, &quot;codec correctness check&quot;&#125;, &#123;mfa, &#123;rabbit_binary_generator, check_empty_frame_size, []&#125;&#125;, &#123;requires, pre_boot&#125;, &#123;enables, external_infrastructure&#125;]&#125;).-export([start/0]).start() -&gt; io:fwrite(&quot;Hello World\\n&quot;), ModuleInfo = rabbit:module_info(), Attributes = rabbit:module_info(attributes), io:format(&quot;~p~n&quot;, [Attributes]), finish. åˆ†å¸ƒå¼èŠ‚ç‚¹Hidden Node å‚è€ƒ: Erlang â€“ Distributed Erlang è¿œç¨‹è¿æ¥ MQ èŠ‚ç‚¹ä½¿ç”¨ net_kernel:connect_nodeå‚è€ƒ: net_kernel:connect_node&#x2F;1 éœ€è¦ç»™èŠ‚ç‚¹èµ·ä¸ªåå­—ï¼š 1erl -sname apple 12(apple@kvm_10_21_1_163)1&gt; net_kernel:connect_node(&#x27;rabbit@kvm_10_20_1_60&#x27;).true ä½¿ç”¨ net_adm:pingæ³¨æ„æ˜¯ -sname åœ¨ç”Ÿæ•ˆï¼Œä¸ç”¨ -nameï¼Œèƒ½å¤Ÿåœ¨è¿œç¨‹èŠ‚ç‚¹ç”Ÿæ•ˆã€‚ ä½¿ç”¨ rpc:call ä½¿ç”¨æ¶ˆæ¯å‘é€ ! ä½¿ç”¨ monitor case1: èŠ‚ç‚¹ä¸å­˜åœ¨case2: èŠ‚ç‚¹å­˜åœ¨ï¼ŒæœåŠ¡ä¸å­˜åœ¨ï¼Œå»ºç«‹è¿æ¥case3: è¿œç¨‹èŠ‚ç‚¹å’Œè¿›ç¨‹éƒ½å­˜åœ¨ Observer è¿œç¨‹è§‚å¯Ÿæ­¥éª¤ æ–°èµ·ä¸€ä¸ªèŠ‚ç‚¹ å¯åŠ¨ observer è¿æ¥å…¶ä»– node åœ¨æœ¬æœºä¸Šå³ä½¿ä¸è¿æ¥ï¼Œèƒ½çœ‹åˆ°å…¶ä»–èŠ‚ç‚¹çš„æ—¶å€™ä¹Ÿå¯ä»¥ç›´æ¥åˆ‡æ¢ã€‚åœ¨è¿œç¨‹ï¼Œå¿…é¡»å…ˆè¿æ¥ä¸Šï¼Œç„¶åå†åˆ‡æ¢ã€‚ æˆ–è€…ç”¨å‘½ä»¤è¡Œï¼š åˆ‡æ¢åˆ°å…¶ä»–èŠ‚ç‚¹ æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯ è°ƒè¯• RabbitMQ èŠ‚ç‚¹èŠ‚ç‚¹æ— æ³•è¿æ¥çš„è°ƒè¯• æŸ¥çœ‹é˜²ç«å¢™ï¼Œå¦‚æœæœ‰ï¼Œéœ€è¦å…³é—­ åˆæ­¥å¯åŠ¨ åœæ­¢12(rabbit@centos7-mq1)2&gt; rabbit:stop().ok å†æ¬¡å¼€å¯12(rabbit@centos7-mq1)4&gt; rabbit:start().ok Node ä½ç½®æ— å…³æ€§ ä»£ç åŠ è½½ä¸æ¨¡å—ç®¡ç†åˆ—å‡ºå·²åŠ è½½çš„åº“ï¼ˆç¬¦å·è¡¨ï¼‰12code:all_loaded().rp(code:all_loaded()). åŠ è½½æ¨¡å—1(apple@rabbitmq-1)11&gt; l(ping). æŸ¥çœ‹åŒ…ä¾èµ–123% ç›´æ¥å¯åŠ¨è¯•è¯•application:ensure_all_started(systemd).&#123;ok,[enough,systemd]&#125; ä» rebar.config ä¸­æŸ¥çœ‹: {deps, [enough]}. rebar3 deps rebar3 tree make list-deps æŠŠèŠ‚ç‚¹å˜æˆåˆ†å¸ƒå¼èŠ‚ç‚¹å‚è€ƒ: Erlang â€“ net_kernel 1net_kernel:start([foo, shortnames]). å¯åŠ¨ä¹‹å‰ å¯åŠ¨ä¹‹å å¤šå‡ºæ¥çš„éƒ¨åˆ†ï¼š æºç ä½ç½®: /home/ericksun/program/otp-25.0.4/lib/erlang/lib/kernel-8.4.2/src/erl_distribution.erl å¼‚å¸¸å¤„ç† catch ä¹‹åä¸ä¼šç»“æŸå½“å‰è¿›ç¨‹ begin..endå‚è€ƒ: What is beginâ€¦end in Erlang used for? è¿›ç¨‹é€šä¿¡$ dollar sign å‘é€ä¿¡æ¯åˆ°è¿œç¨‹èŠ‚ç‚¹å‚è€ƒ: Erlang â€“ Concurrent Programming 1&#123;pong, Pong_Node&#125; ! &#123;ping, self()&#125;, ä½¿ç”¨ tuple {registered_name, node_name} ä»£æ›¿å•ç‹¬çš„ registered_nameã€‚ è¿›ç¨‹çš„æ³¨å†Œå’Œè·å– è·å–è¿œç¨‹è¿›ç¨‹ PIDé€šè¿‡ register æ–¹å¼ï¼š ç›´æ¥ç”¨è¿œç¨‹ PID å‘é€æ¶ˆæ¯io_request å‘é€åˆ°è¿œç¨‹ï¼Œæ— æ³•ç›´æ¥æ‰§è¡Œæ‰“å°çš„æ—¶å€™ï¼Œæ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼š å‘ç»™ group_leader ç›´æ¥æ‰§è¡Œï¼Œä¸ä¼šæ”¾åˆ°è¿›ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼š Observer è§‚å¯Ÿæ¶ˆæ¯é˜Ÿåˆ— æ¨¡å¼åŒ¹é…1calls(TSpecs = [_|_], &#123;Max, Time&#125;, Opts) Pattern matching çš„é‡è¦ç”¨é€”ï¼š é€‰æ‹©æ§åˆ¶æµåˆ†æ”¯ æ‰§è¡Œå˜é‡èµ‹å€¼ï¼ˆç»‘å®šï¼‰ è§£æ„æ•°æ®ç»“æ„ï¼ˆé€‰æ‹©å’Œæå–éƒ¨åˆ†ï¼‰ å‡½æ•°å‚æ•°ä¸­çš„æ¨¡å¼åŒ¹é… #state{...}=State æ˜¯åˆ«åæ¨¡å¼ï¼šåŒæ—¶åŒ¹é…å’Œèµ‹å€¼ã€‚ çŸ­è·¯æ±‚å€¼å‚è€ƒ: Erlang â€“ Expressions 12Expr1 orelse Expr2Expr1 andalso Expr2 ä¿®æ”¹ååªå…è®¸ä¸€ä¸ªå®ä¾‹å­˜åœ¨ï¼š å¸¸ç”¨å·¥å…·å‡½æ•°net_adm:localhost&#x2F;0121&gt; net_adm:localhost().&quot;centos7-mq1&quot; åˆ—è¡¨æ‰“å°å®Œå…¨rp(Term) - ä½¿ç”¨ shell å·²çŸ¥çš„ record å®šä¹‰æ‰“å° termï¼Œä¸é™åˆ¶æ·±åº¦ã€‚ 1rp(code:all_loaded()). å‚è€ƒ: Erlang â€“ shell æŸ¥çœ‹ Event ä¸­æ‰€æœ‰çš„ Handleré’ˆå¯¹æ—§ç‰ˆ error_loggerï¼š 1gen_event:which_handlers(error_logger). é’ˆå¯¹æ–°çš„ logger æ¨¡å—ï¼ˆOTP 21.0+ï¼‰ï¼š 1logger:get_handler_config(). ç›¸å…³èµ„æº Erlang â€“ erlang Erlang â€“ logger Erlang â€“ code Learn You Some Erlang Core Erlang by Example","categories":[{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"Erlang","slug":"technology/Erlang","permalink":"https://hzsunzixiang.github.io/categories/technology/Erlang/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"åˆ†å¸ƒå¼ç³»ç»Ÿ","slug":"åˆ†å¸ƒå¼ç³»ç»Ÿ","permalink":"https://hzsunzixiang.github.io/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"}]}],"categories":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/RabbitMQ/"},{"name":"technology","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"Erlang","slug":"technology/Erlang","permalink":"https://hzsunzixiang.github.io/categories/technology/Erlang/"},{"name":"æŠ€æœ¯","slug":"technology","permalink":"https://hzsunzixiang.github.io/categories/technology/"},{"name":"RabbitMQ","slug":"technology/RabbitMQ","permalink":"https://hzsunzixiang.github.io/categories/technology/RabbitMQ/"},{"name":"Erlang/OTP","slug":"technology/Erlang-OTP","permalink":"https://hzsunzixiang.github.io/categories/technology/Erlang-OTP/"},{"name":"æµ‹è¯•","slug":"æµ‹è¯•","permalink":"https://hzsunzixiang.github.io/categories/%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"Erlang","slug":"Erlang","permalink":"https://hzsunzixiang.github.io/tags/Erlang/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://hzsunzixiang.github.io/tags/RabbitMQ/"},{"name":"æ¶æ„åˆ†æ","slug":"æ¶æ„åˆ†æ","permalink":"https://hzsunzixiang.github.io/tags/%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90/"},{"name":"ä¾èµ–æ¨¡å—","slug":"ä¾èµ–æ¨¡å—","permalink":"https://hzsunzixiang.github.io/tags/%E4%BE%9D%E8%B5%96%E6%A8%A1%E5%9D%97/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"https://hzsunzixiang.github.io/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"},{"name":"é˜Ÿåˆ—ç®¡ç†","slug":"é˜Ÿåˆ—ç®¡ç†","permalink":"https://hzsunzixiang.github.io/tags/%E9%98%9F%E5%88%97%E7%AE%A1%E7%90%86/"},{"name":"è°ƒè¯•","slug":"è°ƒè¯•","permalink":"https://hzsunzixiang.github.io/tags/%E8%B0%83%E8%AF%95/"},{"name":"trace","slug":"trace","permalink":"https://hzsunzixiang.github.io/tags/trace/"},{"name":"dbg","slug":"dbg","permalink":"https://hzsunzixiang.github.io/tags/dbg/"},{"name":"ç¼–è¯‘","slug":"ç¼–è¯‘","permalink":"https://hzsunzixiang.github.io/tags/%E7%BC%96%E8%AF%91/"},{"name":"æ„å»ºç³»ç»Ÿ","slug":"æ„å»ºç³»ç»Ÿ","permalink":"https://hzsunzixiang.github.io/tags/%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F/"},{"name":"éƒ¨ç½²","slug":"éƒ¨ç½²","permalink":"https://hzsunzixiang.github.io/tags/%E9%83%A8%E7%BD%B2/"},{"name":"é—®é¢˜æ’æŸ¥","slug":"é—®é¢˜æ’æŸ¥","permalink":"https://hzsunzixiang.github.io/tags/%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/"},{"name":"æ’ä»¶","slug":"æ’ä»¶","permalink":"https://hzsunzixiang.github.io/tags/%E6%8F%92%E4%BB%B6/"},{"name":"æºç ç¼–è¯‘","slug":"æºç ç¼–è¯‘","permalink":"https://hzsunzixiang.github.io/tags/%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/"},{"name":"ç½‘ç»œé…ç½®","slug":"ç½‘ç»œé…ç½®","permalink":"https://hzsunzixiang.github.io/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/"},{"name":"å¼€æºè´¡çŒ®","slug":"å¼€æºè´¡çŒ®","permalink":"https://hzsunzixiang.github.io/tags/%E5%BC%80%E6%BA%90%E8%B4%A1%E7%8C%AE/"},{"name":"macOS","slug":"macOS","permalink":"https://hzsunzixiang.github.io/tags/macOS/"},{"name":"OTP","slug":"OTP","permalink":"https://hzsunzixiang.github.io/tags/OTP/"},{"name":"å¹¶å‘ç¼–ç¨‹","slug":"å¹¶å‘ç¼–ç¨‹","permalink":"https://hzsunzixiang.github.io/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"},{"name":"è¿›ç¨‹é“¾æ¥","slug":"è¿›ç¨‹é“¾æ¥","permalink":"https://hzsunzixiang.github.io/tags/%E8%BF%9B%E7%A8%8B%E9%93%BE%E6%8E%A5/"},{"name":"ç›‘è§†å™¨","slug":"ç›‘è§†å™¨","permalink":"https://hzsunzixiang.github.io/tags/%E7%9B%91%E8%A7%86%E5%99%A8/"},{"name":"gen_server","slug":"gen-server","permalink":"https://hzsunzixiang.github.io/tags/gen-server/"},{"name":"Test","slug":"Test","permalink":"https://hzsunzixiang.github.io/tags/Test/"},{"name":"åˆ†å¸ƒå¼ç³»ç»Ÿ","slug":"åˆ†å¸ƒå¼ç³»ç»Ÿ","permalink":"https://hzsunzixiang.github.io/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"}]}