<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRAQé›†ç¾¤æ„å»ºè¿‡ç¨‹è¯¦ç»†åˆ†æ - åŸºäºæ—¥å¿—è¿½è¸ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.8;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 30px;
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            font-weight: 600;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .content {
            padding: 50px;
        }
        
        .section {
            margin-bottom: 60px;
        }
        
        .section-title {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
        }
        
        .section-title .icon {
            margin-right: 15px;
            font-size: 1.1em;
        }
        
        .subsection-title {
            color: #764ba2;
            font-size: 1.4em;
            margin: 35px 0 20px 0;
            padding-left: 15px;
            border-left: 4px solid #764ba2;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ä»£ç å—æ ·å¼ - é‡ç‚¹ä¼˜åŒ–
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .code-container {
            margin: 25px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }
        
        .code-header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: #68d391;
            padding: 15px 25px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            font-weight: 600;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
        }
        
        .code-header::before {
            content: 'ğŸ“„';
            margin-right: 12px;
            font-size: 1.2em;
        }
        
        .code-body {
            background: #1e1e1e;
            padding: 0;
            overflow-x: auto;
        }
        
        .code-body pre {
            margin: 0;
            padding: 25px 30px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.9;
            color: #d4d4d4;
            white-space: pre;
            overflow-x: auto;
        }
        
        /* è¯­æ³•é«˜äº® */
        .code-body .comment {
            color: #6a9955;
            font-style: italic;
        }
        
        .code-body .keyword {
            color: #569cd6;
            font-weight: bold;
        }
        
        .code-body .function {
            color: #dcdcaa;
        }
        
        .code-body .variable {
            color: #9cdcfe;
        }
        
        .code-body .atom {
            color: #ce9178;
        }
        
        .code-body .string {
            color: #ce9178;
        }
        
        .code-body .number {
            color: #b5cea8;
        }
        
        .code-body .operator {
            color: #d4d4d4;
        }
        
        .code-body .macro {
            color: #4ec9b0;
        }
        
        .code-body .highlight-line {
            background: rgba(255, 215, 0, 0.15);
            display: block;
            margin: 0 -30px;
            padding: 0 30px;
            border-left: 4px solid #ffd700;
        }
        
        .code-body .step-comment {
            color: #ffd700;
            font-weight: bold;
        }
        
        /* å…³é”®ç‚¹æç¤ºæ¡† */
        .key-point {
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.2);
        }
        
        .key-point .title {
            color: #856404;
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .key-point .title::before {
            content: 'ğŸ”¥';
            margin-right: 10px;
            font-size: 1.3em;
        }
        
        .key-point p {
            color: #664d03;
            line-height: 1.8;
        }
        
        .key-point code {
            background: rgba(0,0,0,0.1);
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
            color: #856404;
        }
        
        /* è¡¨æ ¼æ ·å¼ */
        .table-container {
            overflow-x: auto;
            margin: 25px 0;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .styled-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 15px;
        }
        
        .styled-table thead tr {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .styled-table th {
            padding: 18px 20px;
            text-align: left;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .styled-table td {
            padding: 16px 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .styled-table tbody tr:hover {
            background: #f8f9fa;
        }
        
        .styled-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        /* æµç¨‹å›¾ */
        .flow-diagram {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            text-align: center;
        }
        
        .node-box {
            display: inline-block;
            padding: 15px 30px;
            margin: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .arrow {
            font-size: 2em;
            color: #667eea;
            margin: 0 15px;
            font-weight: bold;
        }
        
        /* æ—¶é—´çº¿ */
        .timeline {
            position: relative;
            padding-left: 50px;
            margin: 30px 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 22px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -36px;
            top: 30px;
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 0 0 3px #667eea;
        }
        
        .timeline-item .item-title {
            color: #667eea;
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        /* å†…è”ä»£ç  */
        code {
            background: #2d3748;
            color: #68d391;
            padding: 4px 10px;
            border-radius: 5px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 0.88em;
        }
        
        /* åˆ—è¡¨ */
        ul {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        ul li {
            padding: 12px 0 12px 35px;
            position: relative;
            line-height: 1.7;
        }
        
        ul li::before {
            content: 'â–¸';
            position: absolute;
            left: 12px;
            color: #667eea;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        /* æç¤ºæ¡† */
        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 5px solid #2196f3;
            border-radius: 8px;
            padding: 20px 25px;
            margin: 25px 0;
        }
        
        .info-box p {
            color: #1565c0;
            margin: 0;
        }
        
        .info-box strong {
            color: #0d47a1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ï¸ CRAQé›†ç¾¤æ„å»ºè¿‡ç¨‹è¯¦ç»†åˆ†æ</h1>
            <p>åŸºäº trace_log.2025/trace_log.setup.repl æ—¥å¿—è¿½è¸ª | ä»£ç æ ¼å¼ä¼˜åŒ–ç‰ˆ</p>
        </div>
        
        <div class="content">
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬ä¸€éƒ¨åˆ†: å…³é”®ä»£ç å®šä½
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ”¥</span>å…³é”®ä»£ç å®šä½</h2>
                
                <div class="key-point">
                    <div class="title">ç¬¬ä¸€ä¸ªå…³é”®è¡Œ: src/eh_system_server.erl:81</div>
                    <p>è¿™ä¸€è¡Œè°ƒç”¨ <code>get_ordered_list_pred_succ</code> å‡½æ•°ï¼Œæ ¹æ®èŠ‚ç‚¹åˆ—è¡¨å’Œæ’åºç­–ç•¥ï¼Œè®¡ç®—å½“å‰èŠ‚ç‚¹çš„<strong>å‰é©±èŠ‚ç‚¹</strong>å’Œ<strong>åç»§èŠ‚ç‚¹</strong>ã€‚</p>
                </div>
                
                <div class="code-container">
                    <div class="code-header">src/eh_system_server.erl:81 - è®¡ç®—å‰é©±å’Œåç»§èŠ‚ç‚¹</div>
                    <div class="code-body">
<pre>
<span class="comment">%% ğŸ”¥ è®¡ç®—å‰é©±å’Œåç»§èŠ‚ç‚¹çš„æ ¸å¿ƒå‡½æ•°è°ƒç”¨</span>
{<span class="variable">ReplRing1</span>, <span class="variable">ReplRingOrder1</span>, <span class="variable">Pred</span>, <span class="variable">Succ</span>} <span class="operator">=</span>
    <span class="function">eh_repl_ring:get_ordered_list_pred_succ</span>(
        <span class="variable">NodeId</span>,      <span class="comment">%% å½“å‰èŠ‚ç‚¹ID</span>
        <span class="variable">ReplRing</span>,    <span class="comment">%% å¤åˆ¶ç¯èŠ‚ç‚¹åˆ—è¡¨</span>
        <span class="variable">ReplRing</span>,    <span class="comment">%% èŠ‚ç‚¹æ’åºåˆ—è¡¨</span>
        <span class="variable">NodeOrder</span>    <span class="comment">%% æ’åºç­–ç•¥: sorted</span>
    ),
</pre>
                    </div>
                </div>

                <div class="key-point">
                    <div class="title">ç¬¬äºŒä¸ªå…³é”®è¡Œ: src/eh_system_server.erl:87</div>
                    <p>è¿™ä¸€è¡Œå°†è®¡ç®—å‡ºçš„å‰é©±å’Œåç»§èŠ‚ç‚¹<strong>ä¿å­˜åˆ°çŠ¶æ€ç»“æ„</strong>ä¸­ï¼Œå®ŒæˆèŠ‚ç‚¹æ‹“æ‰‘å…³ç³»çš„æŒä¹…åŒ–å­˜å‚¨ã€‚</p>
                </div>
                
                <div class="code-container">
                    <div class="code-header">src/eh_system_server.erl:87 - ä¿å­˜å‰é©±å’Œåç»§èŠ‚ç‚¹åˆ°çŠ¶æ€</div>
                    <div class="code-body">
<pre>
<span class="comment">%% ğŸ”¥ ä¿å­˜å‰é©±å’Œåç»§èŠ‚ç‚¹åˆ°çŠ¶æ€ç»“æ„ä¸­</span>
<span class="variable">NewState2</span> <span class="operator">=</span> <span class="variable">NewState1</span><span class="operator">#</span><span class="atom">eh_system_state</span>{
    <span class="atom">repl_ring_order</span> <span class="operator">=</span> <span class="variable">ReplRingOrder1</span>,   <span class="comment">%% æ’åºåçš„èŠ‚ç‚¹åˆ—è¡¨</span>
    <span class="atom">repl_ring</span>       <span class="operator">=</span> <span class="variable">ReplRing1</span>,        <span class="comment">%% å¤åˆ¶ç¯èŠ‚ç‚¹åˆ—è¡¨</span>
<span class="highlight-line">    <span class="atom">predecessor</span>     <span class="operator">=</span> <span class="variable">Pred</span>,             <span class="comment">%% ğŸ¯ ä¿å­˜å‰é©±èŠ‚ç‚¹</span></span>
<span class="highlight-line">    <span class="atom">successor</span>       <span class="operator">=</span> <span class="variable">Succ</span>,             <span class="comment">%% ğŸ¯ ä¿å­˜åç»§èŠ‚ç‚¹</span></span>
    <span class="atom">timestamp</span>       <span class="operator">=</span> <span class="variable">Timestamp</span>         <span class="comment">%% åˆå§‹æ—¶é—´æˆ³</span>
},
</pre>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬äºŒéƒ¨åˆ†: å®Œæ•´å¤„ç†æµç¨‹
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ“Š</span>å®Œæ•´å¤„ç†æµç¨‹</h2>
                
                <h3 class="subsection-title">æ ¸å¿ƒå¤„ç†å‡½æ•° (å®Œæ•´æ ¼å¼åŒ–ç‰ˆæœ¬)</h3>
                
                <div class="code-container">
                    <div class="code-header">src/eh_system_server.erl:77-89 - CRAQé›†ç¾¤è®¾ç½®çš„æ ¸å¿ƒå¤„ç†å‡½æ•°</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% CRAQé›†ç¾¤è®¾ç½®çš„æ ¸å¿ƒå¤„ç†å‡½æ•°</span>
<span class="comment">%% åŠŸèƒ½: æ¥æ”¶é›†ç¾¤è®¾ç½®æ¶ˆæ¯ï¼Œè®¡ç®—å¹¶ä¿å­˜èŠ‚ç‚¹æ‹“æ‰‘å…³ç³»</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="keyword">handle_cast</span>(
    {<span class="macro">?EH_SETUP_REPL</span>, <span class="variable">ReplRing</span>},
    <span class="operator">#</span><span class="atom">eh_system_state</span>{<span class="atom">app_config</span> <span class="operator">=</span> <span class="variable">AppConfig</span>} <span class="operator">=</span> <span class="variable">State</span>
) <span class="operator">-></span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”§ Step 1: è·å–èŠ‚ç‚¹åŸºæœ¬ä¿¡æ¯</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="variable">NodeId</span>    <span class="operator">=</span> <span class="function">eh_system_config:get_node_id</span>(<span class="variable">AppConfig</span>),
                <span class="comment">%% è·å–å½“å‰èŠ‚ç‚¹ID, å¦‚: 'ec_n1@rabbitmq4-1'</span>

    <span class="variable">NodeOrder</span> <span class="operator">=</span> <span class="function">eh_system_config:get_node_order</span>(<span class="variable">AppConfig</span>),
                <span class="comment">%% è·å–æ’åºç­–ç•¥, è¿”å›: sorted</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”¥ Step 2: å…³é”®è¡Œ - è®¡ç®—å‰é©±å’Œåç»§èŠ‚ç‚¹</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="highlight-line">    {<span class="variable">ReplRing1</span>, <span class="variable">ReplRingOrder1</span>, <span class="variable">Pred</span>, <span class="variable">Succ</span>} <span class="operator">=</span></span>
<span class="highlight-line">        <span class="function">eh_repl_ring:get_ordered_list_pred_succ</span>(</span>
<span class="highlight-line">            <span class="variable">NodeId</span>,</span>
<span class="highlight-line">            <span class="variable">ReplRing</span>,</span>
<span class="highlight-line">            <span class="variable">ReplRing</span>,</span>
<span class="highlight-line">            <span class="variable">NodeOrder</span></span>
<span class="highlight-line">        ),</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”§ Step 3: è®¾ç½®ç³»ç»Ÿç»„ä»¶</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="variable">FailureDetector</span> <span class="operator">=</span> <span class="function">eh_system_config:get_failure_detector</span>(<span class="variable">AppConfig</span>),
                      <span class="comment">%% è·å–æ•…éšœæ£€æµ‹å™¨æ¨¡å—: eh_failure_detector_api</span>

    <span class="variable">ReplDataManager</span> <span class="operator">=</span> <span class="function">eh_system_config:get_repl_data_manager</span>(<span class="variable">AppConfig</span>),
                      <span class="comment">%% è·å–æ•°æ®ç®¡ç†å™¨æ¨¡å—: eh_repl_data_manager_api</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”§ Step 4: å»ºç«‹æ•…éšœæ£€æµ‹è¿æ¥</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="variable">FailureDetector</span><span class="operator">:</span><span class="function">set</span>(<span class="variable">NodeId</span>, <span class="variable">ReplRing</span>),
    <span class="comment">%% ä¸ºå½“å‰èŠ‚ç‚¹å»ºç«‹ä¸æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹çš„æ•…éšœæ£€æµ‹è¿æ¥</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”§ Step 5: è·å–åˆå§‹æ—¶é—´æˆ³</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    {<span class="variable">Timestamp</span>, <span class="variable">_</span>} <span class="operator">=</span> <span class="variable">ReplDataManager</span><span class="operator">:</span><span class="function">timestamp</span>(),
    <span class="comment">%% è·å–å½“å‰é€»è¾‘æ—¶é—´æˆ³, åˆå§‹å€¼ä¸º 0</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”§ Step 6: æ›´æ–°èŠ‚ç‚¹çŠ¶æ€ä¸ºå°±ç»ª</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="variable">NewState1</span> <span class="operator">=</span> <span class="function">eh_node_state:update_state_ready</span>(<span class="variable">State</span>),
    <span class="comment">%% å°†èŠ‚ç‚¹çŠ¶æ€ä» eh_not_ready æ›´æ–°ä¸º eh_ready</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”¥ Step 7: å…³é”®è¡Œ - ä¿å­˜å‰é©±å’Œåç»§èŠ‚ç‚¹åˆ°çŠ¶æ€ä¸­</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="highlight-line">    <span class="variable">NewState2</span> <span class="operator">=</span> <span class="variable">NewState1</span><span class="operator">#</span><span class="atom">eh_system_state</span>{</span>
<span class="highlight-line">        <span class="atom">repl_ring_order</span> <span class="operator">=</span> <span class="variable">ReplRingOrder1</span>,</span>
<span class="highlight-line">        <span class="atom">repl_ring</span>       <span class="operator">=</span> <span class="variable">ReplRing1</span>,</span>
<span class="highlight-line">        <span class="atom">predecessor</span>     <span class="operator">=</span> <span class="variable">Pred</span>,             <span class="comment">%% ğŸ¯ å‰é©±èŠ‚ç‚¹</span></span>
<span class="highlight-line">        <span class="atom">successor</span>       <span class="operator">=</span> <span class="variable">Succ</span>,             <span class="comment">%% ğŸ¯ åç»§èŠ‚ç‚¹</span></span>
<span class="highlight-line">        <span class="atom">timestamp</span>       <span class="operator">=</span> <span class="variable">Timestamp</span></span>
<span class="highlight-line">    },</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”§ Step 8: å‘é€çŠ¶æ€äº‹ä»¶é€šçŸ¥</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="function">event_state</span>(<span class="string">"setup_repl.99"</span>, <span class="variable">NewState2</span>, <span class="variable">AppConfig</span>),
    <span class="comment">%% å‘é€çŠ¶æ€å˜åŒ–äº‹ä»¶ï¼Œç”¨äºæ—¥å¿—è®°å½•å’Œç›‘æ§</span>

    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    <span class="step-comment">%% ğŸ”§ Step 9: è¿”å›æ–°çŠ¶æ€</span>
    <span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
    {<span class="atom">noreply</span>, <span class="variable">NewState2</span>};
</pre>
                    </div>
                </div>

                <h3 class="subsection-title">å‰é©±åç»§è®¡ç®—å‡½æ•°</h3>
                
                <div class="code-container">
                    <div class="code-header">src/eh_repl_ring.erl:75-79 - è®¡ç®—æœ‰åºåˆ—è¡¨å’Œå‰é©±åç»§èŠ‚ç‚¹</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% è®¡ç®—æœ‰åºåˆ—è¡¨å’Œå‰é©±åç»§èŠ‚ç‚¹çš„æ ¸å¿ƒå‡½æ•°</span>
<span class="comment">%% è¾“å…¥: Node - å½“å‰èŠ‚ç‚¹</span>
<span class="comment">%%       NodeList - èŠ‚ç‚¹åˆ—è¡¨</span>
<span class="comment">%%       NodeOrderList - æ’åºåçš„èŠ‚ç‚¹åˆ—è¡¨</span>
<span class="comment">%%       NodeOrder - æ’åºç­–ç•¥ (sorted)</span>
<span class="comment">%% è¾“å‡º: {æ’åºååˆ—è¡¨, æ’åºåˆ—è¡¨, å‰é©±èŠ‚ç‚¹, åç»§èŠ‚ç‚¹}</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="keyword">get_ordered_list_pred_succ</span>(<span class="variable">Node</span>, <span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>) <span class="operator">-></span>

    <span class="comment">%% Step 1: è·å–æ’åºåçš„èŠ‚ç‚¹åˆ—è¡¨</span>
    {<span class="variable">NodeList1</span>, <span class="variable">NodeOrderList1</span>} <span class="operator">=</span> 
        <span class="function">get_ordered_list</span>(<span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>),

    <span class="comment">%% Step 2: è®¡ç®—å‰é©±èŠ‚ç‚¹</span>
    <span class="variable">Pred</span> <span class="operator">=</span> <span class="function">predecessor</span>(<span class="variable">Node</span>, <span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>),

    <span class="comment">%% Step 3: è®¡ç®—åç»§èŠ‚ç‚¹</span>
    <span class="variable">Succ</span> <span class="operator">=</span> <span class="function">successor</span>(<span class="variable">Node</span>, <span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>),

    <span class="comment">%% Step 4: è¿”å›ç»“æœå…ƒç»„</span>
    {<span class="variable">NodeList1</span>, <span class="variable">NodeOrderList1</span>, <span class="variable">Pred</span>, <span class="variable">Succ</span>}.
</pre>
                    </div>
                </div>

                <h3 class="subsection-title">å‰é©±èŠ‚ç‚¹è®¡ç®—ç®—æ³•</h3>
                
                <div class="code-container">
                    <div class="code-header">src/eh_repl_ring.erl:46-58 - predecessor å‡½æ•°</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% å‰é©±èŠ‚ç‚¹è®¡ç®—ç®—æ³•</span>
<span class="comment">%% åŠŸèƒ½: è®¡ç®—å½“å‰èŠ‚ç‚¹åœ¨é“¾ä¸­çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="keyword">predecessor</span>(<span class="variable">Node</span>, <span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>) <span class="operator">-></span>

    <span class="comment">%% å°†å½“å‰èŠ‚ç‚¹åŠ å…¥åˆ—è¡¨å¹¶æŒ‰ç­–ç•¥æ’åº</span>
    {<span class="variable">NewNodeList</span>, <span class="variable">_</span>} <span class="operator">=</span> <span class="function">add</span>(<span class="variable">Node</span>, <span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>),

    <span class="comment">%% å°†åˆ—è¡¨åˆ†å‰²ä¸ºä¸¤éƒ¨åˆ†:</span>
    <span class="comment">%%   L1 = å½“å‰èŠ‚ç‚¹å‰é¢çš„æ‰€æœ‰èŠ‚ç‚¹</span>
    <span class="comment">%%   L2 = å½“å‰èŠ‚ç‚¹åŠå…¶åé¢çš„æ‰€æœ‰èŠ‚ç‚¹</span>
    {<span class="variable">L1</span>, <span class="variable">L2</span>} <span class="operator">=</span> <span class="function">lists:splitwith</span>(
        <span class="keyword">fun</span>(<span class="variable">N</span>) <span class="operator">-></span> <span class="variable">N</span> <span class="operator">=/=</span> <span class="variable">Node</span> <span class="keyword">end</span>,
        <span class="variable">NewNodeList</span>
    ),

    <span class="comment">%% æ ¹æ®åˆ†å‰²ç»“æœåˆ¤æ–­å‰é©±èŠ‚ç‚¹</span>
    <span class="keyword">case</span> {<span class="function">length</span>(<span class="variable">L1</span>), <span class="function">length</span>(<span class="variable">L2</span>)} <span class="keyword">of</span>

        {<span class="number">0</span>, <span class="number">0</span>} <span class="operator">-></span>
            <span class="atom">undefined</span>;
            <span class="comment">%% æƒ…å†µ1: ç©ºåˆ—è¡¨ï¼Œæ— å‰é©±èŠ‚ç‚¹</span>

        {<span class="number">0</span>, <span class="number">1</span>} <span class="operator">-></span>
            <span class="atom">undefined</span>;
            <span class="comment">%% æƒ…å†µ2: åªæœ‰å½“å‰èŠ‚ç‚¹ï¼Œæ˜¯å¤´èŠ‚ç‚¹ï¼Œæ— å‰é©±</span>

        {<span class="number">0</span>, <span class="variable">_</span>} <span class="operator">-></span>
            <span class="function">lists:last</span>(<span class="variable">L2</span>);
            <span class="comment">%% æƒ…å†µ3: å½“å‰èŠ‚ç‚¹åœ¨é¦–ä½ï¼Œç¯å½¢æ‹“æ‰‘å–æœ€åèŠ‚ç‚¹</span>

        {<span class="variable">_</span>, <span class="variable">_</span>} <span class="operator">-></span>
            <span class="function">lists:last</span>(<span class="variable">L1</span>)
            <span class="comment">%% æƒ…å†µ4: è¿”å›å½“å‰èŠ‚ç‚¹å‰é¢çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹</span>

    <span class="keyword">end</span>.
</pre>
                    </div>
                </div>

                <h3 class="subsection-title">åç»§èŠ‚ç‚¹è®¡ç®—ç®—æ³•</h3>
                
                <div class="code-container">
                    <div class="code-header">src/eh_repl_ring.erl:60-73 - successor å‡½æ•°</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% åç»§èŠ‚ç‚¹è®¡ç®—ç®—æ³•</span>
<span class="comment">%% åŠŸèƒ½: è®¡ç®—å½“å‰èŠ‚ç‚¹åœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="keyword">successor</span>(<span class="variable">Node</span>, <span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>) <span class="operator">-></span>

    <span class="comment">%% å°†å½“å‰èŠ‚ç‚¹åŠ å…¥åˆ—è¡¨å¹¶æŒ‰ç­–ç•¥æ’åº</span>
    {<span class="variable">NewNodeList</span>, <span class="variable">_</span>} <span class="operator">=</span> <span class="function">add</span>(<span class="variable">Node</span>, <span class="variable">NodeList</span>, <span class="variable">NodeOrderList</span>, <span class="variable">NodeOrder</span>),

    <span class="comment">%% å°†åˆ—è¡¨åˆ†å‰²ä¸ºä¸¤éƒ¨åˆ†:</span>
    <span class="comment">%%   L1 = å½“å‰èŠ‚ç‚¹å‰é¢çš„æ‰€æœ‰èŠ‚ç‚¹</span>
    <span class="comment">%%   L2 = å½“å‰èŠ‚ç‚¹åŠå…¶åé¢çš„æ‰€æœ‰èŠ‚ç‚¹</span>
    {<span class="variable">L1</span>, <span class="variable">L2</span>} <span class="operator">=</span> <span class="function">lists:splitwith</span>(
        <span class="keyword">fun</span>(<span class="variable">N</span>) <span class="operator">-></span> <span class="variable">N</span> <span class="operator">=/=</span> <span class="variable">Node</span> <span class="keyword">end</span>,
        <span class="variable">NewNodeList</span>
    ),

    <span class="comment">%% æ ¹æ®åˆ†å‰²ç»“æœåˆ¤æ–­åç»§èŠ‚ç‚¹</span>
    <span class="keyword">case</span> {<span class="function">length</span>(<span class="variable">L1</span>), <span class="function">length</span>(<span class="variable">L2</span>)} <span class="keyword">of</span>

        {<span class="number">0</span>, <span class="number">0</span>} <span class="operator">-></span>
            <span class="atom">undefined</span>;
            <span class="comment">%% æƒ…å†µ1: ç©ºåˆ—è¡¨ï¼Œæ— åç»§èŠ‚ç‚¹</span>

        {<span class="number">0</span>, <span class="number">1</span>} <span class="operator">-></span>
            <span class="atom">undefined</span>;
            <span class="comment">%% æƒ…å†µ2: åªæœ‰å½“å‰èŠ‚ç‚¹ï¼Œæ˜¯å°¾èŠ‚ç‚¹ï¼Œæ— åç»§</span>

        {<span class="variable">_</span>, <span class="number">1</span>} <span class="operator">-></span>
            <span class="function">hd</span>(<span class="variable">L1</span>);
            <span class="comment">%% æƒ…å†µ3: å½“å‰èŠ‚ç‚¹åœ¨æœ«ä½ï¼Œç¯å½¢æ‹“æ‰‘å–ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span>

        {<span class="variable">_</span>, <span class="variable">_</span>} <span class="operator">-></span>
            [<span class="variable">Node</span>, <span class="variable">Succ</span> | <span class="variable">_</span>] <span class="operator">=</span> <span class="variable">L2</span>,
            <span class="variable">Succ</span>
            <span class="comment">%% æƒ…å†µ4: è¿”å›å½“å‰èŠ‚ç‚¹åé¢çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span>

    <span class="keyword">end</span>.
</pre>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬ä¸‰éƒ¨åˆ†: æ—¥å¿—åˆ†æç»“æœ
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ“‹</span>æ—¥å¿—åˆ†æç»“æœ</h2>
                
                <h3 class="subsection-title">å®é™…æ‰§è¡Œæ—¶åº</h3>
                
                <div class="table-container">
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>èŠ‚ç‚¹</th>
                                <th>æ¥æ”¶æ—¶é—´</th>
                                <th>å®Œæˆæ—¶é—´</th>
                                <th>è€—æ—¶</th>
                                <th>å‰é©±èŠ‚ç‚¹</th>
                                <th>åç»§èŠ‚ç‚¹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Node1 (å¤´èŠ‚ç‚¹)</strong></td>
                                <td>3:48:12.772661</td>
                                <td>3:48:12.778739</td>
                                <td>6.078ms</td>
                                <td><code>undefined</code></td>
                                <td><code>ec_n2@rabbitmq4-2</code></td>
                            </tr>
                            <tr>
                                <td><strong>Node2 (ä¸­é—´èŠ‚ç‚¹)</strong></td>
                                <td>3:48:12.739684</td>
                                <td>3:48:12.748835</td>
                                <td>9.151ms</td>
                                <td><code>ec_n1@rabbitmq4-1</code></td>
                                <td><code>ec_n3@rabbitmq4-3</code></td>
                            </tr>
                            <tr>
                                <td><strong>Node3 (å°¾èŠ‚ç‚¹)</strong></td>
                                <td>3:48:12.689301</td>
                                <td>3:48:12.700423</td>
                                <td>11.122ms</td>
                                <td><code>ec_n2@rabbitmq4-2</code></td>
                                <td><code>undefined</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="subsection-title">æœ€ç»ˆæ‹“æ‰‘å…³ç³»</h3>
                
                <div class="flow-diagram">
                    <div class="node-box">ec_n1@rabbitmq4-1<br><small>å¤´èŠ‚ç‚¹</small></div>
                    <span class="arrow">â†’</span>
                    <div class="node-box">ec_n2@rabbitmq4-2<br><small>ä¸­é—´èŠ‚ç‚¹</small></div>
                    <span class="arrow">â†’</span>
                    <div class="node-box">ec_n3@rabbitmq4-3<br><small>å°¾èŠ‚ç‚¹</small></div>
                </div>

                <h3 class="subsection-title">æ—¥å¿—ä¸­çš„çŠ¶æ€å˜åŒ–è¯æ®</h3>
                
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="item-title">Node1 æœ€ç»ˆçŠ¶æ€ (trace_log.setup.repl.node1.txt:138)</div>
                        <div class="code-container">
                            <div class="code-body">
<pre>
{<span class="atom">eh_system_state</span>, <span class="atom">eh_ready</span>, <span class="number">0</span>,
    [<span class="atom">'ec_n1@rabbitmq4-1'</span>, <span class="atom">'ec_n2@rabbitmq4-2'</span>, <span class="atom">'ec_n3@rabbitmq4-3'</span>],
    [<span class="atom">'ec_n1@rabbitmq4-1'</span>, <span class="atom">'ec_n2@rabbitmq4-2'</span>, <span class="atom">'ec_n3@rabbitmq4-3'</span>],
    <span class="atom">undefined</span>,                  <span class="comment">%% predecessor: å¤´èŠ‚ç‚¹æ— å‰é©±</span>
    <span class="atom">'ec_n2@rabbitmq4-2'</span>,        <span class="comment">%% successor: åç»§æ˜¯Node2</span>
    ...}
</pre>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="item-title">Node2 æœ€ç»ˆçŠ¶æ€ (trace_log.setup.repl.node2.txt:138)</div>
                        <div class="code-container">
                            <div class="code-body">
<pre>
{<span class="atom">eh_system_state</span>, <span class="atom">eh_ready</span>, <span class="number">0</span>,
    [<span class="atom">'ec_n1@rabbitmq4-1'</span>, <span class="atom">'ec_n2@rabbitmq4-2'</span>, <span class="atom">'ec_n3@rabbitmq4-3'</span>],
    [<span class="atom">'ec_n1@rabbitmq4-1'</span>, <span class="atom">'ec_n2@rabbitmq4-2'</span>, <span class="atom">'ec_n3@rabbitmq4-3'</span>],
    <span class="atom">'ec_n1@rabbitmq4-1'</span>,        <span class="comment">%% predecessor: å‰é©±æ˜¯Node1</span>
    <span class="atom">'ec_n3@rabbitmq4-3'</span>,        <span class="comment">%% successor: åç»§æ˜¯Node3</span>
    ...}
</pre>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="item-title">Node3 æœ€ç»ˆçŠ¶æ€ (trace_log.setup.repl.node3.txt:138)</div>
                        <div class="code-container">
                            <div class="code-body">
<pre>
{<span class="atom">eh_system_state</span>, <span class="atom">eh_ready</span>, <span class="number">0</span>,
    [<span class="atom">'ec_n1@rabbitmq4-1'</span>, <span class="atom">'ec_n2@rabbitmq4-2'</span>, <span class="atom">'ec_n3@rabbitmq4-3'</span>],
    [<span class="atom">'ec_n1@rabbitmq4-1'</span>, <span class="atom">'ec_n2@rabbitmq4-2'</span>, <span class="atom">'ec_n3@rabbitmq4-3'</span>],
    <span class="atom">'ec_n2@rabbitmq4-2'</span>,        <span class="comment">%% predecessor: å‰é©±æ˜¯Node2</span>
    <span class="atom">undefined</span>,                  <span class="comment">%% successor: å°¾èŠ‚ç‚¹æ— åç»§</span>
    ...}
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬å››éƒ¨åˆ†: æ ¸å¿ƒæŠ€æœ¯è¦ç‚¹
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ¯</span>æ ¸å¿ƒæŠ€æœ¯è¦ç‚¹</h2>
                
                <h3 class="subsection-title">èŠ‚ç‚¹è¿æ¥æœºåˆ¶</h3>
                <ul>
                    <li><strong>åˆ†å¸ƒå¼åŒæ­¥</strong>: ä½¿ç”¨ <code>gen_server:abcast</code> å¹¿æ’­è®¾ç½®æ¶ˆæ¯åˆ°æ‰€æœ‰èŠ‚ç‚¹</li>
                    <li><strong>ç‹¬ç«‹è®¡ç®—</strong>: æ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹è°ƒç”¨ <code>get_ordered_list_pred_succ</code> è®¡ç®—æ‹“æ‰‘ä½ç½®</li>
                    <li><strong>ä¸€è‡´æ€§ç®—æ³•</strong>: åŸºäºèŠ‚ç‚¹åå­—å…¸åº (<code>sorted</code>) çš„ç¡®å®šæ€§æ’åº</li>
                </ul>
                
                <h3 class="subsection-title">å‰é©±åç»§ä¿å­˜æœºåˆ¶</h3>
                <ul>
                    <li><strong>å­˜å‚¨ç»“æ„</strong>: <code>eh_system_state</code> è®°å½•çš„ <code>predecessor</code> å’Œ <code>successor</code> å­—æ®µ</li>
                    <li><strong>è®¡ç®—ç®—æ³•</strong>: <code>eh_repl_ring:get_ordered_list_pred_succ</code> å‡½æ•°</li>
                    <li><strong>æŒä¹…åŒ–æ–¹å¼</strong>: ä¿å­˜åœ¨ gen_server è¿›ç¨‹çŠ¶æ€ä¸­</li>
                </ul>
                
                <h3 class="subsection-title">æ€§èƒ½ç‰¹ç‚¹</h3>
                <ul>
                    <li><strong>å¹¶å‘å¤„ç†</strong>: ä¸‰èŠ‚ç‚¹å¹¶è¡Œå¤„ç†ï¼Œå¹³å‡è€—æ—¶ 8.78ms</li>
                    <li><strong>ç½‘ç»œä¼˜åŒ–</strong>: æ— é˜»å¡ç­‰å¾…ï¼Œå¼‚æ­¥æ¶ˆæ¯ä¼ é€’</li>
                    <li><strong>æ•…éšœæ£€æµ‹</strong>: åŒæ—¶å»ºç«‹èŠ‚ç‚¹é—´ç›‘æ§ç½‘ç»œ</li>
                </ul>
                
                <div class="info-box">
                    <p><strong>ğŸ’¡ æ€»ç»“:</strong> è¿™ç§è®¾è®¡ä½“ç°äº†CRAQç³»ç»Ÿä¼˜ç§€çš„åˆ†å¸ƒå¼æ¶æ„æ€æƒ³ â€”â€” å»ä¸­å¿ƒåŒ–è®¡ç®—ã€ç¡®å®šæ€§ç®—æ³•ä¿è¯ä¸€è‡´æ€§ã€é«˜æ€§èƒ½å¹¶è¡Œå¤„ç†ã€‚é€šè¿‡æ¸…æ™°çš„ä»£ç ç»“æ„å’Œé«˜æ•ˆçš„ç®—æ³•ï¼Œå®ç°äº†å¯é çš„é›†ç¾¤æ‹“æ‰‘ç®¡ç†ã€‚</p>
                </div>
            </div>
            
        </div>
    </div>
</body>
</html>