<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRAQå†™å†²çªè§£å†³æœºåˆ¶åˆ†æ - eh_write_conflict_resolver_api</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.8;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 30px;
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            font-weight: 600;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .content {
            padding: 50px;
        }
        
        .section {
            margin-bottom: 60px;
        }
        
        .section-title {
            color: #e74c3c;
            font-size: 1.8em;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #e74c3c;
            display: flex;
            align-items: center;
        }
        
        .section-title .icon {
            margin-right: 15px;
            font-size: 1.1em;
        }
        
        .subsection-title {
            color: #c0392b;
            font-size: 1.4em;
            margin: 35px 0 20px 0;
            padding-left: 15px;
            border-left: 4px solid #c0392b;
        }
        
        /* ä»£ç å—æ ·å¼ */
        .code-container {
            margin: 25px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }
        
        .code-header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: #68d391;
            padding: 15px 25px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            font-weight: 600;
            border-bottom: 3px solid #e74c3c;
            display: flex;
            align-items: center;
        }
        
        .code-header::before {
            content: 'ğŸ“„';
            margin-right: 12px;
            font-size: 1.2em;
        }
        
        .code-body {
            background: #1e1e1e;
            padding: 0;
            overflow-x: auto;
        }
        
        .code-body pre {
            margin: 0;
            padding: 25px 30px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.9;
            color: #d4d4d4;
            white-space: pre;
            overflow-x: auto;
        }
        
        /* è¯­æ³•é«˜äº® */
        .code-body .comment { color: #6a9955; font-style: italic; }
        .code-body .keyword { color: #569cd6; font-weight: bold; }
        .code-body .function { color: #dcdcaa; }
        .code-body .variable { color: #9cdcfe; }
        .code-body .atom { color: #ce9178; }
        .code-body .string { color: #ce9178; }
        .code-body .number { color: #b5cea8; }
        .code-body .operator { color: #d4d4d4; }
        .code-body .macro { color: #4ec9b0; }
        .code-body .type { color: #4ec9b0; }
        
        .code-body .highlight-line {
            background: rgba(231, 76, 60, 0.15);
            display: block;
            margin: 0 -30px;
            padding: 0 30px;
            border-left: 4px solid #e74c3c;
        }
        
        .code-body .step-comment {
            color: #e74c3c;
            font-weight: bold;
        }
        
        /* å…³é”®ç‚¹æç¤ºæ¡† */
        .key-point {
            background: linear-gradient(135deg, #fdeaea 0%, #fadbd8 100%);
            border: 2px solid #e74c3c;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.2);
        }
        
        .key-point .title {
            color: #922b21;
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .key-point .title::before {
            content: 'âš¡';
            margin-right: 10px;
            font-size: 1.3em;
        }
        
        .key-point p {
            color: #641e16;
            line-height: 1.8;
        }
        
        .key-point code {
            background: rgba(0,0,0,0.1);
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
            color: #922b21;
        }
        
        /* è¡¨æ ¼æ ·å¼ */
        .table-container {
            overflow-x: auto;
            margin: 25px 0;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .styled-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 15px;
        }
        
        .styled-table thead tr {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }
        
        .styled-table th {
            padding: 18px 20px;
            text-align: left;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .styled-table td {
            padding: 16px 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .styled-table tbody tr:hover {
            background: #fdeaea;
        }
        
        /* æµç¨‹å›¾ */
        .flow-diagram {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px dashed #e74c3c;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            text-align: center;
        }
        
        .conflict-box {
            display: inline-block;
            padding: 20px 30px;
            margin: 10px;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
        }
        
        .result-box {
            display: inline-block;
            padding: 15px 25px;
            margin: 10px;
            background: linear-gradient(135deg, #27ae60 0%, #1e8449 100%);
            color: white;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.4);
        }
        
        .arrow {
            font-size: 2em;
            color: #e74c3c;
            margin: 0 15px;
            font-weight: bold;
        }
        
        .vs-text {
            font-size: 1.5em;
            color: #e74c3c;
            font-weight: bold;
            margin: 0 20px;
        }
        
        /* å†…è”ä»£ç  */
        code {
            background: #2d3748;
            color: #68d391;
            padding: 4px 10px;
            border-radius: 5px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 0.88em;
        }
        
        /* åˆ—è¡¨ */
        ul {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        ul li {
            padding: 12px 0 12px 35px;
            position: relative;
            line-height: 1.7;
        }
        
        ul li::before {
            content: 'â–¸';
            position: absolute;
            left: 12px;
            color: #e74c3c;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        /* ä¿¡æ¯æ¡† */
        .info-box {
            background: linear-gradient(135deg, #e8f8f5 0%, #d1f2eb 100%);
            border-left: 5px solid #1abc9c;
            border-radius: 8px;
            padding: 20px 25px;
            margin: 25px 0;
        }
        
        .info-box p {
            color: #0e6655;
            margin: 0;
        }
        
        .info-box strong {
            color: #0b5345;
        }
        
        /* æ¶æ„å›¾ */
        .architecture-diagram {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 25px 0;
            border: 1px solid #dee2e6;
        }
        
        .layer {
            background: white;
            border: 2px solid #e74c3c;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }
        
        .layer-title {
            font-weight: bold;
            color: #e74c3c;
            margin-bottom: 10px;
        }
        
        .layer-content {
            font-family: 'SF Mono', monospace;
            font-size: 14px;
            color: #2d3748;
        }
    </style>
</head>
<body>
<!-- CRAQ æ–‡æ¡£å¯¼èˆªæ  -->
<div id="craq-nav" style="
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 35, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: 12px 20px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
">
    <a href="/craq/" style="
        color: #00d4ff;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#7c3aed'" onmouseout="this.style.color='#00d4ff'">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
        è¿”å› CRAQ æ–‡æ¡£é¦–é¡µ
    </a>
    
    <div style="flex: 1;"></div>
    
    <a href="/" style="
        color: #888;
        text-decoration: none;
        font-size: 14px;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#888'">
        åšå®¢é¦–é¡µ
    </a>
</div>

<!-- ä¸ºå¯¼èˆªæ æ·»åŠ é¡¶éƒ¨é—´è· -->
<div style="height: 60px;"></div>

    <div class="container">
        <div class="header">
            <h1>âš¡ CRAQå†™å†²çªè§£å†³æœºåˆ¶åˆ†æ</h1>
            <p>eh_write_conflict_resolver_api æ¨¡å—æ·±åº¦å‰–æ</p>
        </div>
        
        <div class="content">
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬ä¸€éƒ¨åˆ†: æ¶æ„æ¦‚è¿°
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ—ï¸</span>æ¶æ„æ¦‚è¿°</h2>
                
                <div class="key-point">
                    <div class="title">å†™å†²çªè§£å†³å™¨çš„ä½œç”¨</div>
                    <p>åœ¨CRAQåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå½“å¤šä¸ªèŠ‚ç‚¹åŒæ—¶å¯¹åŒä¸€æ•°æ®è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œå¯èƒ½äº§ç”Ÿ<strong>å†™å†²çª</strong>ã€‚<code>eh_write_conflict_resolver_api</code> æ¨¡å—è´Ÿè´£æ ¹æ®æ¶ˆæ¯ç±»å‹å’Œæ—¶é—´æˆ³ï¼Œå†³å®šå“ªä¸ªå†™æ“ä½œåº”è¯¥è·èƒœã€‚</p>
                </div>
                
                <h3 class="subsection-title">æ¨¡å—å±‚æ¬¡ç»“æ„</h3>
                
                <div class="architecture-diagram">
                    <div class="layer">
                        <div class="layer-title">ğŸ“Œ è¡Œä¸ºå®šä¹‰å±‚ (Behaviour)</div>
                        <div class="layer-content">eh_write_conflict_resolver.erl</div>
                    </div>
                    <div style="text-align: center; font-size: 2em; color: #e74c3c;">â†“</div>
                    <div class="layer">
                        <div class="layer-title">ğŸ“Œ APIå®ç°å±‚ (Implementation)</div>
                        <div class="layer-content">eh_write_conflict_resolver_api.erl</div>
                    </div>
                    <div style="text-align: center; font-size: 2em; color: #e74c3c;">â†“</div>
                    <div class="layer">
                        <div class="layer-title">ğŸ“Œ è°ƒç”¨å±‚ (Caller)</div>
                        <div class="layer-content">eh_node_timestamp.erl â†’ resolve_conflict()</div>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬äºŒéƒ¨åˆ†: è¡Œä¸ºå®šä¹‰
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ“‹</span>è¡Œä¸ºå®šä¹‰ (Behaviour)</h2>
                
                <div class="code-container">
                    <div class="code-header">src/eh_write_conflict_resolver.erl - è¡Œä¸ºå®šä¹‰æ¨¡å—</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% å†™å†²çªè§£å†³å™¨è¡Œä¸ºå®šä¹‰</span>
<span class="comment">%% åŠŸèƒ½: å®šä¹‰å†™å†²çªè§£å†³çš„å›è°ƒæ¥å£</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>

<span class="keyword">-module</span>(<span class="atom">eh_write_conflict_resolver</span>).

<span class="comment">%% å®šä¹‰å›è°ƒå‡½æ•°è§„èŒƒ</span>
<span class="comment">%% è¾“å…¥: Value1 - ç¬¬ä¸€ä¸ªå†²çªå€¼ (æ¥è‡ªæ–°æ¶ˆæ¯)</span>
<span class="comment">%%       Value2 - ç¬¬äºŒä¸ªå†²çªå€¼ (æ¥è‡ªå·²å­˜åœ¨æ¶ˆæ¯)</span>
<span class="comment">%% è¾“å‡º: è·èƒœçš„å€¼</span>
<span class="keyword">-callback</span> <span class="function">resolve</span>(
    <span class="variable">Value1</span> :: <span class="type">term</span>(),
    <span class="variable">Value2</span> :: <span class="type">term</span>()
) -> <span class="type">term</span>().
</pre>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬ä¸‰éƒ¨åˆ†: APIå®ç°
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">âš¡</span>APIå®ç° (æ ¸å¿ƒä»£ç )</h2>
                
                <div class="code-container">
                    <div class="code-header">src/eh_write_conflict_resolver_api.erl - å†²çªè§£å†³å®ç°</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% å†™å†²çªè§£å†³å™¨APIå®ç°</span>
<span class="comment">%% åŠŸèƒ½: æ ¹æ®æ¶ˆæ¯ç±»å‹å†³å®šå“ªä¸ªå†™æ“ä½œè·èƒœ</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>

<span class="keyword">-module</span>(<span class="atom">eh_write_conflict_resolver_api</span>).

<span class="keyword">-behavior</span>(<span class="atom">eh_write_conflict_resolver</span>).

<span class="keyword">-export</span>([<span class="function">resolve</span>/<span class="number">2</span>]).

<span class="keyword">-include</span>(<span class="string">"erlang_craq.hrl"</span>).

<span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="step-comment">%% ğŸ”¥ æƒ…å†µ1: ä¸¤ä¸ªéƒ½æ˜¯é¢„æ›´æ–°æ¶ˆæ¯ (pre_update vs pre_update)</span>
<span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="highlight-line"><span class="keyword">resolve</span>(</span>
<span class="highlight-line">    {<span class="macro">?EH_PRED_PRE_UPDATE</span>, <span class="variable">Value1</span>},</span>
<span class="highlight-line">    {<span class="macro">?EH_PRED_PRE_UPDATE</span>, <span class="variable">Value2</span>}</span>
<span class="highlight-line">) -></span>
<span class="highlight-line">    <span class="function">max</span>(<span class="variable">Value1</span>, <span class="variable">Value2</span>);</span>
    <span class="comment">%% ç­–ç•¥: å–è¾ƒå¤§çš„èŠ‚ç‚¹IDè·èƒœ</span>
    <span class="comment">%% åŸå› : ä¿è¯ç¡®å®šæ€§ï¼Œé¿å…æ´»é”</span>

<span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="step-comment">%% ğŸ”¥ æƒ…å†µ2: é¢„æ›´æ–° vs å·²ç¡®è®¤æ›´æ–° (pre_update vs succ_update)</span>
<span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="highlight-line"><span class="keyword">resolve</span>(</span>
<span class="highlight-line">    {<span class="macro">?EH_PRED_PRE_UPDATE</span>, <span class="variable">_Value1</span>},</span>
<span class="highlight-line">    {<span class="macro">?EH_SUCC_UPDATE</span>, <span class="variable">Value2</span>}</span>
<span class="highlight-line">) -></span>
<span class="highlight-line">    <span class="variable">Value2</span>;</span>
    <span class="comment">%% ç­–ç•¥: å·²ç¡®è®¤çš„æ›´æ–°è·èƒœ</span>
    <span class="comment">%% åŸå› : succ_update å·²ç»è¿‡å°¾èŠ‚ç‚¹ç¡®è®¤ï¼Œå…·æœ‰æ›´é«˜ä¼˜å…ˆçº§</span>

<span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="step-comment">%% ğŸ”¥ æƒ…å†µ3: å·²ç¡®è®¤æ›´æ–° vs é¢„æ›´æ–° (succ_update vs pre_update)</span>
<span class="comment">%%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="highlight-line"><span class="keyword">resolve</span>(</span>
<span class="highlight-line">    {<span class="macro">?EH_SUCC_UPDATE</span>, <span class="variable">Value1</span>},</span>
<span class="highlight-line">    {<span class="macro">?EH_PRED_PRE_UPDATE</span>, <span class="variable">_Value2</span>}</span>
<span class="highlight-line">) -></span>
<span class="highlight-line">    <span class="variable">Value1</span>.</span>
    <span class="comment">%% ç­–ç•¥: å·²ç¡®è®¤çš„æ›´æ–°è·èƒœ</span>
    <span class="comment">%% åŸå› : succ_update å·²ç»è¿‡å°¾èŠ‚ç‚¹ç¡®è®¤ï¼Œå…·æœ‰æ›´é«˜ä¼˜å…ˆçº§</span>
</pre>
                    </div>
                </div>

                <h3 class="subsection-title">æ¶ˆæ¯ç±»å‹å®šä¹‰</h3>
                
                <div class="code-container">
                    <div class="code-header">include/erlang_craq.hrl - å®å®šä¹‰</div>
                    <div class="code-body">
<pre>
<span class="comment">%% æ¶ˆæ¯ç±»å‹å®å®šä¹‰</span>
<span class="keyword">-define</span>(<span class="macro">EH_PRED_PRE_UPDATE</span>,    <span class="atom">eh_pred_pre_update</span>).
    <span class="comment">%% é¢„æ›´æ–°æ¶ˆæ¯: ä»å‰é©±èŠ‚ç‚¹ä¼ æ¥ï¼Œå°šæœªç»è¿‡å°¾èŠ‚ç‚¹ç¡®è®¤</span>

<span class="keyword">-define</span>(<span class="macro">EH_SUCC_UPDATE</span>,        <span class="atom">eh_succ_update</span>).
    <span class="comment">%% ç¡®è®¤æ›´æ–°æ¶ˆæ¯: ä»åç»§èŠ‚ç‚¹ä¼ æ¥ï¼Œå·²ç»è¿‡å°¾èŠ‚ç‚¹ç¡®è®¤</span>
</pre>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬å››éƒ¨åˆ†: å†²çªè§£å†³ç­–ç•¥
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ¯</span>å†²çªè§£å†³ç­–ç•¥</h2>
                
                <h3 class="subsection-title">ä¸‰ç§å†²çªåœºæ™¯</h3>
                
                <div class="table-container">
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>åœºæ™¯</th>
                                <th>æ–°æ¶ˆæ¯ç±»å‹</th>
                                <th>å·²å­˜åœ¨æ¶ˆæ¯ç±»å‹</th>
                                <th>è§£å†³ç­–ç•¥</th>
                                <th>è·èƒœè€…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>åœºæ™¯1</strong></td>
                                <td><code>eh_pred_pre_update</code></td>
                                <td><code>eh_pred_pre_update</code></td>
                                <td>æ¯”è¾ƒèŠ‚ç‚¹IDå¤§å°</td>
                                <td>max(Value1, Value2)</td>
                            </tr>
                            <tr>
                                <td><strong>åœºæ™¯2</strong></td>
                                <td><code>eh_pred_pre_update</code></td>
                                <td><code>eh_succ_update</code></td>
                                <td>å·²ç¡®è®¤ä¼˜å…ˆ</td>
                                <td>Value2 (å·²ç¡®è®¤)</td>
                            </tr>
                            <tr>
                                <td><strong>åœºæ™¯3</strong></td>
                                <td><code>eh_succ_update</code></td>
                                <td><code>eh_pred_pre_update</code></td>
                                <td>å·²ç¡®è®¤ä¼˜å…ˆ</td>
                                <td>Value1 (å·²ç¡®è®¤)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="subsection-title">åœºæ™¯1: é¢„æ›´æ–° vs é¢„æ›´æ–°</h3>
                
                <div class="flow-diagram">
                    <div class="conflict-box">
                        eh_pred_pre_update<br>
                        <small>Node1 å‘èµ·çš„å†™æ“ä½œ</small>
                    </div>
                    <span class="vs-text">VS</span>
                    <div class="conflict-box">
                        eh_pred_pre_update<br>
                        <small>Node2 å‘èµ·çš„å†™æ“ä½œ</small>
                    </div>
                    <br><br>
                    <span class="arrow">â†“</span>
                    <br><br>
                    <div class="result-box">
                        è·èƒœè€…: max(Node1, Node2)<br>
                        <small>èŠ‚ç‚¹IDè¾ƒå¤§è€…è·èƒœ</small>
                    </div>
                </div>

                <h3 class="subsection-title">åœºæ™¯2/3: é¢„æ›´æ–° vs å·²ç¡®è®¤æ›´æ–°</h3>
                
                <div class="flow-diagram">
                    <div class="conflict-box">
                        eh_pred_pre_update<br>
                        <small>æœªç¡®è®¤çš„å†™æ“ä½œ</small>
                    </div>
                    <span class="vs-text">VS</span>
                    <div class="result-box">
                        eh_succ_update<br>
                        <small>å·²ç¡®è®¤çš„å†™æ“ä½œ</small>
                    </div>
                    <br><br>
                    <span class="arrow">â†“</span>
                    <br><br>
                    <div class="result-box">
                        è·èƒœè€…: eh_succ_update<br>
                        <small>å·²ç¡®è®¤çš„æ›´æ–°å§‹ç»ˆè·èƒœ</small>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬äº”éƒ¨åˆ†: è°ƒç”¨é“¾åˆ†æ
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ”—</span>è°ƒç”¨é“¾åˆ†æ</h2>
                
                <h3 class="subsection-title">æ ¸å¿ƒè°ƒç”¨å‡½æ•°: resolve_conflict</h3>
                
                <div class="code-container">
                    <div class="code-header">src/eh_node_timestamp.erl:203-230 - å†²çªè§£å†³è°ƒç”¨ç‚¹</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% å†²çªè§£å†³æ ¸å¿ƒå‡½æ•°</span>
<span class="comment">%% åŠŸèƒ½: æ£€æµ‹å¹¶è§£å†³å†™å†²çª</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="keyword">resolve_conflict</span>(
    <span class="variable">MsgListTag</span>,      <span class="comment">%% æ–°æ¶ˆæ¯çš„ç±»å‹æ ‡ç­¾</span>
    <span class="variable">MsgMapTag</span>,       <span class="comment">%% å·²å­˜åœ¨æ¶ˆæ¯çš„ç±»å‹æ ‡ç­¾</span>
    <span class="variable">UMsgList</span>,        <span class="comment">%% æ–°çš„æ›´æ–°æ¶ˆæ¯åˆ—è¡¨</span>
    <span class="variable">MsgMap</span>,          <span class="comment">%% å·²å­˜åœ¨çš„æ¶ˆæ¯æ˜ å°„</span>
    <span class="operator">#</span><span class="atom">eh_system_state</span>{<span class="atom">app_config</span> <span class="operator">=</span> <span class="variable">AppConfig</span>}
) <span class="operator">-></span>

    <span class="comment">%% Step 1: è·å–æ¶ˆæ¯å‚æ•°</span>
    {<span class="variable">MsgTimestamp</span>, <span class="variable">_</span>, <span class="variable">MsgNodeId</span>, <span class="variable">_</span>} <span class="operator">=</span> 
        <span class="function">eh_update_msg:get_msg_param</span>(<span class="variable">UMsgList</span>),

    <span class="comment">%% Step 2: æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†²çªæ¶ˆæ¯</span>
    <span class="operator">#</span><span class="atom">eh_update_msg_data</span>{
        <span class="atom">node_id</span>   <span class="operator">=</span> <span class="variable">EMsgNodeId</span>,
        <span class="atom">client_id</span> <span class="operator">=</span> <span class="variable">EClientId</span>,
        <span class="atom">msg_ref</span>   <span class="operator">=</span> <span class="variable">EMsgRef</span>
    } <span class="operator">=</span> <span class="function">eh_update_msg:exist_msg_list</span>(<span class="variable">UMsgList</span>, <span class="variable">MsgMap</span>),

    <span class="comment">%% Step 3: åˆ¤æ–­å†²çªç±»å‹</span>
    <span class="keyword">case</span> {<span class="variable">EMsgNodeId</span>, <span class="variable">EMsgNodeId</span> <span class="operator">=:=</span> <span class="variable">MsgNodeId</span>} <span class="keyword">of</span>

        {<span class="atom">undefined</span>, <span class="variable">_</span>} <span class="operator">-></span>
            <span class="comment">%% æƒ…å†µA: ä¸å­˜åœ¨å†²çªæ¶ˆæ¯ï¼Œç›´æ¥é€šè¿‡</span>
            {<span class="atom">true</span>, <span class="variable">MsgMap</span>};

        {<span class="variable">_</span>, <span class="atom">true</span>} <span class="operator">-></span>
            <span class="comment">%% æƒ…å†µB: åŒä¸€èŠ‚ç‚¹çš„æ¶ˆæ¯ï¼Œä¸ç®—å†²çª</span>
            {<span class="atom">true</span>, <span class="variable">MsgMap</span>};

        {<span class="variable">_</span>, <span class="variable">_</span>} <span class="operator">-></span>
            <span class="comment">%% æƒ…å†µC: ä¸åŒèŠ‚ç‚¹çš„æ¶ˆæ¯ï¼Œéœ€è¦è§£å†³å†²çª</span>
<span class="highlight-line">            <span class="variable">ConflictResolver</span> <span class="operator">=</span> </span>
<span class="highlight-line">                <span class="function">eh_system_config:get_write_conflict_resolver</span>(<span class="variable">AppConfig</span>),</span>
<span class="highlight-line">            </span>
<span class="highlight-line">            <span class="comment">%% ğŸ”¥ è°ƒç”¨å†²çªè§£å†³å™¨</span></span>
<span class="highlight-line">            <span class="variable">ResolvedNodeId</span> <span class="operator">=</span> <span class="variable">ConflictResolver</span>:<span class="function">resolve</span>(</span>
<span class="highlight-line">                {<span class="variable">MsgListTag</span>, <span class="variable">MsgNodeId</span>},    <span class="comment">%% æ–°æ¶ˆæ¯: {ç±»å‹, èŠ‚ç‚¹ID}</span></span>
<span class="highlight-line">                {<span class="variable">MsgMapTag</span>, <span class="variable">EMsgNodeId</span>}     <span class="comment">%% æ—§æ¶ˆæ¯: {ç±»å‹, èŠ‚ç‚¹ID}</span></span>
<span class="highlight-line">            ),</span>

            <span class="comment">%% Step 4: æ ¹æ®è§£å†³ç»“æœå¤„ç†</span>
            <span class="keyword">case</span> <span class="variable">ResolvedNodeId</span> <span class="operator">=:=</span> <span class="variable">MsgNodeId</span> <span class="keyword">of</span>
                <span class="atom">true</span> <span class="operator">-></span>
                    <span class="comment">%% æ–°æ¶ˆæ¯è·èƒœï¼Œç§»é™¤æ—§æ¶ˆæ¯</span>
                    {<span class="variable">TMsgMap</span>, <span class="variable">FMsgMap</span>} <span class="operator">=</span> 
                        <span class="function">eh_update_msg:partition_on_timestamp_node_id</span>(
                            <span class="variable">MsgTimestamp</span>, 
                            <span class="variable">EMsgNodeId</span>, 
                            <span class="variable">MsgMap</span>
                        ),
                    <span class="comment">%% é€šçŸ¥å¤±è´¥çš„å®¢æˆ·ç«¯</span>
                    ...
                    {<span class="atom">true</span>, <span class="variable">FMsgMap</span>};

                <span class="atom">false</span> <span class="operator">-></span>
                    <span class="comment">%% æ—§æ¶ˆæ¯è·èƒœï¼Œæ‹’ç»æ–°æ¶ˆæ¯</span>
                    {<span class="atom">false</span>, <span class="variable">MsgMap</span>}
            <span class="keyword">end</span>
    <span class="keyword">end</span>.
</pre>
                    </div>
                </div>

                <h3 class="subsection-title">ä¸¤ä¸ªå†²çªè§£å†³å…¥å£å‡½æ•°</h3>
                
                <div class="code-container">
                    <div class="code-header">src/eh_node_timestamp.erl:232-245 - é¢„æ›´æ–°å’Œæ›´æ–°å†²çªè§£å†³å™¨</div>
                    <div class="code-body">
<pre>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% é¢„æ›´æ–°æ¶ˆæ¯çš„å†²çªè§£å†³</span>
<span class="comment">%% åœºæ™¯: æ”¶åˆ°æ¥è‡ªå‰é©±èŠ‚ç‚¹çš„é¢„æ›´æ–°æ¶ˆæ¯</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="keyword">pre_update_conflict_resolver</span>(
    <span class="variable">UMsgList</span>,
    <span class="operator">#</span><span class="atom">eh_system_state</span>{
        <span class="atom">pre_msg_data</span> <span class="operator">=</span> <span class="variable">PreMsgData</span>,
        <span class="atom">msg_data</span>     <span class="operator">=</span> <span class="variable">MsgData</span>
    } <span class="operator">=</span> <span class="variable">State</span>
) <span class="operator">-></span>

    <span class="comment">%% Step 1: ä¸å…¶ä»–é¢„æ›´æ–°æ¶ˆæ¯æ£€æŸ¥å†²çª</span>
<span class="highlight-line">    {<span class="variable">Flag1</span>, <span class="variable">PreMsgData1</span>} <span class="operator">=</span> <span class="function">resolve_conflict</span>(</span>
<span class="highlight-line">        <span class="macro">?EH_PRED_PRE_UPDATE</span>,    <span class="comment">%% æ–°æ¶ˆæ¯ç±»å‹</span></span>
<span class="highlight-line">        <span class="macro">?EH_PRED_PRE_UPDATE</span>,    <span class="comment">%% å¯¹æ¯”æ¶ˆæ¯ç±»å‹</span></span>
<span class="highlight-line">        <span class="variable">UMsgList</span>,</span>
<span class="highlight-line">        <span class="variable">PreMsgData</span>,</span>
<span class="highlight-line">        <span class="variable">State</span></span>
<span class="highlight-line">    ),</span>

    <span class="comment">%% Step 2: å¦‚æœé€šè¿‡ï¼Œå†ä¸å·²ç¡®è®¤æ¶ˆæ¯æ£€æŸ¥å†²çª</span>
    <span class="variable">Flag3</span> <span class="operator">=</span> <span class="keyword">case</span> <span class="variable">Flag1</span> <span class="keyword">of</span>
        <span class="atom">true</span> <span class="operator">-></span>
<span class="highlight-line">            {<span class="variable">Flag2</span>, <span class="variable">_</span>} <span class="operator">=</span> <span class="function">resolve_conflict</span>(</span>
<span class="highlight-line">                <span class="macro">?EH_PRED_PRE_UPDATE</span>,    <span class="comment">%% æ–°æ¶ˆæ¯ç±»å‹</span></span>
<span class="highlight-line">                <span class="macro">?EH_SUCC_UPDATE</span>,        <span class="comment">%% å¯¹æ¯”æ¶ˆæ¯ç±»å‹</span></span>
<span class="highlight-line">                <span class="variable">UMsgList</span>,</span>
<span class="highlight-line">                <span class="variable">MsgData</span>,</span>
<span class="highlight-line">                <span class="variable">State</span></span>
<span class="highlight-line">            ),</span>
            <span class="variable">Flag2</span>;
        <span class="atom">false</span> <span class="operator">-></span>
            <span class="atom">false</span>
    <span class="keyword">end</span>,

    {<span class="variable">Flag3</span>, <span class="variable">State</span><span class="operator">#</span><span class="atom">eh_system_state</span>{<span class="atom">pre_msg_data</span> <span class="operator">=</span> <span class="variable">PreMsgData1</span>}}.


<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="comment">%% ç¡®è®¤æ›´æ–°æ¶ˆæ¯çš„å†²çªè§£å†³</span>
<span class="comment">%% åœºæ™¯: æ”¶åˆ°æ¥è‡ªåç»§èŠ‚ç‚¹çš„ç¡®è®¤æ›´æ–°æ¶ˆæ¯</span>
<span class="comment">%%â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="keyword">update_conflict_resolver</span>(
    <span class="variable">UMsgList</span>,
    <span class="operator">#</span><span class="atom">eh_system_state</span>{<span class="atom">pre_msg_data</span> <span class="operator">=</span> <span class="variable">PreMsgData</span>} <span class="operator">=</span> <span class="variable">State</span>
) <span class="operator">-></span>

    <span class="comment">%% ä¸é¢„æ›´æ–°æ¶ˆæ¯æ£€æŸ¥å†²çª (ç¡®è®¤æ›´æ–°å§‹ç»ˆè·èƒœ)</span>
<span class="highlight-line">    {<span class="variable">Flag1</span>, <span class="variable">PreMsgData1</span>} <span class="operator">=</span> <span class="function">resolve_conflict</span>(</span>
<span class="highlight-line">        <span class="macro">?EH_SUCC_UPDATE</span>,        <span class="comment">%% æ–°æ¶ˆæ¯ç±»å‹ (å·²ç¡®è®¤)</span></span>
<span class="highlight-line">        <span class="macro">?EH_PRED_PRE_UPDATE</span>,    <span class="comment">%% å¯¹æ¯”æ¶ˆæ¯ç±»å‹ (æœªç¡®è®¤)</span></span>
<span class="highlight-line">        <span class="variable">UMsgList</span>,</span>
<span class="highlight-line">        <span class="variable">PreMsgData</span>,</span>
<span class="highlight-line">        <span class="variable">State</span></span>
<span class="highlight-line">    ),</span>

    {<span class="variable">Flag1</span>, <span class="variable">State</span><span class="operator">#</span><span class="atom">eh_system_state</span>{<span class="atom">pre_msg_data</span> <span class="operator">=</span> <span class="variable">PreMsgData1</span>}}.
</pre>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬å…­éƒ¨åˆ†: å®Œæ•´è°ƒç”¨é“¾
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ”„</span>å®Œæ•´è°ƒç”¨é“¾</h2>
                
                <div class="flow-diagram">
                    <div style="text-align: left; font-family: 'SF Mono', monospace; line-height: 2.2; font-size: 14px;">
                        <strong>æ”¶åˆ°æ›´æ–°æ¶ˆæ¯</strong><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†“<br>
                        <code>valid_pre_update_msg</code> æˆ– <code>valid_update_msg</code><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†“<br>
                        <code>valid_msg</code> (é€šç”¨éªŒè¯å‡½æ•°)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†“<br>
                        <span style="background: #fdeaea; padding: 5px 10px; border-radius: 5px;">
                            <code>pre_update_conflict_resolver</code> æˆ– <code>update_conflict_resolver</code>
                        </span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†“<br>
                        <span style="background: #fdeaea; padding: 5px 10px; border-radius: 5px;">
                            <code>resolve_conflict</code> (æ ¸å¿ƒå†²çªæ£€æµ‹)
                        </span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†“<br>
                        <code>eh_system_config:get_write_conflict_resolver</code><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†“<br>
                        <span style="background: #e74c3c; color: white; padding: 5px 15px; border-radius: 5px; font-weight: bold;">
                            ğŸ”¥ ConflictResolver:resolve({Tag1, NodeId1}, {Tag2, NodeId2})
                        </span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†“<br>
                        <span style="background: #27ae60; color: white; padding: 5px 10px; border-radius: 5px;">
                            è¿”å›è·èƒœçš„ NodeId
                        </span>
                    </div>
                </div>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ç¬¬ä¸ƒéƒ¨åˆ†: è®¾è®¡åŸç†
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="section">
                <h2 class="section-title"><span class="icon">ğŸ’¡</span>è®¾è®¡åŸç†</h2>
                
                <ul>
                    <li><strong>å·²ç¡®è®¤ä¼˜å…ˆåŸåˆ™</strong>: <code>eh_succ_update</code> æ¶ˆæ¯å·²ç»è¿‡å°¾èŠ‚ç‚¹ç¡®è®¤ï¼Œä»£è¡¨å·²æäº¤çš„äº‹åŠ¡ï¼Œå› æ­¤å§‹ç»ˆä¼˜å…ˆäºæœªç¡®è®¤çš„ <code>eh_pred_pre_update</code></li>
                    <li><strong>ç¡®å®šæ€§è§£å†³</strong>: å½“ä¸¤ä¸ªé¢„æ›´æ–°æ¶ˆæ¯å†²çªæ—¶ï¼Œä½¿ç”¨ <code>max()</code> å‡½æ•°æ¯”è¾ƒèŠ‚ç‚¹IDï¼Œä¿è¯æ‰€æœ‰èŠ‚ç‚¹å¾—å‡ºç›¸åŒç»“è®º</li>
                    <li><strong>å¯æ’æ‹”è®¾è®¡</strong>: é€šè¿‡ <code>-behavior(eh_write_conflict_resolver)</code> å®šä¹‰æ¥å£ï¼Œå…è®¸è‡ªå®šä¹‰å†²çªè§£å†³ç­–ç•¥</li>
                    <li><strong>é…ç½®é©±åŠ¨</strong>: å†²çªè§£å†³å™¨é€šè¿‡ <code>eh_system_config</code> é…ç½®ï¼Œæ”¯æŒè¿è¡Œæ—¶æ›¿æ¢</li>
                </ul>
                
                <div class="info-box">
                    <p><strong>ğŸ’¡ æ ¸å¿ƒæ€æƒ³:</strong> CRAQçš„å†™å†²çªè§£å†³æœºåˆ¶éµå¾ª"<strong>å·²ç¡®è®¤ä¼˜å…ˆï¼Œç¡®å®šæ€§ä»²è£</strong>"åŸåˆ™ã€‚å·²ç»è¿‡å°¾èŠ‚ç‚¹ç¡®è®¤çš„æ›´æ–°å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼›å¯¹äºæœªç¡®è®¤çš„å¹¶å‘å†™æ“ä½œï¼Œä½¿ç”¨èŠ‚ç‚¹IDçš„å­—å…¸åºè¿›è¡Œç¡®å®šæ€§ä»²è£ï¼Œç¡®ä¿åˆ†å¸ƒå¼ç¯å¢ƒä¸‹æ‰€æœ‰èŠ‚ç‚¹å¯¹å†²çªè§£å†³ç»“æœè¾¾æˆä¸€è‡´ã€‚</p>
                </div>
            </div>
            
        </div>
    </div>

<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="back-to-top" style="
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #00d4ff, #7c3aed);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
    transition: all 0.3s ease;
    z-index: 999;
    opacity: 0;
    transform: translateY(20px);
" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
   onmouseover="this.style.transform='translateY(-5px) scale(1.1)'" 
   onmouseout="this.style.transform='translateY(0) scale(1)'">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
    </svg>
</div>

<script>
// å›åˆ°é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º/éšè—é€»è¾‘
window.addEventListener('scroll', function() {
    const backToTop = document.getElementById('back-to-top');
    if (window.scrollY > 300) {
        backToTop.style.opacity = '1';
        backToTop.style.transform = 'translateY(0)';
    } else {
        backToTop.style.opacity = '0';
        backToTop.style.transform = 'translateY(20px)';
    }
});
</script>

</body>
</html>