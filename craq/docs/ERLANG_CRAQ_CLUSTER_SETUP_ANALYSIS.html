<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Erlang CRAQ é›†ç¾¤å»ºç«‹è¯¦ç»†åˆ†æ</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .content {
            padding: 30px;
        }
        
        .cluster-overview {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .cluster-overview h3 {
            margin-top: 0;
        }
        
        .node-section {
            margin: 30px 0;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .node-header {
            padding: 15px 25px;
            font-weight: bold;
            font-size: 1.3em;
            color: white;
        }
        
        .node1 { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .node2 { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .node3 { background: linear-gradient(135deg, #f39c12, #e67e22); }
        
        .trace-content {
            padding: 25px;
            background: #f8f9fa;
        }
        
        .call-sequence {
            font-family: 'Courier New', monospace;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.6;
        }
        
        .process-id {
            color: #f39c12;
            font-weight: bold;
        }
        
        .function-name {
            color: #3498db;
            font-weight: bold;
        }
        
        .return-value {
            color: #2ecc71;
        }
        
        .timestamp {
            color: #95a5a6;
        }
        
        .ring-topology {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .ring-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
        }
        
        .ring-node {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin: 0 20px;
            position: relative;
        }
        
        .ring-node.head { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .ring-node.middle { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .ring-node.tail { background: linear-gradient(135deg, #f39c12, #e67e22); }
        
        .ring-arrow {
            font-size: 2em;
            color: #3498db;
            margin: 0 10px;
        }
        
        .function-flow {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
        }
        
        .flow-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .key-functions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .function-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }
        
        .function-card h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .function-details {
            font-size: 0.9em;
            color: #7f8c8d;
            margin: 10px 0;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .analysis-section {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .code-highlight {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }
        
        .state-transition {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .state-box {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            margin: 5px;
            font-weight: bold;
        }
        
        .state-arrow {
            font-size: 1.5em;
            color: #3498db;
            margin: 0 10px;
        }
    </style>
</head>
<body>
<!-- CRAQ æ–‡æ¡£å¯¼èˆªæ  -->
<div id="craq-nav" style="
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 35, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: 12px 20px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
">
    <a href="/craq/" style="
        color: #00d4ff;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#7c3aed'" onmouseout="this.style.color='#00d4ff'">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
        è¿”å› CRAQ æ–‡æ¡£é¦–é¡µ
    </a>
    
    <div style="flex: 1;"></div>
    
    <a href="/" style="
        color: #888;
        text-decoration: none;
        font-size: 14px;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#888'">
        åšå®¢é¦–é¡µ
    </a>
</div>

<!-- ä¸ºå¯¼èˆªæ æ·»åŠ é¡¶éƒ¨é—´è· -->
<div style="height: 60px;"></div>

    <div class="container">
        <div class="header">
            <h1>ğŸ”— Erlang CRAQ é›†ç¾¤å»ºç«‹è¯¦ç»†åˆ†æ</h1>
            <p>æ·±åº¦è§£æä¸‰èŠ‚ç‚¹CRAQé›†ç¾¤çš„å»ºç«‹è¿‡ç¨‹ã€ç¯å½¢æ‹“æ‰‘æ„å»ºå’Œæ•…éšœæ£€æµ‹æœºåˆ¶</p>
        </div>
        
        <div class="content">
            <!-- é›†ç¾¤æ¦‚è§ˆ -->
            <div class="cluster-overview">
                <h3>ğŸŒ CRAQé›†ç¾¤æ‹“æ‰‘æ¦‚è§ˆ</h3>
                <div class="ring-topology">
                    <h4>Chain Replicationç¯å½¢æ‹“æ‰‘</h4>
                    <div class="ring-diagram">
                        <div class="ring-node head">
                            <div>
                                <div>Node 1</div>
                                <div style="font-size: 0.8em;">HEAD</div>
                                <div style="font-size: 0.7em;">ec_n1@rabbitmq4-1</div>
                            </div>
                        </div>
                        <div class="ring-arrow">â†’</div>
                        <div class="ring-node middle">
                            <div>
                                <div>Node 2</div>
                                <div style="font-size: 0.8em;">MIDDLE</div>
                                <div style="font-size: 0.7em;">ec_n2@rabbitmq4-2</div>
                            </div>
                        </div>
                        <div class="ring-arrow">â†’</div>
                        <div class="ring-node tail">
                            <div>
                                <div>Node 3</div>
                                <div style="font-size: 0.8em;">TAIL</div>
                                <div style="font-size: 0.7em;">ec_n3@rabbitmq4-3</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="code-highlight" style="background: #ecf0f1; color: #2c3e50;">
<strong>é›†ç¾¤å»ºç«‹å‘½ä»¤:</strong>
NodeList = ['ec_n1@rabbitmq4-1', 'ec_n2@rabbitmq4-2', 'ec_n3@rabbitmq4-3']
erlang_craq:setup_repl(NodeList)

<strong>ç¯å½¢æ‹“æ‰‘ç»“æ„:</strong>
â€¢ Node 1 (HEAD): predecessor=ec_n3, successor=ec_n2
â€¢ Node 2 (MIDDLE): predecessor=ec_n1, successor=ec_n3  
â€¢ Node 3 (TAIL): predecessor=ec_n2, successor=ec_n1
                    </div>
                </div>
            </div>

            <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
            <div class="summary-stats">
                <div class="stat-item">
                    <div class="stat-number">3</div>
                    <div class="stat-label">é›†ç¾¤èŠ‚ç‚¹</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">6</div>
                    <div class="stat-label">æ ¸å¿ƒé˜¶æ®µ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">~100ms</div>
                    <div class="stat-label">å»ºç«‹æ—¶é—´</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">23</div>
                    <div class="stat-label">è·Ÿè¸ªæ¨¡å—</div>
                </div>
            </div>

            <!-- é›†ç¾¤å»ºç«‹æµç¨‹ -->
            <div class="analysis-section">
                <h3>ğŸš€ é›†ç¾¤å»ºç«‹æ ¸å¿ƒæµç¨‹</h3>
                
                <div class="state-transition">
                    <h4>çŠ¶æ€è½¬æ¢åºåˆ—</h4>
                    <div style="text-align: center;">
                        <span class="state-box">eh_not_ready</span>
                        <span class="state-arrow">â†’</span>
                        <span class="state-box">setup_repl</span>
                        <span class="state-arrow">â†’</span>
                        <span class="state-box">failure_detector</span>
                        <span class="state-arrow">â†’</span>
                        <span class="state-box">ring_topology</span>
                        <span class="state-arrow">â†’</span>
                        <span class="state-box">eh_ready</span>
                    </div>
                </div>
                
                <div class="code-highlight">
<strong>å…³é”®æ—¶é—´åºåˆ—:</strong>
Node 3: 3:48:12.689301 (æœ€æ—©å¼€å§‹)
Node 2: 3:48:12.739684 (å»¶è¿Ÿ 50ms)
Node 1: 3:48:12.772661 (å»¶è¿Ÿ 83ms)

<strong>å®Œæˆæ—¶é—´:</strong>
Node 3: 3:48:12.703237 (æ€»è®¡ 14ms)
Node 2: 3:48:12.751235 (æ€»è®¡ 12ms)  
Node 1: 3:48:12.781956 (æ€»è®¡ 9ms)
                </div>
            </div>

            <!-- Node 1 è¯¦ç»†åˆ†æ -->
            <div class="node-section">
                <div class="node-header node1">
                    ğŸ“ Node 1 (ec_n1@rabbitmq4-1) - HEADèŠ‚ç‚¹å»ºç«‹è¿‡ç¨‹
                </div>
                <div class="trace-content">
                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ1: æ¥æ”¶é›†ç¾¤å»ºç«‹è¯·æ±‚</div>
                        <div class="call-sequence">
<span class="timestamp">3:48:12.772661</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_system_server:handle_cast</span>
    ({eh_setup_repl, ['ec_n1@rabbitmq4-1','ec_n2@rabbitmq4-2','ec_n3@rabbitmq4-3']}, 
     {eh_system_state, eh_not_ready, ...})

<strong>å…³é”®ä¿¡æ¯:</strong>
â€¢ åˆå§‹çŠ¶æ€: eh_not_ready
â€¢ é›†ç¾¤èŠ‚ç‚¹åˆ—è¡¨: [ec_n1, ec_n2, ec_n3]
â€¢ æ’åºæ¨¡å¼: sorted
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ2: æ•…éšœæ£€æµ‹å™¨è®¾ç½®</div>
                        <div class="call-sequence">
<span class="timestamp">3:48:12.773632</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_failure_detector_api:set</span>
    ('ec_n1@rabbitmq4-1', ['ec_n1@rabbitmq4-1','ec_n2@rabbitmq4-2','ec_n3@rabbitmq4-3'])

<span class="timestamp">3:48:12.773836</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_failure_detector_api:'-set/2-fun-0-'</span>('ec_n2@rabbitmq4-2')
<span class="timestamp">3:48:12.774228</span> <span class="return-value">â†’ #Ref&lt;0.468240768.1636040705.10527&gt;</span>

<span class="timestamp">3:48:12.774381</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_failure_detector_api:'-set/2-fun-0-'</span>('ec_n3@rabbitmq4-3')
<span class="timestamp">3:48:12.774738</span> <span class="return-value">â†’ #Ref&lt;0.468240768.1636040705.10528&gt;</span>

<strong>ä½œç”¨:</strong> ä¸ºæ¯ä¸ªè¿œç¨‹èŠ‚ç‚¹å»ºç«‹ç›‘æ§å¼•ç”¨ï¼Œå®ç°åˆ†å¸ƒå¼æ•…éšœæ£€æµ‹
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ3: æ—¶é—´æˆ³åŒæ­¥</div>
                        <div class="call-sequence">
<span class="timestamp">3:48:12.775446</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_repl_data_manager_api:timestamp</span>()

<span class="timestamp">3:48:12.775670</span> <span class="process-id">&lt;0.907.0&gt;</span> <span class="function-name">eh_data_server:handle_call</span>(eh_timestamp, ...)
<span class="timestamp">3:48:12.776092</span> <span class="return-value">â†’ {reply, {0,[]}, ...}</span>

<span class="timestamp">3:48:12.776493</span> <span class="return-value">â†’ {0,[]}</span>

<strong>ä½œç”¨:</strong> è·å–å½“å‰èŠ‚ç‚¹çš„é€»è¾‘æ—¶é—´æˆ³ï¼Œç”¨äºCRAQåè®®çš„ä¸€è‡´æ€§ä¿è¯
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ4: ç¯å½¢æ‹“æ‰‘è®¡ç®—</div>
                        <div class="call-sequence">
<strong>é€šè¿‡eh_repl_ringæ¨¡å—è®¡ç®—èŠ‚ç‚¹åœ¨ç¯ä¸­çš„ä½ç½®:</strong>

â€¢ æ’åºåçš„èŠ‚ç‚¹åˆ—è¡¨: ['ec_n1@rabbitmq4-1', 'ec_n2@rabbitmq4-2', 'ec_n3@rabbitmq4-3']
â€¢ å½“å‰èŠ‚ç‚¹: 'ec_n1@rabbitmq4-1' (HEADèŠ‚ç‚¹)
â€¢ predecessor: 'ec_n3@rabbitmq4-3' (å‰é©±èŠ‚ç‚¹)
â€¢ successor: 'ec_n2@rabbitmq4-2' (åç»§èŠ‚ç‚¹)

<strong>æœ€ç»ˆçŠ¶æ€:</strong>
repl_ring: ['ec_n1@rabbitmq4-1','ec_n2@rabbitmq4-2','ec_n3@rabbitmq4-3']
repl_ring_order: ['ec_n1@rabbitmq4-1','ec_n2@rabbitmq4-2','ec_n3@rabbitmq4-3']
predecessor: 'ec_n3@rabbitmq4-3'
successor: 'ec_n2@rabbitmq4-2'
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ5: çŠ¶æ€è½¬æ¢</div>
                        <div class="call-sequence">
<span class="timestamp">3:48:12.776617</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_node_state:update_state_ready</span>(...)

<span class="timestamp">3:48:12.777005</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_node_state:update_state</span>(eh_ready, ...)
<span class="timestamp">3:48:12.777439</span> <span class="return-value">â†’ {eh_system_state, eh_ready, ...}</span>

<strong>çŠ¶æ€å˜åŒ–:</strong> eh_not_ready â†’ eh_ready
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ6: äº‹ä»¶é€šçŸ¥</div>
                        <div class="call-sequence">
<span class="timestamp">3:48:12.778739</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_system_server:event_state</span>("setup_repl.99", ...)

<span class="timestamp">3:48:12.779344</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_event:state</span>(eh_system_server, "setup_repl.99", ...)

<span class="timestamp">3:48:12.780174</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_event:event_notify</span>(state, ...)

<span class="timestamp">3:48:12.781141</span> <span class="process-id">&lt;0.908.0&gt;</span> <span class="function-name">eh_node_state:display_state</span>(...)
<span class="timestamp">3:48:12.781141</span> <span class="return-value">â†’ "ready"</span>

<strong>ä½œç”¨:</strong> é€šçŸ¥ç³»ç»Ÿé›†ç¾¤å»ºç«‹å®Œæˆï¼ŒèŠ‚ç‚¹çŠ¶æ€å˜ä¸ºready
                        </div>
                    </div>
                </div>
            </div>

            <!-- Node 2 åˆ†æ -->
            <div class="node-section">
                <div class="node-header node2">
                    ğŸ“ Node 2 (ec_n2@rabbitmq4-2) - MIDDLEèŠ‚ç‚¹å»ºç«‹è¿‡ç¨‹
                </div>
                <div class="trace-content">
                    <div class="function-flow">
                        <div class="flow-title">âš¡ ä¸­é—´èŠ‚ç‚¹ç‰¹å¾</div>
                        <div class="call-sequence">
<strong>æ—¶é—´åºåˆ—:</strong>
3:48:12.739684 - æ¥æ”¶setup_replè¯·æ±‚
3:48:12.740996 - æ•…éšœæ£€æµ‹å™¨è®¾ç½®
3:48:12.743825 - æ—¶é—´æˆ³åŒæ­¥
3:48:12.746598 - çŠ¶æ€è½¬æ¢ä¸ºready
3:48:12.748835 - äº‹ä»¶é€šçŸ¥

<strong>ç¯å½¢ä½ç½®:</strong>
â€¢ predecessor: 'ec_n1@rabbitmq4-1' (HEADèŠ‚ç‚¹)
â€¢ successor: 'ec_n3@rabbitmq4-3' (TAILèŠ‚ç‚¹)
â€¢ è§’è‰²: ä¸­é—´èŠ‚ç‚¹ï¼Œè´Ÿè´£è½¬å‘æ›´æ–°è¯·æ±‚

<strong>æ€§èƒ½ç‰¹å¾:</strong>
â€¢ æ€»è€—æ—¶: ~12ms
â€¢ æ•…éšœæ£€æµ‹å™¨å¼•ç”¨: 2ä¸ª (ç›‘æ§ec_n1å’Œec_n3)
                        </div>
                    </div>
                </div>
            </div>

            <!-- Node 3 åˆ†æ -->
            <div class="node-section">
                <div class="node-header node3">
                    ğŸ“ Node 3 (ec_n3@rabbitmq4-3) - TAILèŠ‚ç‚¹å»ºç«‹è¿‡ç¨‹
                </div>
                <div class="trace-content">
                    <div class="function-flow">
                        <div class="flow-title">ğŸš„ å°¾èŠ‚ç‚¹ç‰¹å¾</div>
                        <div class="call-sequence">
<strong>æ—¶é—´åºåˆ—:</strong>
3:48:12.689301 - æ¥æ”¶setup_replè¯·æ±‚ (æœ€æ—©)
3:48:12.692040 - æ•…éšœæ£€æµ‹å™¨è®¾ç½®
3:48:12.697285 - æ—¶é—´æˆ³åŒæ­¥
3:48:12.698934 - çŠ¶æ€è½¬æ¢ä¸ºready
3:48:12.700423 - äº‹ä»¶é€šçŸ¥

<strong>ç¯å½¢ä½ç½®:</strong>
â€¢ predecessor: 'ec_n2@rabbitmq4-2' (MIDDLEèŠ‚ç‚¹)
â€¢ successor: 'ec_n1@rabbitmq4-1' (HEADèŠ‚ç‚¹)
â€¢ è§’è‰²: å°¾èŠ‚ç‚¹ï¼Œè´Ÿè´£ç¡®è®¤æ›´æ–°å®Œæˆ

<strong>æ€§èƒ½ç‰¹å¾:</strong>
â€¢ æ€»è€—æ—¶: ~14ms
â€¢ æœ€æ—©å¼€å§‹é›†ç¾¤å»ºç«‹è¿‡ç¨‹
â€¢ æ•…éšœæ£€æµ‹å™¨å¼•ç”¨: 2ä¸ª (ç›‘æ§ec_n1å’Œec_n2)
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…³é”®å‡½æ•°åˆ†æ -->
            <div class="analysis-section">
                <h3>ğŸ”¬ å…³é”®å‡½æ•°æ·±åº¦åˆ†æ</h3>
                
                <div class="key-functions">
                    <div class="function-card">
                        <h4>eh_system_server:handle_cast/2</h4>
                        <div class="function-details">
                            <strong>ä½œç”¨:</strong> å¤„ç†é›†ç¾¤å»ºç«‹è¯·æ±‚<br>
                            <strong>è¾“å…¥:</strong> {eh_setup_repl, NodeList}<br>
                            <strong>æµç¨‹:</strong>
                            <ul>
                                <li>è®¾ç½®æ•…éšœæ£€æµ‹å™¨</li>
                                <li>è·å–æ—¶é—´æˆ³</li>
                                <li>è®¡ç®—ç¯å½¢æ‹“æ‰‘</li>
                                <li>æ›´æ–°èŠ‚ç‚¹çŠ¶æ€</li>
                                <li>å‘é€äº‹ä»¶é€šçŸ¥</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_failure_detector_api:set/2</h4>
                        <div class="function-details">
                            <strong>ä½œç”¨:</strong> å»ºç«‹åˆ†å¸ƒå¼æ•…éšœæ£€æµ‹<br>
                            <strong>æœºåˆ¶:</strong> ä¸ºæ¯ä¸ªè¿œç¨‹èŠ‚ç‚¹åˆ›å»ºç›‘æ§å¼•ç”¨<br>
                            <strong>è¿”å›:</strong> ç›‘æ§å¼•ç”¨ #Ref<...><br>
                            <strong>ç‰¹ç‚¹:</strong> ä½¿ç”¨Erlangçš„monitoræœºåˆ¶å®ç°èŠ‚ç‚¹æ•…éšœæ£€æµ‹
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_repl_ringæ¨¡å—</h4>
                        <div class="function-details">
                            <strong>æ ¸å¿ƒå‡½æ•°:</strong>
                            <ul>
                                <li><code>get_ordered_list_pred_succ/4</code> - è®¡ç®—å‰é©±åç»§</li>
                                <li><code>predecessor/4</code> - è·å–å‰é©±èŠ‚ç‚¹</li>
                                <li><code>successor/4</code> - è·å–åç»§èŠ‚ç‚¹</li>
                            </ul>
                            <strong>ç®—æ³•:</strong> åŸºäºæ’åºåˆ—è¡¨çš„ç¯å½¢æ‹“æ‰‘è®¡ç®—
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_node_state:update_state_ready/1</h4>
                        <div class="function-details">
                            <strong>ä½œç”¨:</strong> çŠ¶æ€è½¬æ¢ç®¡ç†<br>
                            <strong>è½¬æ¢:</strong> eh_not_ready â†’ eh_ready<br>
                            <strong>å½±å“:</strong> èŠ‚ç‚¹å¼€å§‹æ¥å—CRAQåè®®è¯·æ±‚<br>
                            <strong>åŒæ­¥:</strong> ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹çŠ¶æ€ä¸€è‡´
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_event:event_notify/3</h4>
                        <div class="function-details">
                            <strong>ä½œç”¨:</strong> ç³»ç»Ÿäº‹ä»¶é€šçŸ¥<br>
                            <strong>äº‹ä»¶:</strong> "setup_repl.99"<br>
                            <strong>ç”¨é€”:</strong> æ—¥å¿—è®°å½•ã€ç›‘æ§ã€è°ƒè¯•<br>
                            <strong>æœºåˆ¶:</strong> åŸºäºgen_eventçš„äº‹ä»¶åˆ†å‘
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_repl_data_manager_api:timestamp/0</h4>
                        <div class="function-details">
                            <strong>ä½œç”¨:</strong> é€»è¾‘æ—¶é’ŸåŒæ­¥<br>
                            <strong>è¿”å›:</strong> {Timestamp, DataIndex}<br>
                            <strong>ç”¨é€”:</strong> CRAQåè®®çš„ä¸€è‡´æ€§ä¿è¯<br>
                            <strong>åˆå§‹å€¼:</strong> {0, []} (ç©ºçš„åˆå§‹çŠ¶æ€)
                        </div>
                    </div>
                </div>
            </div>

            <!-- å‡½æ•°è°ƒç”¨å›¾ -->
            <div class="analysis-section">
                <h3>ğŸ“Š å®Œæ•´å‡½æ•°è°ƒç”¨å›¾</h3>
                
                <div class="code-highlight">
<strong>é›†ç¾¤å»ºç«‹å‡½æ•°è°ƒç”¨å›¾:</strong>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    erlang_craq:setup_repl/1                     â”‚
â”‚                  (å¤–éƒ¨è°ƒç”¨ï¼Œå¯åŠ¨é›†ç¾¤å»ºç«‹)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ å¹¿æ’­åˆ°æ‰€æœ‰èŠ‚ç‚¹
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              eh_system_server:handle_cast/2                     â”‚
â”‚                ({eh_setup_repl, NodeList}, State)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ¥æ”¶é›†ç¾¤å»ºç«‹è¯·æ±‚                                             â”‚
â”‚ 2. éªŒè¯èŠ‚ç‚¹åˆ—è¡¨                                                 â”‚
â”‚ 3. åˆå§‹åŒ–é›†ç¾¤å»ºç«‹æµç¨‹                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            eh_failure_detector_api:set/2                       â”‚
â”‚              (NodeId, NodeList)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ä¸ºæ¯ä¸ªè¿œç¨‹èŠ‚ç‚¹å»ºç«‹ç›‘æ§                                        â”‚
â”‚ â€¢ è°ƒç”¨ '-set/2-fun-0-'/1 ä¸ºæ¯ä¸ªèŠ‚ç‚¹                            â”‚
â”‚ â€¢ è¿”å›ç›‘æ§å¼•ç”¨ #Ref<...>                                        â”‚
â”‚ â€¢ å®ç°åˆ†å¸ƒå¼æ•…éšœæ£€æµ‹                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          eh_repl_data_manager_api:timestamp/0                   â”‚
â”‚                        â†“                                       â”‚
â”‚          eh_data_server:handle_call(eh_timestamp, ...)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ è·å–å½“å‰èŠ‚ç‚¹çš„é€»è¾‘æ—¶é—´æˆ³                                      â”‚
â”‚ â€¢ è¿”å› {Timestamp, DataIndexList}                              â”‚
â”‚ â€¢ ç”¨äºCRAQåè®®çš„ä¸€è‡´æ€§ä¿è¯                                      â”‚
â”‚ â€¢ åˆå§‹çŠ¶æ€: {0, []}                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              eh_repl_ring:get_ordered_list_pred_succ/4          â”‚
â”‚            (NodeId, ReplRing, ReplRing, NodeOrder)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ è®¡ç®—ç¯å½¢æ‹“æ‰‘ç»“æ„                                              â”‚
â”‚ â€¢ ç¡®å®šå‰é©±èŠ‚ç‚¹ (predecessor)                                    â”‚
â”‚ â€¢ ç¡®å®šåç»§èŠ‚ç‚¹ (successor)                                      â”‚
â”‚ â€¢ ç”Ÿæˆæ’åºåçš„èŠ‚ç‚¹åˆ—è¡¨                                          â”‚
â”‚                                                                 â”‚
â”‚ å†…éƒ¨è°ƒç”¨:                                                       â”‚
â”‚ â”œâ”€ get_ordered_list/3 - ç”Ÿæˆæœ‰åºåˆ—è¡¨                           â”‚
â”‚ â”œâ”€ predecessor/4 - è®¡ç®—å‰é©±èŠ‚ç‚¹                                 â”‚
â”‚ â””â”€ successor/4 - è®¡ç®—åç»§èŠ‚ç‚¹                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            eh_node_state:update_state_ready/1                   â”‚
â”‚                        â†“                                       â”‚
â”‚            eh_node_state:update_state/2                        â”‚
â”‚              (eh_ready, State)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ çŠ¶æ€è½¬æ¢: eh_not_ready â†’ eh_ready                             â”‚
â”‚ â€¢ æ›´æ–°ç³»ç»ŸçŠ¶æ€è®°å½•                                              â”‚
â”‚ â€¢ è®¾ç½®ç¯å½¢æ‹“æ‰‘ä¿¡æ¯                                              â”‚
â”‚ â€¢ å‡†å¤‡æ¥å—CRAQåè®®è¯·æ±‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            eh_system_server:event_state/3                      â”‚
â”‚                        â†“                                       â”‚
â”‚            eh_event:state/4                                    â”‚
â”‚                        â†“                                       â”‚
â”‚            eh_event:event_notify/3                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ å‘é€ "setup_repl.99" äº‹ä»¶                                     â”‚
â”‚ â€¢ è°ƒç”¨ eh_node_state:display_state/1                           â”‚
â”‚ â€¢ è¿”å›èŠ‚ç‚¹çŠ¶æ€ "ready"                                          â”‚
â”‚ â€¢ å®Œæˆé›†ç¾¤å»ºç«‹é€šçŸ¥                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>
            </div>

            <!-- æ€»ç»“åˆ†æ -->
            <div class="analysis-section">
                <h3>ğŸ“‹ é›†ç¾¤å»ºç«‹åˆ†ææ€»ç»“</h3>
                
                <h4>ğŸ¯ å…³é”®å‘ç°</h4>
                <ul>
                    <li><strong>å¹¶å‘å»ºç«‹:</strong> ä¸‰ä¸ªèŠ‚ç‚¹å‡ ä¹åŒæ—¶æ¥æ”¶å¹¶å¤„ç†é›†ç¾¤å»ºç«‹è¯·æ±‚</li>
                    <li><strong>ç¯å½¢æ‹“æ‰‘:</strong> åŸºäºæ’åºçš„ç¡®å®šæ€§ç¯å½¢ç»“æ„ï¼Œä¿è¯ä¸€è‡´æ€§</li>
                    <li><strong>æ•…éšœæ£€æµ‹:</strong> æ¯ä¸ªèŠ‚ç‚¹ç›‘æ§å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹ï¼Œå®ç°å…¨ç½‘æ•…éšœæ£€æµ‹</li>
                    <li><strong>çŠ¶æ€åŒæ­¥:</strong> ç»Ÿä¸€çš„çŠ¶æ€è½¬æ¢æœºåˆ¶ï¼Œç¡®ä¿é›†ç¾¤ä¸€è‡´æ€§</li>
                </ul>
                
                <h4>ğŸ”§ æŠ€æœ¯ç‰¹ç‚¹</h4>
                <ul>
                    <li><strong>åˆ†å¸ƒå¼åè°ƒ:</strong> æ— ä¸­å¿ƒåŒ–çš„é›†ç¾¤å»ºç«‹è¿‡ç¨‹</li>
                    <li><strong>å®¹é”™è®¾è®¡:</strong> å®Œå–„çš„æ•…éšœæ£€æµ‹å’Œæ¢å¤æœºåˆ¶</li>
                    <li><strong>äº‹ä»¶é©±åŠ¨:</strong> åŸºäºgen_eventçš„äº‹ä»¶é€šçŸ¥ç³»ç»Ÿ</li>
                    <li><strong>æ¨¡å—åŒ–æ¶æ„:</strong> æ¸…æ™°çš„èŒè´£åˆ†ç¦»å’Œæ¥å£è®¾è®¡</li>
                </ul>
                
                <h4>ğŸš€ CRAQåè®®å®ç°</h4>
                <p>é›†ç¾¤å»ºç«‹è¿‡ç¨‹ä¸ºCRAQåè®®çš„æ ¸å¿ƒåŠŸèƒ½å¥ å®šäº†åŸºç¡€ï¼š</p>
                <ul>
                    <li><strong>Chain Replication:</strong> å»ºç«‹æœ‰åºçš„å¤åˆ¶é“¾</li>
                    <li><strong>Apportioned Queries:</strong> æ”¯æŒæŸ¥è¯¢è´Ÿè½½åˆ†é…</li>
                    <li><strong>High Availability:</strong> æ•…éšœæ£€æµ‹å’Œè‡ªåŠ¨æ¢å¤</li>
                    <li><strong>Consistency:</strong> é€»è¾‘æ—¶é’Ÿå’ŒçŠ¶æ€åŒæ­¥</li>
                </ul>
                
                <h4>âš¡ æ€§èƒ½ç‰¹å¾</h4>
                <ul>
                    <li><strong>å¿«é€Ÿå»ºç«‹:</strong> æ•´ä¸ªé›†ç¾¤å»ºç«‹è¿‡ç¨‹åœ¨100mså†…å®Œæˆ</li>
                    <li><strong>ä½å¼€é”€:</strong> æœ€å°‘çš„ç½‘ç»œé€šä¿¡å’Œè®¡ç®—å¼€é”€</li>
                    <li><strong>å¯æ‰©å±•:</strong> æ”¯æŒåŠ¨æ€èŠ‚ç‚¹åŠ å…¥å’Œç¦»å¼€</li>
                </ul>
            </div>
        </div>
    </div>

<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="back-to-top" style="
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #00d4ff, #7c3aed);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
    transition: all 0.3s ease;
    z-index: 999;
    opacity: 0;
    transform: translateY(20px);
" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
   onmouseover="this.style.transform='translateY(-5px) scale(1.1)'" 
   onmouseout="this.style.transform='translateY(0) scale(1)'">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
    </svg>
</div>

<script>
// å›åˆ°é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º/éšè—é€»è¾‘
window.addEventListener('scroll', function() {
    const backToTop = document.getElementById('back-to-top');
    if (window.scrollY > 300) {
        backToTop.style.opacity = '1';
        backToTop.style.transform = 'translateY(0)';
    } else {
        backToTop.style.opacity = '0';
        backToTop.style.transform = 'translateY(20px)';
    }
});
</script>

</body>
</html>