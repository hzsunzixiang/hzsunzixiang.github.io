<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRAQ æŸ¥è¯¢æ“ä½œ Trace åˆ†ææŠ¥å‘Š</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .content {
            padding: 40px;
        }
        .section {
            margin-bottom: 40px;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        .section h2 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .section h3 {
            color: #34495e;
            margin-top: 25px;
        }
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        .highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ff6b6b;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }
        .flow-diagram {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #e9ecef;
        }
        .node-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .timeline {
            background: #f1f2f6;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .timeline-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-left: 4px solid #3498db;
            border-radius: 4px;
        }
        ul {
            padding-left: 20px;
        }
        li {
            margin-bottom: 8px;
        }
        .function-call {
            background: #e8f5e8;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            font-family: monospace;
            border-left: 3px solid #27ae60;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .data-structure {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #2196f3;
        }
        .query-type {
            background: #f3e5f5;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #9c27b0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” CRAQ æŸ¥è¯¢æ“ä½œ Trace åˆ†æ</h1>
            <p>æ·±åº¦è§£æCRAQåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢æœºåˆ¶ä¸æ•°æ®è¯»å–æµç¨‹</p>
        </div>
        
        <div class="content">
            <!-- æ¦‚è§ˆç»Ÿè®¡ -->
            <div class="section">
                <h2>ğŸ“Š æŸ¥è¯¢æ“ä½œæ¦‚è§ˆ</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">1</span>
                        <div>æŸ¥è¯¢è¯·æ±‚</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">~6ms</span>
                        <div>æ€»å“åº”æ—¶é—´</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">Node1</span>
                        <div>æŸ¥è¯¢èŠ‚ç‚¹</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">person/10</span>
                        <div>æŸ¥è¯¢å¯¹è±¡</div>
                    </div>
                </div>

                <div class="highlight">
                    <h3>ğŸ¯ æŸ¥è¯¢åœºæ™¯åˆ†æ</h3>
                    <p>åŸºäº ReadMe.txt çš„æŸ¥è¯¢æ“ä½œï¼š</p>
                    <ul>
                        <li><strong>æŸ¥è¯¢ç›®æ ‡</strong>: personå¯¹è±¡ï¼ŒIDä¸º10</li>
                        <li><strong>å‘èµ·èŠ‚ç‚¹</strong>: ec_n1@rabbitmq4-1 (HEADèŠ‚ç‚¹)</li>
                        <li><strong>æŸ¥è¯¢æ—¶æœº</strong>: åœ¨å¤šæ¬¡æ›´æ–°æ“ä½œä¹‹åè¿›è¡Œæ•°æ®è¯»å–</li>
                        <li><strong>é¢„æœŸç»“æœ</strong>: è·å–æœ€æ–°çš„åˆå¹¶æ•°æ®çŠ¶æ€</li>
                    </ul>
                </div>
            </div>

            <!-- CRAQæŸ¥è¯¢åè®®åˆ†æ -->
            <div class="section">
                <h2>ğŸ”— CRAQ æŸ¥è¯¢åè®®æœºåˆ¶</h2>
                
                <div class="flow-diagram">
                    <h3>ğŸ“‹ æŸ¥è¯¢æµç¨‹æ¶æ„å›¾</h3>
                    <div class="code-block">
<strong>CRAQ æŸ¥è¯¢åè®®æµç¨‹:</strong>

å®¢æˆ·ç«¯æŸ¥è¯¢è¯·æ±‚ â†’ æ¥æ”¶èŠ‚ç‚¹ â†’ æ•°æ®çŠ¶æ€æ£€æŸ¥ â†’ æŸ¥è¯¢å¤„ç†ç­–ç•¥é€‰æ‹©
     â†“                â†“            â†“              â†“
erlang_craq:query  eh_query    data_state    query_handler
     â†“                â†“            â†“              â†“
 ç³»ç»ŸæœåŠ¡å™¨å¤„ç†    èŠ‚ç‚¹çŠ¶æ€éªŒè¯   æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥   ç­–ç•¥è·¯ç”±
     â†“                â†“            â†“              â†“
eh_system_server   eh_ready     msg_dataæ£€æŸ¥   æœ¬åœ°/è¿œç¨‹æŸ¥è¯¢
     â†“                â†“            â†“              â†“
æŸ¥è¯¢å¤„ç†å™¨è°ƒç”¨     æ•°æ®ç®¡ç†å™¨     å­˜å‚¨å±‚è®¿é—®     ç»“æœè¿”å›
     â†“                â†“            â†“              â†“
eh_query_handler  eh_data_server eh_storage    å®¢æˆ·ç«¯å“åº”
                    </div>
                </div>

                <div class="node-info">
                    <h4>ğŸ—ï¸ æŸ¥è¯¢å¤„ç†ç­–ç•¥</h4>
                    <ul>
                        <li><strong>æœ¬åœ°æŸ¥è¯¢</strong>: èŠ‚ç‚¹çŠ¶æ€ä¸ºreadyä¸”æ— å¾…å¤„ç†æ›´æ–°æ—¶ç›´æ¥è¯»å–</li>
                        <li><strong>ç­‰å¾…æŸ¥è¯¢</strong>: æœ‰å¾…å¤„ç†æ›´æ–°æ—¶ç­‰å¾…æ›´æ–°å®Œæˆåå“åº”</li>
                        <li><strong>è½¬å‘æŸ¥è¯¢</strong>: å‘TAILèŠ‚ç‚¹è½¬å‘æŸ¥è¯¢è¯·æ±‚(AQæ¨¡å¼)</li>
                        <li><strong>é”™è¯¯å¤„ç†</strong>: èŠ‚ç‚¹ä¸å¯ç”¨æˆ–æ­£åœ¨æ›´æ–°æ—¶çš„é”™è¯¯å“åº”</li>
                    </ul>
                </div>
            </div>

            <!-- å…³é”®å‡½æ•°è°ƒç”¨åˆ†æ -->
            <div class="section">
                <h2>âš™ï¸ å…³é”®å‡½æ•°è°ƒç”¨åºåˆ—åˆ†æ</h2>
                
                <h3>ğŸ”„ æŸ¥è¯¢æ¶ˆæ¯å¤„ç†æµç¨‹</h3>
                
                <div class="timeline">
                    <div class="timeline-item">
                        <strong>1. å®¢æˆ·ç«¯æŸ¥è¯¢è¯·æ±‚</strong>
                        <div class="function-call">erlang_craq:query(N1, person, 10)</div>
                        <p>å®¢æˆ·ç«¯å‘Node1å‘èµ·å¯¹person/10å¯¹è±¡çš„æŸ¥è¯¢è¯·æ±‚</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>2. ç³»ç»ŸæœåŠ¡å™¨æ¥æ”¶</strong>
                        <div class="function-call">eh_system_server:handle_cast({eh_query, ...})</div>
                        <p>ç³»ç»ŸæœåŠ¡å™¨æ¥æ”¶æŸ¥è¯¢è¯·æ±‚ï¼Œæå–æŸ¥è¯¢å‚æ•°</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>3. èŠ‚ç‚¹çŠ¶æ€æ£€æŸ¥</strong>
                        <div class="function-call">eh_node_state:data_state/1 --> eh_ready</div>
                        <p>æ£€æŸ¥èŠ‚ç‚¹æ•°æ®çŠ¶æ€ï¼Œç¡®è®¤ä¸ºreadyçŠ¶æ€å¯ä»¥å¤„ç†æŸ¥è¯¢</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>4. æŸ¥è¯¢å¤„ç†å™¨è°ƒç”¨</strong>
                        <div class="function-call">eh_query_handler:query(ok, person, 10, ...)</div>
                        <p>è°ƒç”¨æŸ¥è¯¢å¤„ç†å™¨ï¼Œä¼ å…¥æŸ¥è¯¢å‚æ•°å’Œç³»ç»ŸçŠ¶æ€</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>5. æ•°æ®ç®¡ç†å™¨æŸ¥è¯¢</strong>
                        <div class="function-call">eh_repl_data_manager_api:query({person,10})</div>
                        <p>é€šè¿‡æ•°æ®ç®¡ç†å™¨APIè®¿é—®åº•å±‚å­˜å‚¨</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>6. æ•°æ®æœåŠ¡å™¨å¤„ç†</strong>
                        <div class="function-call">eh_data_server:handle_call({eh_query,{person,10}}, ...)</div>
                        <p>æ•°æ®æœåŠ¡å™¨å¤„ç†æŸ¥è¯¢è¯·æ±‚ï¼Œè®¿é—®å­˜å‚¨æ•°æ®</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>7. ç»“æœè¿”å›</strong>
                        <div class="function-call">eh_query_handler:reply/3 --> {ok,{person,10,[...]}}</div>
                        <p>æ„é€ æŸ¥è¯¢ç»“æœå¹¶è¿”å›ç»™å®¢æˆ·ç«¯</p>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®å­˜å‚¨ç»“æ„åˆ†æ -->
            <div class="section">
                <h2>ğŸ’¾ æ•°æ®å­˜å‚¨ç»“æ„åˆ†æ</h2>
                
                <h3>ğŸ” eh_storage_value æ•°æ®ç»“æ„</h3>
                
                <div class="data-structure">
                    <h4>ğŸ“ å­˜å‚¨å€¼æ ¼å¼è§£æ</h4>
                    <div class="code-block">
<strong>å­˜å‚¨æ•°æ®ç»“æ„:</strong>

eh_storage_value{timestamp, field_id, active, field_name, field_value}

ç¤ºä¾‹æ•°æ®:
â”œâ”€â”€ {eh_storage_value,4,2,1,age,40}           # æœ€æ–°ageå€¼
â”œâ”€â”€ {eh_storage_value,4,1,1,name,john_smith}  # æœ€æ–°nameå€¼  
â”œâ”€â”€ {eh_storage_value,3,2,0,age,undefined}    # è¢«åˆ é™¤çš„ageå­—æ®µ
â”œâ”€â”€ {eh_storage_value,3,1,1,name,john_smith}  # å†å²nameå€¼
â”œâ”€â”€ {eh_storage_value,2,1,1,age,40}           # å†å²ageå€¼
â”œâ”€â”€ {eh_storage_value,1,3,1,gender,male}      # genderå­—æ®µ
â””â”€â”€ {eh_storage_value,1,2,1,age,30}           # æœ€åˆageå€¼

å­—æ®µè¯´æ˜:
- timestamp: é€»è¾‘æ—¶é’Ÿ (1,2,3,4...)
- field_id: å­—æ®µåºå· (1,2,3...)  
- active: æ˜¯å¦æ¿€æ´» (1=æœ‰æ•ˆ, 0=åˆ é™¤)
- field_name: å­—æ®µåç§° (name, age, gender)
- field_value: å­—æ®µå€¼ (john_smith, 40, male)
                    </div>
                </div>

                <div class="highlight">
                    <h4>ğŸ“Š æŸ¥è¯¢ç»“æœåˆæˆ</h4>
                    <p>æœ€ç»ˆæŸ¥è¯¢ç»“æœ: <code>{person,10,[{age,40},{name,john_smith},{gender,male}]}</code></p>
                    <ul>
                        <li><strong>age: 40</strong> - æ¥è‡ªtimestamp=4çš„æœ€æ–°æ›´æ–°</li>
                        <li><strong>name: john_smith</strong> - æ¥è‡ªtimestamp=4çš„æœ€æ–°æ›´æ–°</li>
                        <li><strong>gender: male</strong> - æ¥è‡ªtimestamp=1çš„åˆå§‹å€¼(æœªè¢«åç»­æ›´æ–°)</li>
                    </ul>
                </div>
            </div>

            <!-- æŸ¥è¯¢å¤„ç†ç­–ç•¥åˆ†æ -->
            <div class="section">
                <h2>ğŸ¯ æŸ¥è¯¢å¤„ç†ç­–ç•¥åˆ†æ</h2>
                
                <h3>ğŸ”„ å¤šç§æŸ¥è¯¢å¤„ç†å™¨</h3>
                
                <div class="query-type">
                    <h4>1. eh_wait_query_handler_api</h4>
                    <p><strong>ç­–ç•¥</strong>: ç­‰å¾…æ›´æ–°å®Œæˆåå“åº”</p>
                    <div class="function-call">update_state_add_query_data(ObjectType, ObjectId, From, Ref, State)</div>
                    <p>å°†æŸ¥è¯¢è¯·æ±‚åŠ å…¥å¾…å¤„ç†é˜Ÿåˆ—ï¼Œç­‰å¾…ç›¸å…³å¯¹è±¡æ›´æ–°å®Œæˆåè‡ªåŠ¨å“åº”</p>
                </div>
                
                <div class="query-type">
                    <h4>2. eh_no_wait_query_handler_api</h4>
                    <p><strong>ç­–ç•¥</strong>: ç«‹å³è¿”å›"æ­£åœ¨æ›´æ–°"é”™è¯¯</p>
                    <div class="function-call">eh_query_handler:error_being_updated([{ObjectType, ObjectId, undefined}])</div>
                    <p>å½“å¯¹è±¡æ­£åœ¨æ›´æ–°æ—¶ï¼Œç«‹å³è¿”å›é”™è¯¯ï¼Œä¸ç­‰å¾…æ›´æ–°å®Œæˆ</p>
                </div>
                
                <div class="query-type">
                    <h4>3. eh_aq_query_handler_api (Apportioned Queries)</h4>
                    <p><strong>ç­–ç•¥</strong>: è½¬å‘åˆ°TAILèŠ‚ç‚¹æŸ¥è¯¢</p>
                    <div class="function-call">eh_query_handler:process_tail(ObjectType, ObjectId, Tail, From, Ref, State)</div>
                    <p>å°†æŸ¥è¯¢è½¬å‘åˆ°é“¾çš„TAILèŠ‚ç‚¹ï¼Œç¡®ä¿è¯»å–æœ€æ–°çš„å·²æäº¤æ•°æ®</p>
                </div>
                
                <div class="query-type">
                    <h4>4. eh_dirty_read_query_handler_api</h4>
                    <p><strong>ç­–ç•¥</strong>: è„è¯»ï¼Œç›´æ¥è¿”å›å½“å‰æ•°æ®</p>
                    <div class="function-call">eh_query_handler:query(dirty_read, ObjectType, ObjectId, From, Ref, State)</div>
                    <p>ä¸è€ƒè™‘æ•°æ®ä¸€è‡´æ€§ï¼Œç›´æ¥è¿”å›æœ¬åœ°å½“å‰æ•°æ®çŠ¶æ€</p>
                </div>
            </div>

            <!-- ç³»ç»ŸçŠ¶æ€åˆ†æ -->
            <div class="section">
                <h2>ğŸ“¡ ç³»ç»ŸçŠ¶æ€ä¸æ¶ˆæ¯æ•°æ®åˆ†æ</h2>
                
                <h3>ğŸ”” eh_system_state çŠ¶æ€è§£æ</h3>
                
                <div class="data-structure">
                    <h4>ğŸ“‹ ç³»ç»ŸçŠ¶æ€å­—æ®µ</h4>
                    <div class="code-block">
<strong>ç³»ç»ŸçŠ¶æ€ç»“æ„:</strong>

{eh_system_state,
    eh_ready,                    # èŠ‚ç‚¹çŠ¶æ€: ready
    4,                          # å½“å‰æ—¶é—´æˆ³: 4
    ['ec_n1@...','ec_n2@...','ec_n3@...'],  # å¤åˆ¶ç¯èŠ‚ç‚¹åˆ—è¡¨
    ['ec_n1@...','ec_n2@...','ec_n3@...'],  # å¤åˆ¶ç¯é¡ºåº
    'ec_n3@rabbitmq4-3',        # å‰é©±èŠ‚ç‚¹
    'ec_n2@rabbitmq4-2',        # åç»§èŠ‚ç‚¹
    #{},                        # é¢„æ›´æ–°æ¶ˆæ¯æ•°æ®(ç©º)
    #{                          # æ¶ˆæ¯æ•°æ®(æœ‰å¾…å¤„ç†æ›´æ–°)
        {eh_update_msg_key,2,person,10} => {...},
        {eh_update_msg_key,3,person,10} => {...}
    },
    {set,...},                  # å·²å®Œæˆé›†åˆ
    #{}, #{},                   # æŸ¥è¯¢æ•°æ®å’Œå…¶ä»–çŠ¶æ€
    undefined,                  # å¾…å¤„ç†é¢„æ›´æ–°æ•°æ®
    {eh_app_config,...}         # åº”ç”¨é…ç½®
}
                    </div>
                </div>

                <div class="warning">
                    <h4>âš ï¸ å¾…å¤„ç†æ›´æ–°æ£€æµ‹</h4>
                    <p>ç³»ç»Ÿåœ¨å¤„ç†æŸ¥è¯¢æ—¶æ£€æµ‹åˆ°msg_dataä¸­æœ‰timestamp=2å’Œtimestamp=3çš„å¾…å¤„ç†æ›´æ–°æ¶ˆæ¯ï¼Œä½†ç”±äºèŠ‚ç‚¹çŠ¶æ€ä¸ºreadyä¸”è¿™äº›æ›´æ–°å·²ç»å®Œæˆï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿›è¡Œæœ¬åœ°æŸ¥è¯¢ã€‚</p>
                </div>
            </div>

            <!-- æ€§èƒ½åˆ†æ -->
            <div class="section">
                <h2>â° æŸ¥è¯¢æ€§èƒ½åˆ†æ</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">4:26:32.302973</span>
                        <div>æŸ¥è¯¢å¼€å§‹æ—¶é—´</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">4:26:32.309206</span>
                        <div>æŸ¥è¯¢å®Œæˆæ—¶é—´</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">6.233ms</span>
                        <div>æ€»å“åº”æ—¶é—´</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">æœ¬åœ°æŸ¥è¯¢</span>
                        <div>æŸ¥è¯¢ç±»å‹</div>
                    </div>
                </div>

                <h3>ğŸ“ˆ æ€§èƒ½åˆ†è§£åˆ†æ</h3>
                
                <div class="timeline">
                    <div class="timeline-item">
                        <strong>æ–‡ä»¶åå¤„ç†</strong>
                        <p>eh_file_nameæ“ä½œ: ~2ms</p>
                        <p>è·å–æ•°æ®æ–‡ä»¶åå’Œé…ç½®ä¿¡æ¯</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>ç³»ç»ŸæœåŠ¡å™¨å¤„ç†</strong>
                        <p>handle_caståˆ°query_handler: ~1ms</p>
                        <p>æ¶ˆæ¯è·¯ç”±å’ŒçŠ¶æ€æ£€æŸ¥</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>æ•°æ®æœåŠ¡å™¨æŸ¥è¯¢</strong>
                        <p>æ•°æ®è®¿é—®å’Œç»“æœæ„é€ : ~2ms</p>
                        <p>å­˜å‚¨å±‚è®¿é—®å’Œæ•°æ®åˆæˆ</p>
                    </div>
                    
                    <div class="timeline-item">
                        <strong>ç»“æœè¿”å›</strong>
                        <p>å“åº”æ„é€ å’Œå‘é€: ~1ms</p>
                        <p>æœ€ç»ˆç»“æœå°è£…å’Œå®¢æˆ·ç«¯é€šä¿¡</p>
                    </div>
                </div>
            </div>

            <!-- æ€»ç»“ä¸æ´å¯Ÿ -->
            <div class="section">
                <h2>ğŸ¯ æ ¸å¿ƒæ´å¯Ÿä¸æ€»ç»“</h2>
                
                <div class="success">
                    <h3>âœ… CRAQæŸ¥è¯¢åè®®ä¼˜åŠ¿</h3>
                    <ul>
                        <li><strong>çµæ´»çš„æŸ¥è¯¢ç­–ç•¥</strong>: æ”¯æŒç­‰å¾…ã€ç«‹å³é”™è¯¯ã€è½¬å‘ã€è„è¯»ç­‰å¤šç§ç­–ç•¥</li>
                        <li><strong>æ•°æ®ä¸€è‡´æ€§ä¿è¯</strong>: é€šè¿‡çŠ¶æ€æ£€æŸ¥ç¡®ä¿è¯»å–ä¸€è‡´çš„æ•°æ®</li>
                        <li><strong>é«˜æ€§èƒ½æœ¬åœ°æŸ¥è¯¢</strong>: èŠ‚ç‚¹readyæ—¶å¯ç›´æ¥æœ¬åœ°å“åº”</li>
                        <li><strong>ç‰ˆæœ¬åŒ–æ•°æ®ç®¡ç†</strong>: å®Œæ•´çš„å†å²ç‰ˆæœ¬å’Œå­—æ®µçº§æ›´æ–°è·Ÿè¸ª</li>
                    </ul>
                </div>

                <div class="highlight">
                    <h3>ğŸ”¬ æŠ€æœ¯ç‰¹ç‚¹</h3>
                    <ul>
                        <li><strong>å­—æ®µçº§ç‰ˆæœ¬æ§åˆ¶</strong>: æ¯ä¸ªå­—æ®µç‹¬ç«‹çš„æ—¶é—´æˆ³å’Œæ¿€æ´»çŠ¶æ€</li>
                        <li><strong>å¢é‡æ›´æ–°æ”¯æŒ</strong>: æ”¯æŒéƒ¨åˆ†å­—æ®µæ›´æ–°å’Œå­—æ®µåˆ é™¤</li>
                        <li><strong>ç­–ç•¥æ¨¡å¼è®¾è®¡</strong>: å¯æ’æ‹”çš„æŸ¥è¯¢å¤„ç†ç­–ç•¥</li>
                        <li><strong>çŠ¶æ€é©±åŠ¨å¤„ç†</strong>: åŸºäºèŠ‚ç‚¹å’Œæ•°æ®çŠ¶æ€çš„æ™ºèƒ½è·¯ç”±</li>
                    </ul>
                </div>

                <div class="code-block">
<strong>å‡½æ•°è°ƒç”¨å›¾æ€»ç»“:</strong>

å®¢æˆ·ç«¯APIå±‚:
â””â”€â”€ erlang_craq:query/3

ç³»ç»ŸæœåŠ¡å±‚:
â”œâ”€â”€ eh_system_server:handle_cast/2
â”œâ”€â”€ eh_node_state:data_state/1
â””â”€â”€ eh_query_handler:query/6

æŸ¥è¯¢å¤„ç†å±‚:
â”œâ”€â”€ eh_query_handler:query_reply/3
â”œâ”€â”€ eh_repl_data_manager_api:query/1
â””â”€â”€ eh_query_handler:reply/3

æ•°æ®è®¿é—®å±‚:
â”œâ”€â”€ eh_data_server:handle_call/3
â”œâ”€â”€ eh_storage_data å­˜å‚¨è®¿é—®
â””â”€â”€ æ•°æ®åˆæˆä¸è¿”å›

æŸ¥è¯¢ç­–ç•¥å±‚:
â”œâ”€â”€ eh_wait_query_handler_api (ç­‰å¾…ç­–ç•¥)
â”œâ”€â”€ eh_no_wait_query_handler_api (ç«‹å³é”™è¯¯)
â”œâ”€â”€ eh_aq_query_handler_api (è½¬å‘TAIL)
â””â”€â”€ eh_dirty_read_query_handler_api (è„è¯»)
                </div>

                <div class="node-info">
                    <h4>ğŸ¯ å…³é”®å‘ç°</h4>
                    <ul>
                        <li><strong>å•èŠ‚ç‚¹æŸ¥è¯¢</strong>: æœ¬æ¬¡traceåªè®°å½•äº†Node1çš„æŸ¥è¯¢ï¼ŒNode3çš„æ—¥å¿—ä¸ºç©º</li>
                        <li><strong>æœ¬åœ°å¤„ç†</strong>: ç”±äºèŠ‚ç‚¹çŠ¶æ€readyä¸”æ— å†²çªï¼Œç›´æ¥æœ¬åœ°å¤„ç†æŸ¥è¯¢</li>
                        <li><strong>æ•°æ®åˆæˆ</strong>: ç³»ç»Ÿæ­£ç¡®åˆæˆäº†å¤šæ¬¡æ›´æ–°åçš„æœ€ç»ˆæ•°æ®çŠ¶æ€</li>
                        <li><strong>é«˜æ•ˆå“åº”</strong>: 6msçš„å“åº”æ—¶é—´æ˜¾ç¤ºäº†è‰¯å¥½çš„æŸ¥è¯¢æ€§èƒ½</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>
</html>