<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Erlang file:openå‡½æ•°Demoè¯¦ç»†åˆ†æ</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; margin: 0; padding: 20px; background: #f5f7fa; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; }
        h3 { color: #7f8c8d; }
        .code-block { background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 5px; margin: 10px 0; overflow-x: auto; }
        .highlight { background: #fff3cd; padding: 2px 4px; border-radius: 3px; }
        .warning { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 10px; border-radius: 5px; margin: 10px 0; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #f8f9fa; font-weight: bold; }
        .field-name { font-family: 'Courier New', monospace; background: #f8f9fa; padding: 2px 4px; border-radius: 3px; }
        .demo-result { background: #f8f9fa; border-left: 4px solid #6c757d; padding: 15px; margin: 15px 0; }
    </style>
</head>
<body>
<!-- CRAQ æ–‡æ¡£å¯¼èˆªæ  -->
<div id="craq-nav" style="
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 35, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: 12px 20px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
">
    <a href="/craq/" style="
        color: #00d4ff;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#7c3aed'" onmouseout="this.style.color='#00d4ff'">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
        è¿”å› CRAQ æ–‡æ¡£é¦–é¡µ
    </a>
    
    <div style="flex: 1;"></div>
    
    <a href="/" style="
        color: #888;
        text-decoration: none;
        font-size: 14px;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#888'">
        åšå®¢é¦–é¡µ
    </a>
</div>

<!-- ä¸ºå¯¼èˆªæ æ·»åŠ é¡¶éƒ¨é—´è· -->
<div style="height: 60px;"></div>

    <div class="container">
        <h1>ğŸ” Erlang file:openå‡½æ•°Demoè¯¦ç»†åˆ†æ</h1>
        
        <div class="success">
            <strong>Demoç›®æ ‡</strong>: æ·±å…¥ç†è§£file:openå‡½æ•°çš„è¿”å›å€¼ã€å‚æ•°é€‰é¡¹å’Œæ€§èƒ½ç‰¹æ€§
        </div>

        <h2>ğŸ“Š Demoè¿è¡Œç»“æœåˆ†æ</h2>

        <h3>ğŸ¯ 1. CRAQé£æ ¼æ–‡ä»¶æè¿°ç¬¦</h3>
        <div class="demo-result">
            <h4>ä»£ç è°ƒç”¨</h4>
            <div class="code-block">
{ok, CraqFile} = file:open(FileName, [append, read, binary, raw])
            </div>
            
            <h4>è¿”å›ç»“æœ</h4>
            <div class="code-block">
{file_descriptor, prim_file,
    #{handle => #Ref&lt;0.1526741069.2233073696.258620&gt;,
      owner => &lt;0.9.0&gt;,
      r_ahead_size => 0,
      r_buffer => #Ref&lt;0.1526741069.2233073670.258532&gt;}}
            </div>
        </div>

        <h3>ğŸ“‹ æ–‡ä»¶æè¿°ç¬¦ç»“æ„è¯¦è§£</h3>
        <table>
            <thead>
                <tr>
                    <th>å­—æ®µ</th>
                    <th>å€¼</th>
                    <th>è¯´æ˜</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="field-name">recordå</span></td>
                    <td>file_descriptor</td>
                    <td>Erlangå®˜æ–¹æ–‡ä»¶æè¿°ç¬¦è®°å½•</td>
                </tr>
                <tr>
                    <td><span class="field-name">module</span></td>
                    <td>prim_file</td>
                    <td>ä½¿ç”¨åŸå§‹æ–‡ä»¶é©±åŠ¨å¤„ç†I/Oæ“ä½œ</td>
                </tr>
                <tr>
                    <td><span class="field-name">handle</span></td>
                    <td>#Ref&lt;...258620&gt;</td>
                    <td>æ“ä½œç³»ç»Ÿçº§æ–‡ä»¶å¥æŸ„å¼•ç”¨</td>
                </tr>
                <tr>
                    <td><span class="field-name">owner</span></td>
                    <td>&lt;0.9.0&gt;</td>
                    <td>æ‹¥æœ‰æ­¤æ–‡ä»¶çš„è¿›ç¨‹PID</td>
                </tr>
                <tr>
                    <td><span class="field-name">r_buffer</span></td>
                    <td>#Ref&lt;...258532&gt;</td>
                    <td>è¯»ç¼“å†²åŒºå¼•ç”¨</td>
                </tr>
                <tr>
                    <td><span class="field-name">r_ahead_size</span></td>
                    <td>0</td>
                    <td>é¢„è¯»ç¼“å†²åŒºå¤§å°(0=ç¦ç”¨)</td>
                </tr>
            </tbody>
        </table>

        <h2>ğŸ”§ ä¸åŒæ‰“å¼€æ¨¡å¼å¯¹æ¯”</h2>

        <h3>ğŸ“ æ¨¡å¼å¯¹æ¯”è¡¨</h3>
        <table>
            <thead>
                <tr>
                    <th>æ¨¡å¼</th>
                    <th>å‚æ•°</th>
                    <th>è¿”å›ç±»å‹</th>
                    <th>ç‰¹ç‚¹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>æ ‡å‡†æ¨¡å¼</strong></td>
                    <td>[write, read]</td>
                    <td>&lt;0.86.0&gt; (PID)</td>
                    <td>é€šè¿‡Erlang I/OæœåŠ¡å™¨å¤„ç†</td>
                </tr>
                <tr>
                    <td><strong>Rawæ¨¡å¼</strong></td>
                    <td>[write, read, binary, raw]</td>
                    <td>#file_descriptor{module=prim_file}</td>
                    <td>ç›´æ¥ç³»ç»Ÿè°ƒç”¨ï¼Œé«˜æ€§èƒ½</td>
                </tr>
                <tr>
                    <td><strong>æ€§èƒ½æ¨¡å¼</strong></td>
                    <td>[write, binary, raw, delayed_write]</td>
                    <td>#file_descriptor{module=raw_file_io_delayed}</td>
                    <td>å¸¦ç¼“å­˜çš„å»¶è¿Ÿå†™å…¥</td>
                </tr>
            </tbody>
        </table>

        <h3>ğŸ¯ å…³é”®å‘ç°</h3>
        <div class="info">
            <ul>
                <li><strong>æ ‡å‡†æ¨¡å¼</strong>: è¿”å›è¿›ç¨‹PIDï¼Œé€šè¿‡Erlang I/OæœåŠ¡å™¨å¤„ç†</li>
                <li><strong>Rawæ¨¡å¼</strong>: è¿”å›file_descriptorè®°å½•ï¼Œç›´æ¥ç³»ç»Ÿè°ƒç”¨</li>
                <li><strong>æ€§èƒ½æ¨¡å¼</strong>: ä½¿ç”¨ä¸åŒçš„å¤„ç†æ¨¡å—(raw_file_io_delayed)</li>
            </ul>
        </div>

        <h2>âš¡ æ€§èƒ½æµ‹è¯•ç»“æœåˆ†æ</h2>

        <div class="demo-result">
            <h4>æ€§èƒ½å¯¹æ¯”æ•°æ®</h4>
            <ul>
                <li><strong>æ…¢é€Ÿå†™å…¥</strong> (æ— ç¼“å­˜): 7996Î¼s (8.00ms)</li>
                <li><strong>å¿«é€Ÿå†™å…¥</strong> (delayed_write): 1100Î¼s (1.10ms)</li>
                <li><strong>æ€§èƒ½æå‡</strong>: 7.27å€</li>
            </ul>
        </div>

        <h3>ğŸ“Š æ€§èƒ½ä¼˜åŒ–åŸç†</h3>
        <div class="code-block">
%% æ…¢é€Ÿå†™å…¥ï¼šæ¯æ¬¡writeéƒ½æ˜¯ç³»ç»Ÿè°ƒç”¨
{ok, F1} = file:open("slow.bin", [write, binary, raw]),
write_loop(F1, 1000),  %% 1000æ¬¡ç³»ç»Ÿè°ƒç”¨

%% å¿«é€Ÿå†™å…¥ï¼šä½¿ç”¨å†…æ ¸ç¼“å­˜
{ok, F2} = file:open("fast.bin", [write, binary, raw, delayed_write]),
write_loop(F2, 1000),  %% å‡å°‘ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°
        </div>

        <div class="warning">
            <h4>âš ï¸ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹</h4>
            <ul>
                <li><strong>delayed_write</strong>: å‡å°‘ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰¹é‡å†™å…¥</li>
                <li><strong>binaryæ¨¡å¼</strong>: é¿å…å­—ç¬¦ç¼–ç è½¬æ¢</li>
                <li><strong>rawæ¨¡å¼</strong>: ç»•è¿‡Erlang I/OæœåŠ¡å™¨</li>
                <li><strong>æ‰¹é‡æ“ä½œ</strong>: æ¯”å¾ªç¯å•å­—èŠ‚å†™å…¥å¿«6-7å€</li>
            </ul>
        </div>

        <h2>ğŸš¨ é”™è¯¯å¤„ç†æœºåˆ¶</h2>

        <h3>ğŸ“‹ å¸¸è§é”™è¯¯ç±»å‹</h3>
        <table>
            <thead>
                <tr>
                    <th>é”™è¯¯åŸå› </th>
                    <th>é”™è¯¯ç </th>
                    <th>è¯´æ˜</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>æ–‡ä»¶ä¸å­˜åœ¨</td>
                    <td>enoent</td>
                    <td>No such file or directory</td>
                </tr>
                <tr>
                    <td>æƒé™ä¸è¶³</td>
                    <td>eacces</td>
                    <td>Permission denied</td>
                </tr>
                <tr>
                    <td>æ–‡ä»¶è¢«é”å®š</td>
                    <td>eagain</td>
                    <td>Resource temporarily unavailable</td>
                </tr>
                <tr>
                    <td>ç£ç›˜ç©ºé—´ä¸è¶³</td>
                    <td>enospc</td>
                    <td>No space left on device</td>
                </tr>
            </tbody>
        </table>

        <h2>ğŸ” CRAQç³»ç»Ÿçš„é€‰æ‹©ç†ç”±</h2>

        <h3>ğŸ¯ CRAQä½¿ç”¨çš„å‚æ•°ç»„åˆ</h3>
        <div class="code-block">
file:open(FileName, [append, read, binary, raw])
        </div>

        <h3>ğŸ“‹ å‚æ•°é€‰æ‹©åˆ†æ</h3>
        <table>
            <thead>
                <tr>
                    <th>å‚æ•°</th>
                    <th>ä½œç”¨</th>
                    <th>CRAQçš„éœ€æ±‚</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="field-name">append</span></td>
                    <td>è¿½åŠ å†™å…¥ï¼Œä¸è¦†ç›–ç°æœ‰æ•°æ®</td>
                    <td>ç‰ˆæœ¬åŒ–æ•°æ®å­˜å‚¨ï¼Œä¿ç•™å†å²</td>
                </tr>
                <tr>
                    <td><span class="field-name">read</span></td>
                    <td>å…è®¸è¯»å–æ“ä½œ</td>
                    <td>æ”¯æŒæ•°æ®æ¢å¤å’ŒæŸ¥è¯¢</td>
                </tr>
                <tr>
                    <td><span class="field-name">binary</span></td>
                    <td>äºŒè¿›åˆ¶æ¨¡å¼ï¼Œé«˜æ•ˆå¤„ç†</td>
                    <td>å­˜å‚¨åºåˆ—åŒ–çš„Erlang terms</td>
                </tr>
                <tr>
                    <td><span class="field-name">raw</span></td>
                    <td>ç»•è¿‡I/OæœåŠ¡å™¨ï¼Œç›´æ¥ç³»ç»Ÿè°ƒç”¨</td>
                    <td>é«˜æ€§èƒ½åˆ†å¸ƒå¼å­˜å‚¨éœ€æ±‚</td>
                </tr>
            </tbody>
        </table>

        <h2>ğŸ’¡ æœ€ä½³å®è·µå»ºè®®</h2>

        <div class="success">
            <h4>âœ… æ¨èåšæ³•</h4>
            <ul>
                <li><strong>é«˜é¢‘å†™å…¥</strong>: ä½¿ç”¨ [raw, binary, delayed_write]</li>
                <li><strong>å¤§æ–‡ä»¶è¯»å–</strong>: ä½¿ç”¨ [raw, binary, read_ahead]</li>
                <li><strong>è¿½åŠ æ—¥å¿—</strong>: ä½¿ç”¨ [append, raw, binary]</li>
                <li><strong>ä¸´æ—¶æ–‡ä»¶</strong>: ä½¿ç”¨ [write, raw, binary]</li>
            </ul>
        </div>

        <div class="warning">
            <h4>âš ï¸ é¿å…çš„åšæ³•</h4>
            <ul>
                <li><strong>é¢‘ç¹å°å†™å…¥</strong>: ä¸ä½¿ç”¨delayed_writeä¼šä¸¥é‡å½±å“æ€§èƒ½</li>
                <li><strong>æ··åˆæ¨¡å¼</strong>: é¿å…åœ¨åŒä¸€æ–‡ä»¶ä¸Šæ··ç”¨ä¸åŒçš„æ‰“å¼€æ¨¡å¼</li>
                <li><strong>å¿˜è®°å…³é—­</strong>: æ–‡ä»¶æè¿°ç¬¦æ³„éœ²ä¼šè€—å°½ç³»ç»Ÿèµ„æº</li>
                <li><strong>å¿½ç•¥é”™è¯¯</strong>: ä¸æ£€æŸ¥file:opençš„è¿”å›å€¼</li>
            </ul>
        </div>

        <h2>ğŸ¯ æ ¸å¿ƒç»“è®º</h2>

        <div class="info">
            <h4>ğŸ“ å…³é”®ç†è§£</h4>
            <ol>
                <li><strong>è¿”å›å€¼ç±»å‹</strong>: æ ¹æ®å‚æ•°ä¸åŒï¼Œå¯èƒ½è¿”å›PIDæˆ–file_descriptorè®°å½•</li>
                <li><strong>æ€§èƒ½å·®å¼‚</strong>: delayed_writeå¯ä»¥å¸¦æ¥7å€ä»¥ä¸Šçš„æ€§èƒ½æå‡</li>
                <li><strong>æ¨¡å—åˆ†å‘</strong>: ä¸åŒå‚æ•°ç»„åˆä½¿ç”¨ä¸åŒçš„å¤„ç†æ¨¡å—</li>
                <li><strong>CRAQé€‰æ‹©</strong>: [append, read, binary, raw] å¹³è¡¡äº†æ€§èƒ½å’ŒåŠŸèƒ½éœ€æ±‚</li>
                <li><strong>é”™è¯¯å¤„ç†</strong>: æ€»æ˜¯æ£€æŸ¥è¿”å›å€¼ï¼Œå¦¥å–„å¤„ç†å„ç§é”™è¯¯æƒ…å†µ</li>
            </ol>
        </div>

        <p>è¿™ä¸ªdemoæ¸…æ™°å±•ç¤ºäº†Erlang file:openå‡½æ•°çš„å¼ºå¤§åŠŸèƒ½å’Œçµæ´»æ€§ï¼Œå¸®åŠ©ç†è§£CRAQç³»ç»Ÿä¸ºä»€ä¹ˆé€‰æ‹©ç‰¹å®šçš„å‚æ•°ç»„åˆæ¥å®ç°é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼å­˜å‚¨ã€‚</p>
    </div>

<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="back-to-top" style="
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #00d4ff, #7c3aed);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
    transition: all 0.3s ease;
    z-index: 999;
    opacity: 0;
    transform: translateY(20px);
" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
   onmouseover="this.style.transform='translateY(-5px) scale(1.1)'" 
   onmouseout="this.style.transform='translateY(0) scale(1)'">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
    </svg>
</div>

<script>
// å›åˆ°é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º/éšè—é€»è¾‘
window.addEventListener('scroll', function() {
    const backToTop = document.getElementById('back-to-top');
    if (window.scrollY > 300) {
        backToTop.style.opacity = '1';
        backToTop.style.transform = 'translateY(0)';
    } else {
        backToTop.style.opacity = '0';
        backToTop.style.transform = 'translateY(20px)';
    }
});
</script>

</body>
</html>