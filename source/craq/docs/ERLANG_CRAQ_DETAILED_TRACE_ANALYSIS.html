<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Erlang CRAQ ä¸‰èŠ‚ç‚¹å¯åŠ¨è¯¦ç»†Traceåˆ†æ</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .content {
            padding: 30px;
        }
        
        .function-flow {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
        }
        
        .flow-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .call-sequence {
            font-family: 'Courier New', monospace;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.6;
        }
        
        .process-id {
            color: #f39c12;
            font-weight: bold;
        }
        
        .function-name {
            color: #3498db;
            font-weight: bold;
        }
        
        .return-value {
            color: #2ecc71;
        }
        
        .timestamp {
            color: #95a5a6;
        }
        
        .node-section {
            margin: 30px 0;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .node-header {
            padding: 15px 25px;
            font-weight: bold;
            font-size: 1.3em;
            color: white;
        }
        
        .node1 { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .node2 { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .node3 { background: linear-gradient(135deg, #f39c12, #e67e22); }
        
        .trace-content {
            padding: 25px;
            background: #f8f9fa;
        }
        
        .key-functions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .function-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }
        
        .function-card h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .function-details {
            font-size: 0.9em;
            color: #7f8c8d;
            margin: 10px 0;
        }
        
        .call-graph-svg {
            width: 100%;
            height: 600px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .critical-path {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .critical-path h3 {
            margin-top: 0;
        }
        
        .flow-diagram {
            text-align: center;
            margin: 30px 0;
        }
        
        .flow-step {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 12px 20px;
            margin: 8px;
            border-radius: 25px;
            font-weight: bold;
            position: relative;
        }
        
        .flow-step::after {
            content: 'â†’';
            position: absolute;
            right: -25px;
            top: 50%;
            transform: translateY(-50%);
            color: #3498db;
            font-size: 1.5em;
        }
        
        .flow-step:last-child::after {
            display: none;
        }
        
        .analysis-section {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .code-highlight {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }
    </style>
</head>
<body>
<!-- CRAQ æ–‡æ¡£å¯¼èˆªæ  -->
<div id="craq-nav" style="
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 35, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: 12px 20px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
">
    <a href="/craq/" style="
        color: #00d4ff;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#7c3aed'" onmouseout="this.style.color='#00d4ff'">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
        è¿”å› CRAQ æ–‡æ¡£é¦–é¡µ
    </a>
    
    <div style="flex: 1;"></div>
    
    <a href="/" style="
        color: #888;
        text-decoration: none;
        font-size: 14px;
        transition: all 0.3s ease;
    " onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#888'">
        åšå®¢é¦–é¡µ
    </a>
</div>

<!-- ä¸ºå¯¼èˆªæ æ·»åŠ é¡¶éƒ¨é—´è· -->
<div style="height: 60px;"></div>

    <div class="container">
        <div class="header">
            <h1>ğŸ” Erlang CRAQ ä¸‰èŠ‚ç‚¹å¯åŠ¨è¯¦ç»†Traceåˆ†æ</h1>
            <p>æ·±åº¦è§£æå‡½æ•°è°ƒç”¨å›¾ã€å…³é”®æ“ä½œè·¯å¾„å’Œæ€§èƒ½ç‰¹å¾</p>
        </div>
        
        <div class="content">
            <!-- æ¦‚è§ˆç»Ÿè®¡ -->
            <div class="summary-stats">
                <div class="stat-item">
                    <div class="stat-number">3</div>
                    <div class="stat-label">åˆ†å¸ƒå¼èŠ‚ç‚¹</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">5</div>
                    <div class="stat-label">æ ¸å¿ƒå¯åŠ¨é˜¶æ®µ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">23</div>
                    <div class="stat-label">è·Ÿè¸ªæ¨¡å—</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">~600</div>
                    <div class="stat-label">æ€»å‡½æ•°è°ƒç”¨</div>
                </div>
            </div>

            <!-- å…³é”®å¯åŠ¨æµç¨‹ -->
            <div class="critical-path">
                <h3>ğŸš€ å…³é”®å¯åŠ¨æµç¨‹</h3>
                <div class="flow-diagram">
                    <div class="flow-step">é…ç½®åˆå§‹åŒ–</div>
                    <div class="flow-step">æ–‡ä»¶åç®¡ç†</div>
                    <div class="flow-step">æ•°æ®æœåŠ¡å™¨</div>
                    <div class="flow-step">å­˜å‚¨æ“ä½œ</div>
                    <div class="flow-step">ç³»ç»ŸæœåŠ¡å™¨</div>
                    <div class="flow-step">äº‹ä»¶ç³»ç»Ÿ</div>
                </div>
                
                <div class="code-highlight">
<strong>å¯åŠ¨æ—¶é—´åºåˆ—:</strong>
Node 1: 3:21:49.486372 â†’ 3:21:49.532281 (çº¦46ms)
Node 2: 3:23:15.749026 â†’ 3:23:15.772718 (çº¦24ms)  
Node 3: 3:33:57.613147 â†’ 3:33:57.633154 (çº¦20ms)
                </div>
            </div>

            <!-- Node 1 è¯¦ç»†åˆ†æ -->
            <div class="node-section">
                <div class="node-header node1">
                    ğŸ“ Node 1 (ec_n1@rabbitmq4-1) - è¯¦ç»†å‡½æ•°è°ƒç”¨åˆ†æ
                </div>
                <div class="trace-content">
                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ1: é…ç½®å’Œæ–‡ä»¶ååˆå§‹åŒ–</div>
                        <div class="call-sequence">
<span class="timestamp">3:21:49.486372</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="function-name">eh_file_name:get_file_name</span>("ec_n1", "_repl.data")
<span class="timestamp">3:21:49.497089</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="return-value">â†’ "ec_n1_repl.data"</span>

<span class="timestamp">3:21:49.497546</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="function-name">eh_file_name:get_file_name</span>("ec_n1", standard_io)
<span class="timestamp">3:21:49.497621</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="return-value">â†’ standard_io</span>

<span class="timestamp">3:21:49.497764</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="function-name">eh_file_name:get_full_file_name</span>("./", standard_io)
<span class="timestamp">3:21:49.497824</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="return-value">â†’ standard_io</span>
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ2: æ•°æ®æœåŠ¡å™¨å¯åŠ¨</div>
                        <div class="call-sequence">
<span class="timestamp">3:21:49.498903</span> <span class="process-id">&lt;0.906.0&gt;</span> <span class="function-name">eh_data_server:start_link</span>({eh_app_config,...})

<span class="timestamp">3:21:49.499089</span> <span class="process-id">&lt;0.907.0&gt;</span> <span class="function-name">eh_data_server:init</span>([{eh_app_config,...}])

<span class="timestamp">3:21:49.499564</span> <span class="process-id">&lt;0.907.0&gt;</span> <span class="function-name">eh_file_name:get_full_versioned_file_names</span>("./", "ec_n1_repl.data")
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ3: å­˜å‚¨æ•°æ®è¯»å– (å…³é”®æ“ä½œ)</div>
                        <div class="call-sequence">
<span class="timestamp">3:21:49.513705</span> <span class="process-id">&lt;0.907.0&gt;</span> <span class="function-name">eh_storage_data_operation_api:read_all</span>({eh_app_config,...})

<span class="timestamp">3:21:49.513923</span> <span class="process-id">&lt;0.907.0&gt;</span> <span class="function-name">eh_storage_data_operation_api:read_all</span>(eh_storage_data_api, 
    ["./ec_n1_repl.data.0000000001","./ec_n1_repl.data.0000000002",...], {ok,0,[],#{}})

<span class="comment">// å¤šæ¬¡é€’å½’è°ƒç”¨è¯»å–æ‰€æœ‰ç‰ˆæœ¬åŒ–æ–‡ä»¶</span>
<span class="timestamp">3:21:49.524060</span> <span class="process-id">&lt;0.907.0&gt;</span> <span class="return-value">â†’ {ok,0,[],#{}}</span>
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ4: ç³»ç»ŸæœåŠ¡å™¨å¯åŠ¨</div>
                        <div class="call-sequence">
<span class="timestamp">3:21:49.531780</span> <span class="process-id">&lt;0.906.0&gt;</span> <span class="function-name">eh_system_server:start_link</span>({eh_app_config,...})
<span class="timestamp">3:21:49.532182</span> <span class="process-id">&lt;0.906.0&gt;</span> <span class="return-value">â†’ {ok,&lt;0.908.0&gt;}</span>
                        </div>
                    </div>

                    <div class="function-flow">
                        <div class="flow-title">ğŸ”„ é˜¶æ®µ5: äº‹ä»¶ç³»ç»Ÿå¯åŠ¨</div>
                        <div class="call-sequence">
<span class="timestamp">3:21:49.532251</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="function-name">eh_event:start_link</span>()
<span class="timestamp">3:21:49.532281</span> <span class="process-id">&lt;0.905.0&gt;</span> <span class="return-value">â†’ {ok,&lt;0.909.0&gt;}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Node 2 åˆ†æ -->
            <div class="node-section">
                <div class="node-header node2">
                    ğŸ“ Node 2 (ec_n2@rabbitmq4-2) - ä¼˜åŒ–å¯åŠ¨æ¨¡å¼
                </div>
                <div class="trace-content">
                    <div class="function-flow">
                        <div class="flow-title">âš¡ å¿«é€Ÿå¯åŠ¨åºåˆ—</div>
                        <div class="call-sequence">
<span class="timestamp">3:23:15.749026</span> <span class="function-name">eh_file_name:get_file_name</span> â†’ "ec_n2_repl.data"
<span class="timestamp">3:23:15.756865</span> <span class="function-name">eh_data_server:start_link</span>
<span class="timestamp">3:23:15.757028</span> <span class="function-name">eh_data_server:init</span>
<span class="timestamp">3:23:15.763332</span> <span class="function-name">eh_storage_data_operation_api:read_all</span>
<span class="timestamp">3:23:15.771816</span> <span class="function-name">eh_system_server:start_link</span>
<span class="timestamp">3:23:15.772659</span> <span class="function-name">eh_event:start_link</span>
                        </div>
                        
                        <div class="function-details">
                            <strong>ç‰¹ç‚¹:</strong> æ–‡ä»¶æ‰«ææ›´å°‘ï¼Œå­˜å‚¨è¯»å–æ›´å¿«ï¼Œæ•´ä½“å¯åŠ¨æ—¶é—´çº¦24ms
                        </div>
                    </div>
                </div>
            </div>

            <!-- Node 3 åˆ†æ -->
            <div class="node-section">
                <div class="node-header node3">
                    ğŸ“ Node 3 (ec_n3@rabbitmq4-3) - æœ€ä¼˜å¯åŠ¨æ¨¡å¼
                </div>
                <div class="trace-content">
                    <div class="function-flow">
                        <div class="flow-title">ğŸš„ è¶…å¿«å¯åŠ¨åºåˆ—</div>
                        <div class="call-sequence">
<span class="timestamp">3:33:57.613147</span> <span class="function-name">eh_file_name:get_file_name</span> â†’ "ec_n3_repl.data"
<span class="timestamp">3:33:57.620709</span> <span class="function-name">eh_data_server:start_link</span>
<span class="timestamp">3:33:57.620882</span> <span class="function-name">eh_data_server:init</span>
<span class="timestamp">3:33:57.632619</span> <span class="function-name">eh_system_server:start_link</span>
<span class="timestamp">3:33:57.633134</span> <span class="function-name">eh_event:start_link</span>
                        </div>
                        
                        <div class="function-details">
                            <strong>ç‰¹ç‚¹:</strong> æœ€å°‘çš„æ–‡ä»¶æ“ä½œï¼Œæœ€å¿«çš„å¯åŠ¨æ—¶é—´çº¦20ms
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…³é”®å‡½æ•°æ·±åº¦åˆ†æ -->
            <div class="analysis-section">
                <h3>ğŸ”¬ å…³é”®å‡½æ•°æ·±åº¦åˆ†æ</h3>
                
                <div class="key-functions">
                    <div class="function-card">
                        <h4>eh_file_name æ¨¡å—</h4>
                        <div class="function-details">
                            <strong>æ ¸å¿ƒèŒè´£:</strong> æ–‡ä»¶åç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶<br>
                            <strong>å…³é”®å‡½æ•°:</strong>
                            <ul>
                                <li><code>get_file_name/2</code> - ç”ŸæˆèŠ‚ç‚¹ç‰¹å®šæ–‡ä»¶å</li>
                                <li><code>get_full_versioned_file_names/2</code> - è·å–æ‰€æœ‰ç‰ˆæœ¬æ–‡ä»¶</li>
                                <li><code>get_version_num/2</code> - è·å–æœ€æ–°ç‰ˆæœ¬å·</li>
                            </ul>
                            <strong>è°ƒç”¨æ¨¡å¼:</strong> å¤§é‡çš„æ–‡ä»¶ç³»ç»Ÿæ‰«æå’Œè¿‡æ»¤æ“ä½œ
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_data_server æ¨¡å—</h4>
                        <div class="function-details">
                            <strong>æ ¸å¿ƒèŒè´£:</strong> æ•°æ®æœåŠ¡å™¨è¿›ç¨‹ç®¡ç†<br>
                            <strong>å…³é”®å‡½æ•°:</strong>
                            <ul>
                                <li><code>start_link/1</code> - å¯åŠ¨gen_serverè¿›ç¨‹</li>
                                <li><code>init/1</code> - åˆå§‹åŒ–æœåŠ¡å™¨çŠ¶æ€</li>
                            </ul>
                            <strong>åˆå§‹åŒ–æµç¨‹:</strong> è¯»å–å†å²æ•°æ® â†’ åˆ›å»ºæ–°ç‰ˆæœ¬æ–‡ä»¶ â†’ å»ºç«‹æœåŠ¡å™¨çŠ¶æ€
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_storage_data_operation_api æ¨¡å—</h4>
                        <div class="function-details">
                            <strong>æ ¸å¿ƒèŒè´£:</strong> å­˜å‚¨æ“ä½œæ¥å£<br>
                            <strong>å…³é”®å‡½æ•°:</strong>
                            <ul>
                                <li><code>read_all/2</code> - è¯»å–æ‰€æœ‰å†å²æ•°æ®</li>
                                <li><code>open/1</code> - æ‰“å¼€å­˜å‚¨æ–‡ä»¶</li>
                                <li><code>read/5</code> - è¯»å–ç‰¹å®šæ•°æ®å—</li>
                            </ul>
                            <strong>æ€§èƒ½ç‰¹å¾:</strong> é€’å½’è¯»å–å¤šä¸ªç‰ˆæœ¬æ–‡ä»¶ï¼Œæ˜¯å¯åŠ¨æ—¶é—´çš„ä¸»è¦æ¶ˆè€—ç‚¹
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_system_server æ¨¡å—</h4>
                        <div class="function-details">
                            <strong>æ ¸å¿ƒèŒè´£:</strong> ç³»ç»Ÿçº§æœåŠ¡å™¨ç®¡ç†<br>
                            <strong>å…³é”®å‡½æ•°:</strong>
                            <ul>
                                <li><code>start_link/1</code> - å¯åŠ¨ç³»ç»ŸæœåŠ¡å™¨</li>
                                <li><code>init/1</code> - åˆå§‹åŒ–ç³»ç»ŸçŠ¶æ€</li>
                            </ul>
                            <strong>ä½œç”¨:</strong> ç®¡ç†CRAQåè®®çš„æ ¸å¿ƒé€»è¾‘å’ŒèŠ‚ç‚¹é—´é€šä¿¡
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_event æ¨¡å—</h4>
                        <div class="function-details">
                            <strong>æ ¸å¿ƒèŒè´£:</strong> äº‹ä»¶å¤„ç†ç³»ç»Ÿ<br>
                            <strong>å…³é”®å‡½æ•°:</strong>
                            <ul>
                                <li><code>start_link/0</code> - å¯åŠ¨äº‹ä»¶ç®¡ç†å™¨</li>
                            </ul>
                            <strong>ä½œç”¨:</strong> æä¾›ç³»ç»Ÿçº§äº‹ä»¶é€šçŸ¥å’Œæ—¥å¿—è®°å½•
                        </div>
                    </div>
                    
                    <div class="function-card">
                        <h4>eh_persist_storage_data æ¨¡å—</h4>
                        <div class="function-details">
                            <strong>æ ¸å¿ƒèŒè´£:</strong> åº•å±‚æ–‡ä»¶I/Oæ“ä½œ<br>
                            <strong>å…³é”®å‡½æ•°:</strong>
                            <ul>
                                <li><code>open_data_file/1</code> - æ‰“å¼€æ•°æ®æ–‡ä»¶</li>
                                <li><code>read_data/3</code> - è¯»å–æ•°æ®å—</li>
                                <li><code>close_data_file/1</code> - å…³é—­æ–‡ä»¶</li>
                            </ul>
                            <strong>ç‰¹å¾:</strong> ç›´æ¥çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œæ”¯æŒäºŒè¿›åˆ¶æ•°æ®æ ¼å¼
                        </div>
                    </div>
                </div>
            </div>

            <!-- å‡½æ•°è°ƒç”¨å›¾ -->
            <div class="analysis-section">
                <h3>ğŸ“Š å®Œæ•´å‡½æ•°è°ƒç”¨å›¾</h3>
                
                <div class="code-highlight">
<strong>å¯åŠ¨æµç¨‹å‡½æ•°è°ƒç”¨å›¾:</strong>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨å¯åŠ¨å…¥å£                              â”‚
â”‚                    (erlang_craq:start)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é…ç½®åˆå§‹åŒ–é˜¶æ®µ                                â”‚
â”‚               eh_system_config:get_env/0                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ–‡ä»¶åç®¡ç†é˜¶æ®µ                                â”‚
â”‚                  eh_file_name æ¨¡å—                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ get_file_name/2 - ç”ŸæˆèŠ‚ç‚¹æ–‡ä»¶å                              â”‚
â”‚ â€¢ get_full_file_name/2 - ç”Ÿæˆå®Œæ•´è·¯å¾„                          â”‚
â”‚ â€¢ get_full_versioned_file_names/2 - è·å–ç‰ˆæœ¬æ–‡ä»¶åˆ—è¡¨           â”‚
â”‚ â€¢ get_file_names/2 - æ‰«æç›®å½•æ–‡ä»¶                               â”‚
â”‚ â€¢ get_version_num/2 - è·å–æœ€æ–°ç‰ˆæœ¬                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®æœåŠ¡å™¨å¯åŠ¨                                â”‚
â”‚                  eh_data_server æ¨¡å—                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ start_link/1 - å¯åŠ¨gen_serverè¿›ç¨‹                            â”‚
â”‚ â€¢ init/1 - åˆå§‹åŒ–æœåŠ¡å™¨çŠ¶æ€                                     â”‚
â”‚   â”œâ”€ è°ƒç”¨å­˜å‚¨APIè¯»å–å†å²æ•°æ®                                    â”‚
â”‚   â”œâ”€ åˆ›å»ºæ–°ç‰ˆæœ¬æ–‡ä»¶                                             â”‚
â”‚   â””â”€ å»ºç«‹#eh_data_state{}çŠ¶æ€è®°å½•                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å­˜å‚¨æ“ä½œé˜¶æ®µ                                  â”‚
â”‚             eh_storage_data_operation_api æ¨¡å—                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ read_all/2 - è¯»å–æ‰€æœ‰å†å²æ•°æ®                                 â”‚
â”‚   â”œâ”€ read_all/3 - é€’å½’å¤„ç†æ–‡ä»¶åˆ—è¡¨                              â”‚
â”‚   â”œâ”€ open/1 - æ‰“å¼€æ–‡ä»¶                                          â”‚
â”‚   â”œâ”€ read/5 - è¯»å–æ•°æ®å—                                        â”‚
â”‚   â””â”€ close/1 - å…³é—­æ–‡ä»¶                                         â”‚
â”‚                                                                 â”‚
â”‚ åº•å±‚è°ƒç”¨: eh_persist_storage_data                               â”‚
â”‚ â€¢ open_data_file/1                                              â”‚
â”‚ â€¢ read_data/3                                                   â”‚
â”‚ â€¢ close_data_file/1                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç³»ç»ŸæœåŠ¡å™¨å¯åŠ¨                                â”‚
â”‚                 eh_system_server æ¨¡å—                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ start_link/1 - å¯åŠ¨ç³»ç»Ÿçº§gen_server                          â”‚
â”‚ â€¢ init/1 - åˆå§‹åŒ–ç³»ç»ŸçŠ¶æ€                                       â”‚
â”‚   â””â”€ å»ºç«‹#eh_system_state{}çŠ¶æ€è®°å½•                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    äº‹ä»¶ç³»ç»Ÿå¯åŠ¨                                  â”‚
â”‚                    eh_event æ¨¡å—                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ start_link/0 - å¯åŠ¨gen_eventç®¡ç†å™¨                           â”‚
â”‚   â””â”€ è¿”å›{ok, Pid}å®Œæˆå¯åŠ¨                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>
            </div>

            <!-- æ€§èƒ½åˆ†æ -->
            <div class="analysis-section">
                <h3>âš¡ æ€§èƒ½åˆ†æä¸ä¼˜åŒ–å»ºè®®</h3>
                
                <div class="code-highlight">
<strong>å¯åŠ¨æ—¶é—´å¯¹æ¯”:</strong>
Node 1: 46ms (æœ€è¯¦ç»†çš„åˆå§‹åŒ–)
Node 2: 24ms (ä¸­ç­‰å¤æ‚åº¦)
Node 3: 20ms (æœ€ä¼˜åŒ–å¯åŠ¨)

<strong>æ€§èƒ½ç“¶é¢ˆè¯†åˆ«:</strong>
1. æ–‡ä»¶ç³»ç»Ÿæ‰«æ (eh_file_name:get_file_names/2)
   - å¤§é‡çš„æ–‡ä»¶è¿‡æ»¤æ“ä½œ
   - ç‰ˆæœ¬æ–‡ä»¶æ’åºå’Œæ¯”è¾ƒ

2. å­˜å‚¨æ•°æ®è¯»å– (eh_storage_data_operation_api:read_all/2)
   - é€’å½’è¯»å–å¤šä¸ªç‰ˆæœ¬æ–‡ä»¶
   - äºŒè¿›åˆ¶æ•°æ®è§£æå’ŒéªŒè¯

3. è¿›ç¨‹å¯åŠ¨å¼€é”€
   - gen_serverè¿›ç¨‹åˆ›å»º
   - çŠ¶æ€è®°å½•åˆå§‹åŒ–

<strong>ä¼˜åŒ–å»ºè®®:</strong>
1. å®ç°æ–‡ä»¶ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘é‡å¤æ‰«æ
2. å¹¶è¡Œè¯»å–å¤šä¸ªç‰ˆæœ¬æ–‡ä»¶
3. é¢„ç¼–è¯‘é…ç½®ï¼Œå‡å°‘è¿è¡Œæ—¶è®¡ç®—
4. å®ç°å¢é‡å¯åŠ¨æ¨¡å¼
                </div>
            </div>

            <!-- æ€»ç»“ -->
            <div class="analysis-section">
                <h3>ğŸ“‹ åˆ†ææ€»ç»“</h3>
                
                <h4>ğŸ¯ å…³é”®å‘ç°</h4>
                <ul>
                    <li><strong>ä¸€è‡´çš„å¯åŠ¨æ¶æ„:</strong> ä¸‰ä¸ªèŠ‚ç‚¹éµå¾ªç›¸åŒçš„5é˜¶æ®µå¯åŠ¨æµç¨‹</li>
                    <li><strong>æ¸è¿›å¼ä¼˜åŒ–:</strong> åå¯åŠ¨çš„èŠ‚ç‚¹æ˜¾ç¤ºå‡ºæ›´å¥½çš„æ€§èƒ½ç‰¹å¾</li>
                    <li><strong>æ¨¡å—åŒ–è®¾è®¡:</strong> æ¸…æ™°çš„èŒè´£åˆ†ç¦»å’Œæ¥å£å®šä¹‰</li>
                    <li><strong>å®¹é”™æœºåˆ¶:</strong> å®Œå–„çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†</li>
                </ul>
                
                <h4>ğŸ”§ æŠ€æœ¯ç‰¹ç‚¹</h4>
                <ul>
                    <li><strong>ç‰ˆæœ¬åŒ–å­˜å‚¨:</strong> æ”¯æŒæ•°æ®æ–‡ä»¶çš„ç‰ˆæœ¬ç®¡ç†</li>
                    <li><strong>è¿›ç¨‹éš”ç¦»:</strong> æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹çš„gen_serverè¿›ç¨‹</li>
                    <li><strong>äº‹ä»¶é©±åŠ¨:</strong> å®Œæ•´çš„äº‹ä»¶é€šçŸ¥å’Œæ—¥å¿—ç³»ç»Ÿ</li>
                    <li><strong>é…ç½®é©±åŠ¨:</strong> çµæ´»çš„é…ç½®ç®¡ç†æœºåˆ¶</li>
                </ul>
                
                <h4>ğŸš€ CRAQåè®®å®ç°</h4>
                <p>è¿™ä¸ªå¯åŠ¨è¿‡ç¨‹ä¸ºCRAQ (Chain Replication with Apportioned Queries) åè®®çš„å®ç°å¥ å®šäº†åŸºç¡€ï¼Œ
                åŒ…æ‹¬æ•°æ®å¤åˆ¶ã€æŸ¥è¯¢åˆ†å‘ã€æ•…éšœæ£€æµ‹ç­‰æ ¸å¿ƒåŠŸèƒ½çš„åˆå§‹åŒ–ã€‚</p>
            </div>
        </div>
    </div>

<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="back-to-top" style="
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #00d4ff, #7c3aed);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
    transition: all 0.3s ease;
    z-index: 999;
    opacity: 0;
    transform: translateY(20px);
" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
   onmouseover="this.style.transform='translateY(-5px) scale(1.1)'" 
   onmouseout="this.style.transform='translateY(0) scale(1)'">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
    </svg>
</div>

<script>
// å›åˆ°é¡¶éƒ¨æŒ‰é’®æ˜¾ç¤º/éšè—é€»è¾‘
window.addEventListener('scroll', function() {
    const backToTop = document.getElementById('back-to-top');
    if (window.scrollY > 300) {
        backToTop.style.opacity = '1';
        backToTop.style.transform = 'translateY(0)';
    } else {
        backToTop.style.opacity = '0';
        backToTop.style.transform = 'translateY(20px)';
    }
});
</script>

</body>
</html>